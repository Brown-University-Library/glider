!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.firebase=e()}(this,function(){"use strict";!function(t){if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(t){return t&&DataView.prototype.isPrototypeOf(t)},i=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};h.prototype.append=function(t,e){t=s(t),e=u(e);var n=this.map[t];this.map[t]=n?n+","+e:e},h.prototype.delete=function(t){delete this.map[s(t)]},h.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},h.prototype.set=function(t,e){this.map[s(t)]=u(e)},h.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),c(t)},h.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),c(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),c(t)},e.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},y.call(m.prototype),y.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var a=[301,302,303,307,308];v.redirect=function(t,e){if(-1===a.indexOf(e))throw new RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})},t.Headers=h,t.Request=m,t.Response=v,t.fetch=function(t,n){return new Promise(function(r,i){var o=new m(t,n),a=new XMLHttpRequest;a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new h,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new v(i,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&e.blob&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function s(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function c(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function h(t){this.map={},t instanceof h?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function l(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function p(t){var e=new FileReader,n=f(e);return e.readAsArrayBuffer(t),n}function d(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&r(t))this._bodyArrayBuffer=d(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!i(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=l(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var t,e,n,r=l(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,n=f(e=new FileReader),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(t,e){var n,r,i=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new h(e.headers)),this.method=(r=(n=e.method||this.method||"GET").toUpperCase(),o.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function v(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new h(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:void 0);var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var n=setTimeout;function r(){}function i(t){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void c((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,u(t)}catch(e){s(t,e)}var r,o}function s(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return o(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},i.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},i.all=function(t){return new i(function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var i=r.length;function o(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){o(t,e)},n)}r[t]=a,0==--i&&e(r)}catch(t){n(t)}}for(var a=0;a<r.length;a++)o(a,r[a])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},i._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){n(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var h=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();h.Promise||(h.Promise=i);var l=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),f=e(function(t){var e=t.exports={version:"2.5.5"};"number"==typeof __e&&(__e=e)}),p=(f.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),d=function(t){if(!p(t))throw TypeError(t+" is not an object!");return t},y=function(t){try{return!!t()}catch(t){return!0}},m=!y(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),g=l.document,v=p(g)&&p(g.createElement),b=function(t){return v?g.createElement(t):{}},_=!m&&!y(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),w=function(t,e){if(!p(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!p(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!p(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!p(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},E=Object.defineProperty,T={f:m?Object.defineProperty:function(t,e,n){if(d(t),e=w(e,!0),d(n),_)try{return E(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},C=m?function(t,e,n){return T.f(t,e,S(1,n))}:function(t,e,n){return t[e]=n,t},I={}.hasOwnProperty,A=function(t,e){return I.call(t,e)},N=0,D=Math.random(),R=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++N+D).toString(36))},P=e(function(t){var e=R("src"),n=Function.toString,r=(""+n).split("toString");f.inspectSource=function(t){return n.call(t)},(t.exports=function(t,n,i,o){var a="function"==typeof i;a&&(A(i,"name")||C(i,"name",n)),t[n]!==i&&(a&&(A(i,e)||C(i,e,t[n]?""+t[n]:r.join(String(n)))),t===l?t[n]=i:o?t[n]?t[n]=i:C(t,n,i):(delete t[n],C(t,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[e]||n.call(this)})}),k=function(t,e,n){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},O=function(t,e,n){var r,i,o,a,s=t&O.F,u=t&O.G,c=t&O.S,h=t&O.P,p=t&O.B,d=u?l:c?l[e]||(l[e]={}):(l[e]||{}).prototype,y=u?f:f[e]||(f[e]={}),m=y.prototype||(y.prototype={});for(r in u&&(n=e),n)o=((i=!s&&d&&void 0!==d[r])?d:n)[r],a=p&&i?k(o,l):h&&"function"==typeof o?k(Function.call,o):o,d&&P(d,r,o,t&O.U),y[r]!=o&&C(y,r,a),h&&m[r]!=o&&(m[r]=o)};l.core=f,O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var L=O,x={}.toString,M=function(t){return x.call(t).slice(8,-1)},F=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==M(t)?t.split(""):Object(t)},U=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},V=function(t){return Object(U(t))},B=Math.ceil,q=Math.floor,j=function(t){return isNaN(t=+t)?0:(t>0?q:B)(t)},W=Math.min,K=function(t){return t>0?W(j(t),9007199254740991):0},H=Array.isArray||function(t){return"Array"==M(t)},G=l["__core-js_shared__"]||(l["__core-js_shared__"]={}),$=function(t){return G[t]||(G[t]={})},Q=e(function(t){var e=$("wks"),n=l.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:R)("Symbol."+t))}).store=e}),z=Q("species"),Y=function(t,e){return new(function(t){var e;return H(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!H(e.prototype)||(e=void 0),p(e)&&null===(e=e[z])&&(e=void 0)),void 0===e?Array:e}(t))(e)},X=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||Y;return function(e,c,h){for(var l,f,p=V(e),d=F(p),y=k(c,h,3),m=K(d.length),g=0,v=n?u(e,m):r?u(e,0):void 0;m>g;g++)if((s||g in d)&&(f=y(l=d[g],g,p),t))if(n)v[g]=f;else if(f)switch(t){case 3:return!0;case 5:return l;case 6:return g;case 2:v.push(l)}else if(o)return!1;return a?-1:i||o?o:v}},J=Q("unscopables"),Z=Array.prototype;null==Z[J]&&C(Z,J,{});var tt=function(t){Z[J][t]=!0},et=X(5),nt=!0;"find"in[]&&Array(1).find(function(){nt=!1}),L(L.P+L.F*nt,"Array",{find:function(t){return et(this,t,arguments.length>1?arguments[1]:void 0)}}),tt("find"),f.Array.find;var rt=X(6),it=!0;"findIndex"in[]&&Array(1).findIndex(function(){it=!1}),L(L.P+L.F*it,"Array",{findIndex:function(t){return rt(this,t,arguments.length>1?arguments[1]:void 0)}}),tt("findIndex"),f.Array.findIndex;var ot=function(t){return F(U(t))},at=Math.max,st=Math.min,ut=$("keys"),ct=function(t){return ut[t]||(ut[t]=R(t))},ht=(!1,function(t,e,n){var r=ot(t),i=K(r.length),o=function(t,e){return(t=j(t))<0?at(t+e,0):st(t,e)}(n,i);for(0;i>o;o++)if(o in r&&r[o]===e)return o||0;return-1}),lt=ct("IE_PROTO"),ft=function(t,e){var n,r=ot(t),i=0,o=[];for(n in r)n!=lt&&A(r,n)&&o.push(n);for(;e.length>i;)A(r,n=e[i++])&&(~ht(o,n)||o.push(n));return o},pt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),dt=Object.keys||function(t){return ft(t,pt)},yt={f:Object.getOwnPropertySymbols},mt={f:{}.propertyIsEnumerable},gt=Object.assign,vt=!gt||y(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=gt({},t)[n]||Object.keys(gt({},e)).join("")!=r})?function(t,e){for(var n=V(t),r=arguments.length,i=1,o=yt.f,a=mt.f;r>i;)for(var s,u=F(arguments[i++]),c=o?dt(u).concat(o(u)):dt(u),h=c.length,l=0;h>l;)a.call(u,s=c[l++])&&(n[s]=u[s]);return n}:gt;L(L.S+L.F,"Object",{assign:vt}),f.Object.assign;var bt=Q("match"),_t=Q("match"),wt="".startsWith;L(L.P+L.F*function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[_t]=!1,!"/./"[t](e)}catch(t){}}return!0}("startsWith"),"String",{startsWith:function(t){var e=function(t,e,n){if(p(r=e)&&(void 0!==(i=r[bt])?i:"RegExp"==M(r)))throw TypeError("String#"+n+" doesn't accept regex!");var r,i;return String(U(t))}(this,t,"startsWith"),n=K(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return wt?wt.call(e,r,n):e.slice(n,n+r.length)===r}}),f.String.startsWith,L(L.P,"String",{repeat:function(t){var e=String(U(this)),n="",r=j(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}}),f.String.repeat;var Et=e(function(t){var e=R("meta"),n=T.f,r=0,i=Object.isExtensible||function(){return!0},o=!y(function(){return i(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},s=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!p(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!A(t,e)){if(!i(t))return"F";if(!n)return"E";a(t)}return t[e].i},getWeak:function(t,n){if(!A(t,e)){if(!i(t))return!0;if(!n)return!1;a(t)}return t[e].w},onFreeze:function(t){return o&&s.NEED&&i(t)&&!A(t,e)&&a(t),t}}}),Tt=(Et.KEY,Et.NEED,Et.fastKey,Et.getWeak,Et.onFreeze,T.f),St=Q("toStringTag"),Ct=function(t,e,n){t&&!A(t=n?t:t.prototype,St)&&Tt(t,St,{configurable:!0,value:e})},It={f:Q},At=T.f,Nt=function(t){var e=f.Symbol||(f.Symbol=l.Symbol||{});"_"==t.charAt(0)||t in e||At(e,t,{value:It.f(t)})},Dt=m?Object.defineProperties:function(t,e){d(t);for(var n,r=dt(e),i=r.length,o=0;i>o;)T.f(t,n=r[o++],e[n]);return t},Rt=l.document,Pt=Rt&&Rt.documentElement,kt=ct("IE_PROTO"),Ot=function(){},Lt=function(){var t,e=b("iframe"),n=pt.length;for(e.style.display="none",Pt.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Lt=t.F;n--;)delete Lt.prototype[pt[n]];return Lt()},xt=Object.create||function(t,e){var n;return null!==t?(Ot.prototype=d(t),n=new Ot,Ot.prototype=null,n[kt]=t):n=Lt(),void 0===e?n:Dt(n,e)},Mt=pt.concat("length","prototype"),Ft={f:Object.getOwnPropertyNames||function(t){return ft(t,Mt)}},Ut=Ft.f,Vt={}.toString,Bt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],qt={f:function(t){return Bt&&"[object Window]"==Vt.call(t)?function(t){try{return Ut(t)}catch(t){return Bt.slice()}}(t):Ut(ot(t))}},jt=Object.getOwnPropertyDescriptor,Wt={f:m?jt:function(t,e){if(t=ot(t),e=w(e,!0),_)try{return jt(t,e)}catch(t){}if(A(t,e))return S(!mt.f.call(t,e),t[e])}},Kt=Et.KEY,Ht=Wt.f,Gt=T.f,$t=qt.f,Qt=l.Symbol,zt=l.JSON,Yt=zt&&zt.stringify,Xt=Q("_hidden"),Jt=Q("toPrimitive"),Zt={}.propertyIsEnumerable,te=$("symbol-registry"),ee=$("symbols"),ne=$("op-symbols"),re=Object.prototype,ie="function"==typeof Qt,oe=l.QObject,ae=!oe||!oe.prototype||!oe.prototype.findChild,se=m&&y(function(){return 7!=xt(Gt({},"a",{get:function(){return Gt(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=Ht(re,e);r&&delete re[e],Gt(t,e,n),r&&t!==re&&Gt(re,e,r)}:Gt,ue=function(t){var e=ee[t]=xt(Qt.prototype);return e._k=t,e},ce=ie&&"symbol"==typeof Qt.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Qt},he=function(t,e,n){return t===re&&he(ne,e,n),d(t),e=w(e,!0),d(n),A(ee,e)?(n.enumerable?(A(t,Xt)&&t[Xt][e]&&(t[Xt][e]=!1),n=xt(n,{enumerable:S(0,!1)})):(A(t,Xt)||Gt(t,Xt,S(1,{})),t[Xt][e]=!0),se(t,e,n)):Gt(t,e,n)},le=function(t,e){d(t);for(var n,r=function(t){var e=dt(t),n=yt.f;if(n)for(var r,i=n(t),o=mt.f,a=0;i.length>a;)o.call(t,r=i[a++])&&e.push(r);return e}(e=ot(e)),i=0,o=r.length;o>i;)he(t,n=r[i++],e[n]);return t},fe=function(t){var e=Zt.call(this,t=w(t,!0));return!(this===re&&A(ee,t)&&!A(ne,t))&&(!(e||!A(this,t)||!A(ee,t)||A(this,Xt)&&this[Xt][t])||e)},pe=function(t,e){if(t=ot(t),e=w(e,!0),t!==re||!A(ee,e)||A(ne,e)){var n=Ht(t,e);return!n||!A(ee,e)||A(t,Xt)&&t[Xt][e]||(n.enumerable=!0),n}},de=function(t){for(var e,n=$t(ot(t)),r=[],i=0;n.length>i;)A(ee,e=n[i++])||e==Xt||e==Kt||r.push(e);return r},ye=function(t){for(var e,n=t===re,r=$t(n?ne:ot(t)),i=[],o=0;r.length>o;)!A(ee,e=r[o++])||n&&!A(re,e)||i.push(ee[e]);return i};ie||(P((Qt=function(){if(this instanceof Qt)throw TypeError("Symbol is not a constructor!");var t=R(arguments.length>0?arguments[0]:void 0),e=function(n){this===re&&e.call(ne,n),A(this,Xt)&&A(this[Xt],t)&&(this[Xt][t]=!1),se(this,t,S(1,n))};return m&&ae&&se(re,t,{configurable:!0,set:e}),ue(t)}).prototype,"toString",function(){return this._k}),Wt.f=pe,T.f=he,Ft.f=qt.f=de,mt.f=fe,yt.f=ye,m&&P(re,"propertyIsEnumerable",fe,!0),It.f=function(t){return ue(Q(t))}),L(L.G+L.W+L.F*!ie,{Symbol:Qt});for(var me="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ge=0;me.length>ge;)Q(me[ge++]);for(var ve=dt(Q.store),be=0;ve.length>be;)Nt(ve[be++]);L(L.S+L.F*!ie,"Symbol",{for:function(t){return A(te,t+="")?te[t]:te[t]=Qt(t)},keyFor:function(t){if(!ce(t))throw TypeError(t+" is not a symbol!");for(var e in te)if(te[e]===t)return e},useSetter:function(){ae=!0},useSimple:function(){ae=!1}}),L(L.S+L.F*!ie,"Object",{create:function(t,e){return void 0===e?xt(t):le(xt(t),e)},defineProperty:he,defineProperties:le,getOwnPropertyDescriptor:pe,getOwnPropertyNames:de,getOwnPropertySymbols:ye}),zt&&L(L.S+L.F*(!ie||y(function(){var t=Qt();return"[null]"!=Yt([t])||"{}"!=Yt({a:t})||"{}"!=Yt(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(p(e)||void 0!==t)&&!ce(t))return H(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!ce(e))return e}),r[1]=e,Yt.apply(zt,r)}}),Qt.prototype[Jt]||C(Qt.prototype,Jt,Qt.prototype.valueOf),Ct(Qt,"Symbol"),Ct(Math,"Math",!0),Ct(l.JSON,"JSON",!0);var _e=Q("toStringTag"),we="Arguments"==M(function(){return arguments}()),Ee={};Ee[Q("toStringTag")]="z",Ee+""!="[object z]"&&P(Object.prototype,"toString",function(){return"[object "+(void 0===this?"Undefined":null===this?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=Object(this),_e))?e:we?M(t):"Object"==(n=M(t))&&"function"==typeof t.callee?"Arguments":n)+"]";var t,e,n},!0),Nt("asyncIterator"),Nt("observable"),f.Symbol;var Te={},Se={};C(Se,Q("iterator"),function(){return this});var Ce=ct("IE_PROTO"),Ie=Object.prototype,Ae=Object.getPrototypeOf||function(t){return t=V(t),A(t,Ce)?t[Ce]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ie:null},Ne=Q("iterator"),De=!([].keys&&"next"in[].keys()),Re=function(){return this},Pe=function(t,e,n,r,i,o,a){!function(t,e,n){t.prototype=xt(Se,{next:S(1,n)}),Ct(t,e+" Iterator")}(n,e,r);var s,u,c,h=function(t){if(!De&&t in d)return d[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",f="values"==i,p=!1,d=t.prototype,y=d[Ne]||d["@@iterator"]||i&&d[i],m=y||h(i),g=i?f?h("entries"):m:void 0,v="Array"==e&&d.entries||y;if(v&&(c=Ae(v.call(new t)))!==Object.prototype&&c.next&&(Ct(c,l,!0),"function"!=typeof c[Ne]&&C(c,Ne,Re)),f&&y&&"values"!==y.name&&(p=!0,m=function(){return y.call(this)}),(De||p||!d[Ne])&&C(d,Ne,m),Te[e]=m,Te[l]=Re,i)if(s={values:f?m:h("values"),keys:o?m:h("keys"),entries:g},a)for(u in s)u in d||P(d,u,s[u]);else L(L.P+L.F*(De||p),e,s);return s},ke=(!0,function(t,e){var n,r,i=String(U(t)),o=j(e),a=i.length;return o<0||o>=a?"":(n=i.charCodeAt(o))<55296||n>56319||o+1===a||(r=i.charCodeAt(o+1))<56320||r>57343?i.charAt(o):i.slice(o,o+2)});Pe(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ke(e,n),this._i+=t.length,{value:t,done:!1})});var Oe=function(t,e){return{value:e,done:!!t}},Le=Pe(Array,"Array",function(t,e){this._t=ot(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Oe(1)):Oe(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Te.Arguments=Te.Array,tt("keys"),tt("values"),tt("entries");for(var xe=Q("iterator"),Me=Q("toStringTag"),Fe=Te.Array,Ue={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Ve=dt(Ue),Be=0;Be<Ve.length;Be++){var qe,je=Ve[Be],We=Ue[je],Ke=l[je],He=Ke&&Ke.prototype;if(He&&(He[xe]||C(He,xe,Fe),He[Me]||C(He,Me,je),Te[je]=Fe,We))for(qe in Le)He[qe]||P(He,qe,Le[qe],!0)}It.f("iterator");var Ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function $e(t,e){function n(){this.constructor=t}Ge(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Qe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function ze(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function Ye(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var Xe=function(t,e){if(!t)throw Je(e)},Je=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},Ze=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},tn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ze(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!=s){var h=a<<4&240|s>>2;if(r.push(h),64!=u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},en=function(t){try{return tn.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function nn(t){return rn(void 0,t)}function rn(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=rn(t[n],e[n]));return t}function on(t,e,n){t[e]=n}var an=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),sn=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")},un=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},cn=function(){return!1},hn="FirebaseError",ln=Error.captureStackTrace,fn=function(t,e){if(this.code=t,this.message=e,ln)ln(this,pn.prototype.create);else try{throw Error.apply(this,arguments)}catch(t){this.name=hn,Object.defineProperty(this,"stack",{get:function(){return t.stack}})}};fn.prototype=Object.create(Error.prototype),fn.prototype.constructor=fn,fn.prototype.name=hn;var pn=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new fn(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}();function dn(t){return JSON.parse(t)}function yn(t){return JSON.stringify(t)}var mn=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=dn(en(o[0])||""),n=dn(en(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},gn=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},vn=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},bn=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},_n=function(t){return e={},bn(t,function(t,n){e[t]=n}),e;var e},wn=function(t){for(var e in t)return!1;return!0},En=function(t){var e=0;for(var n in t)e++;return e},Tn=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},Sn=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},Cn=function(t){for(var e in t)return e},In=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return $e(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782),i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295,l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(function(){this.blockSize=-1});function An(t,e){var n=new Nn(t,e);return n.subscribe.bind(n)}var Nn=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=Dn),void 0===r.error&&(r.error=Dn),void 0===r.complete&&(r.complete=Dn);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function Dn(){}var Rn=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Pn(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(r+" argument ")}function kn(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(Pn(t,e,r)+"must be a valid function.")}function On(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(Pn(t,e,r)+"must be a valid context object.")}var Ln=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},xn=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Mn="[DEFAULT]",Fn=[],Un=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled||!1,this.options_=nn(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){Fn.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){Fn=Fn.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed_(),this._automaticDataCollectionEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=Mn),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==Mn?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;rn(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(Fn.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),Fn=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&Vn("app-deleted",{name:this.name_})},t}();function Vn(t,e){throw qn.create(t,e)}Un.prototype.name&&Un.prototype.options||Un.prototype.delete||console.log("dc");var Bn,qn=new pn("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."}),jn=function t(){var e={},n={},r={},i={__esModule:!0,initializeApp:function(t,n){(void 0===n&&(n={}),"object"!=typeof n||null===n)&&(n={name:n});var r=n;void 0===r.name&&(r.name=Mn);var o=r.name;"string"==typeof o&&o||Vn("bad-app-name",{name:o+""}),xn(e,o)&&Vn("duplicate-app",{name:o});var a=new Un(t,r,i);return e[o]=a,s(a,"create"),a},app:o,apps:null,Promise:Promise,SDK_VERSION:"5.8.2",INTERNAL:{registerService:function(t,e,s,u,c){n[t]&&Vn("duplicate-service",{name:t}),n[t]=e,u&&(r[t]=u,a().forEach(function(t){u("create",t)}));var h=function(e){return void 0===e&&(e=o()),"function"!=typeof e[t]&&Vn("invalid-app-argument",{name:t}),e[t]()};return void 0!==s&&rn(h,s),i[t]=h,Un.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,c?e:[])},h},createFirebaseNamespace:t,extendNamespace:function(t){rn(i,t)},createSubscribe:An,ErrorFactory:pn,removeApp:function(t){s(e[t],"delete"),delete e[t]},factories:n,useAsService:u,Promise:Promise,deepExtend:rn}};function o(t){return xn(e,t=t||Mn)||Vn("no-app",{name:t}),e[t]}function a(){return Object.keys(e).map(function(t){return e[t]})}function s(t,e){Object.keys(n).forEach(function(n){var i=u(t,n);null!==i&&r[i]&&r[i](e,t)})}function u(t,e){if("serverAuth"===e)return null;var n=e;return t.options,n}return on(i,"default",i),Object.defineProperty(i,"apps",{get:a}),on(o,"App",Un),i}();(function(){var t,e=e||{},n=this;function r(t){return"string"==typeof t}function i(t){return"boolean"==typeof t}function o(){}function a(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function s(t){return null===t}function u(t){return"array"==a(t)}function c(t){var e=a(t);return"array"==e||"object"==e&&"number"==typeof t.length}function h(t){return"function"==a(t)}function l(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var f="closure_uid_"+(1e9*Math.random()>>>0),p=0;function d(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:y).apply(null,arguments)}function g(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var v=Date.now||function(){return+new Date};function b(t,e){function n(){}n.prototype=e.prototype,t.ob=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ed=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function _(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function w(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function E(t){if(Error.captureStackTrace)Error.captureStackTrace(this,E);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function T(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");E.call(this,n+t[r])}function S(t,e){throw new T("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function C(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function I(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function A(){this.b=this.a=null}b(E,Error),E.prototype.name="CustomError",b(T,E),T.prototype.name="AssertionError",C.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var N=new C(function(){return new R},function(t){t.reset()});function D(){var t=ft,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function R(){this.next=this.b=this.a=null}A.prototype.add=function(t,e){var n=N.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},R.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},R.prototype.reset=function(){this.next=this.b=this.a=null};var P=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(r(t))return r(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},k=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,o=r(t)?t.split(""):t,a=0;a<i;a++)a in o&&e.call(n,o[a],a,t)},O=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),o=r(t)?t.split(""):t,a=0;a<n;a++)a in o&&(i[a]=e.call(void 0,o[a],a,t));return i},L=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=r(t)?t.split(""):t,o=0;o<n;o++)if(o in i&&e.call(void 0,i[o],o,t))return!0;return!1};function x(t,e){return 0<=P(t,e)}function M(t,e){var n;return(n=0<=(e=P(t,e)))&&Array.prototype.splice.call(t,e,1),n}function F(t,e){!function(t,e){var n=t.length,i=r(t)?t.split(""):t;for(--n;0<=n;--n)n in i&&e.call(void 0,i[n],n,t)}(t,function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length})}function U(t){return Array.prototype.concat.apply([],arguments)}function V(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function B(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}var q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function j(t){return Y.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(K,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(H,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(G,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace($,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Q,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(z,"&#0;")),t):t}var W,K=/&/g,H=/</g,G=/>/g,$=/"/g,Q=/'/g,z=/\x00/g,Y=/[\x00&<>"']/;function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:t>e?1:0}t:{var Z=n.navigator;if(Z){var tt=Z.userAgent;if(tt){W=tt;break t}}W=""}function et(t){return X(W,t)}function nt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function rt(t){for(var e in t)return!1;return!0}function it(t){var e,n={};for(e in t)n[e]=t[e];return n}var ot,at,st="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ut(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<st.length;o++)n=st[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ct(t){n.setTimeout(function(){throw t},0)}function ht(t,e){at||function(){if(n.Promise&&n.Promise.resolve){var t=n.Promise.resolve(void 0);at=function(){t.then(pt)}}else at=function(){var t=pt;!h(n.setImmediate)||n.Window&&n.Window.prototype&&!et("Edge")&&n.Window.prototype.setImmediate==n.setImmediate?(ot||(ot=function(){var t=n.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!et("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=m(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!et("Trident")&&!et("MSIE")){var e=new t,r={},i=r;return e.port1.onmessage=function(){if(void 0!==r.next){var t=(r=r.next).wb;r.wb=null,t()}},function(t){i.next={wb:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){n.setTimeout(t,0)}}()),ot(t)):n.setImmediate(t)}}(),lt||(at(),lt=!0),ft.add(t,e)}var lt=!1,ft=new A;function pt(){for(var t;t=D();){try{t.a.call(t.b)}catch(t){ct(t)}I(N,t)}lt=!1}function dt(t,e){if(this.a=yt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=o)try{var n=this;t.call(e,function(t){At(n,mt,t)},function(t){if(!(t instanceof Lt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}At(n,gt,t)})}catch(t){At(this,gt,t)}}var yt=0,mt=2,gt=3;function vt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}vt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var bt=new C(function(){return new vt},function(t){t.reset()});function _t(t,e,n){var r=bt.get();return r.g=t,r.b=e,r.f=n,r}function wt(t){if(t instanceof dt)return t;var e=new dt(o);return At(e,mt,t),e}function Et(t){return new dt(function(e,n){n(t)})}function Tt(t,e,n){Nt(t,e,n,null)||ht(g(e,t))}function St(t){return new dt(function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Db:!0,value:o}:{Db:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Tt(t[o],g(i,o,!0),g(i,o,!1));else e(r)})}function Ct(t,e){t.b||t.a!=mt&&t.a!=gt||Dt(t),t.f?t.f.next=e:t.b=e,t.f=e}function It(t,e,n,r){var i=_t(null,null,null);return i.a=new dt(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Lt?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,Ct(t,i),i.a}function At(t,e,n){t.a==yt&&(t===n&&(e=gt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Nt(n,t.Nc,t.Oc,t)||(t.i=n,t.a=e,t.c=null,Dt(t),e!=gt||n instanceof Lt||function(t,e){t.g=!0,ht(function(){t.g&&Ot.call(null,e)})}(t,n)))}function Nt(t,e,n,r){if(t instanceof dt)return Ct(t,_t(e||o,n||null,r)),!0;if(w(t))return t.then(e,n,r),!0;if(l(t))try{var i=t.then;if(h(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Dt(t){t.h||(t.h=!0,ht(t.Yb,t))}function Rt(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Pt(t,e,n,r){if(n==gt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,kt(e,n,r);else try{e.c?e.g.call(e.f):kt(e,n,r)}catch(t){Ot.call(null,t)}I(bt,e)}function kt(t,e,n){e==mt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}dt.prototype.then=function(t,e,n){return It(this,h(t)?t:null,h(e)?e:null,n)},_(dt),(t=dt.prototype).ia=function(t,e){return(t=_t(t,t,e)).c=!0,Ct(this,t),this},t.s=function(t,e){return It(this,null,t,e)},t.cancel=function(t){this.a==yt&&ht(function(){!function t(e,n){if(e.a==yt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==e&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==yt&&1==i?t(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Rt(r),Pt(r,o,gt,n)))}e.c=null}else At(e,gt,n)}(this,new Lt(t))},this)},t.Nc=function(t){this.a=yt,At(this,mt,t)},t.Oc=function(t){this.a=yt,At(this,gt,t)},t.Yb=function(){for(var t;t=Rt(this);)Pt(this,t,this.a,this.i);this.h=!1};var Ot=ct;function Lt(t){E.call(this,t)}function xt(){0!=Mt&&(Ft[this[f]||(this[f]=++p)]=this),this.qa=this.qa,this.ja=this.ja}b(Lt,E),Lt.prototype.name="cancel";var Mt=0,Ft={};function Ut(t){if(!t.qa&&(t.qa=!0,t.va(),0!=Mt)){var e=t[f]||(t[f]=++p);if(0!=Mt&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ft[e]}}function Vt(t){return Vt[" "](t),t}xt.prototype.qa=!1,xt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Vt[" "]=o;var Bt,qt,jt=et("Opera"),Wt=et("Trident")||et("MSIE"),Kt=et("Edge"),Ht=Kt||Wt,Gt=et("Gecko")&&!(X(W.toLowerCase(),"webkit")&&!et("Edge"))&&!(et("Trident")||et("MSIE"))&&!et("Edge"),$t=X(W.toLowerCase(),"webkit")&&!et("Edge");function Qt(){var t=n.document;return t?t.documentMode:void 0}t:{var zt="",Yt=(qt=W,Gt?/rv:([^\);]+)(\)|;)/.exec(qt):Kt?/Edge\/([\d\.]+)/.exec(qt):Wt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(qt):$t?/WebKit\/(\S+)/.exec(qt):jt?/(?:Version)[ \/]?(\S+)/.exec(qt):void 0);if(Yt&&(zt=Yt?Yt[1]:""),Wt){var Xt=Qt();if(null!=Xt&&Xt>parseFloat(zt)){Bt=String(Xt);break t}}Bt=zt}var Jt,Zt={};function te(t){return function(t,e){var n=Zt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=q(String(Bt)).split("."),r=q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=J(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==a[2].length,0==s[2].length)||J(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var ee=n.document;Jt=ee&&Wt?Qt()||("CSS1Compat"==ee.compatMode?parseInt(Bt,10):5):void 0;var ne=Object.freeze||function(t){return t},re=!Wt||9<=Number(Jt),ie=Wt&&!te("9"),oe=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return n.addEventListener("test",o,e),n.removeEventListener("test",o,e),t}();function ae(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function se(t,e){if(ae.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Gt){t:{try{Vt(e.nodeName);var o=!0;break t}catch(t){}o=!1}o||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===i?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=r(t.pointerType)?t.pointerType:ue[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}ae.prototype.preventDefault=function(){this.Kb=!1},b(se,ae);var ue=ne({2:"touch",3:"pen",4:"mouse"});se.prototype.preventDefault=function(){se.ob.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ie)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},se.prototype.f=function(){return this.a};var ce="closure_listenable_"+(1e6*Math.random()|0),he=0;function le(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.La=null}function fe(t){this.src=t,this.a={},this.b=0}function pe(t,e){var n=e.type;n in t.a&&M(t.a[n],e)&&(le(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function de(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}fe.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=de(t,e,r,i);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++he,this.oa=this.Ia=!1}(e,this.src,o,!!r,i)).Ia=n,t.push(e)),e};var ye="closure_lm_"+(1e6*Math.random()|0),me={};function ge(t,e,n,r,i){if(r&&r.once)be(t,e,n,r,i);else if(u(e))for(var o=0;o<e.length;o++)ge(t,e[o],n,r,i);else n=Ne(n),t&&t[ce]?Re(t,e,n,l(r)?!!r.capture:!!r,i):ve(t,e,n,!1,r,i)}function ve(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=l(i)?!!i.capture:!!i,s=Ie(t);if(s||(t[ye]=s=new fe(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=Ce,e=re?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)oe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ee(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function be(t,e,n,r,i){if(u(e))for(var o=0;o<e.length;o++)be(t,e[o],n,r,i);else n=Ne(n),t&&t[ce]?Pe(t,e,n,l(r)?!!r.capture:!!r,i):ve(t,e,n,!0,r,i)}function _e(t,e,n,r,i){if(u(e))for(var o=0;o<e.length;o++)_e(t,e[o],n,r,i);else r=l(r)?!!r.capture:!!r,n=Ne(n),t&&t[ce]?(t=t.l,(e=String(e).toString())in t.a&&-1<(n=de(o=t.a[e],n,r,i))&&(le(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Ie(t))&&(e=t.a[e.toString()],t=-1,e&&(t=de(e,n,r,i)),(n=-1<t?e[t]:null)&&we(n))}function we(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[ce])pe(e.l,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ee(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ie(e))?(pe(n,t),0==n.b&&(n.src=null,e[ye]=null)):le(t)}}}function Ee(t){return t in me?me[t]:me[t]="on"+t}function Te(t,e,n,r){var i=!0;if((t=Ie(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=Se(o,r),i=i&&!1!==o)}return i}function Se(t,e){var n=t.listener,r=t.La||t.src;return t.Ia&&we(t),n.call(r,e)}function Ce(t,e){if(t.oa)return!0;if(!re){if(!e)t:{e=["window","event"];for(var r=n,i=0;i<e.length;i++)if(null==(r=r[e[i]])){e=null;break t}e=r}if(e=new se(i=e,this),r=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var o=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(t){o=!0}(o||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],o=e.b;o;o=o.parentNode)i.push(o);for(t=t.type,o=i.length-1;0<=o;o--){e.b=i[o];var a=Te(i[o],t,!0,e);r=r&&a}for(o=0;o<i.length;o++)e.b=i[o],a=Te(i[o],t,!1,e),r=r&&a}return r}return Se(t,new se(e,this))}function Ie(t){return(t=t[ye])instanceof fe?t:null}var Ae="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ne(t){return h(t)?t:(t[Ae]||(t[Ae]=function(e){return t.handleEvent(e)}),t[Ae])}function De(){xt.call(this),this.l=new fe(this),this.Rb=this,this.Va=null}function Re(t,e,n,r,i){t.l.add(String(e),n,!1,r,i)}function Pe(t,e,n,r,i){t.l.add(String(e),n,!0,r,i)}function ke(t,e,n,r){if(!(e=t.l.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&pe(t.l,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Kb}function Oe(t,e,r){if(h(t))r&&(t=m(t,r));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:n.setTimeout(t,e||0)}function Le(t){var e=null;return new dt(function(n,r){-1==(e=Oe(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).s(function(t){throw n.clearTimeout(e),t})}function xe(t){if(t.S&&"function"==typeof t.S)return t.S();if(r(t))return t.split("");if(c(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function Me(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(c(t)||r(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ue(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ve(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ve(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}b(De,xt),De.prototype[ce]=!0,De.prototype.addEventListener=function(t,e,n,r){ge(this,t,e,n,r)},De.prototype.removeEventListener=function(t,e,n,r){_e(this,t,e,n,r)},De.prototype.dispatchEvent=function(t){var e,n=this.Va;if(n)for(e=[];n;n=n.Va)e.push(n);n=this.Rb;var i=t.type||t;if(r(t))t=new ae(t,n);else if(t instanceof ae)t.target=t.target||n;else{var o=t;ut(t=new ae(i,n),o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var s=t.b=e[a];o=ke(s,i,!0,t)&&o}if(o=ke(s=t.b=n,i,!0,t)&&o,o=ke(s,i,!1,t)&&o,e)for(a=0;a<e.length;a++)o=ke(s=t.b=e[a],i,!1,t)&&o;return o},De.prototype.va=function(){if(De.ob.va.call(this),this.l){var t,e=this.l;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)le(n[r]);delete e.a[t],e.b--}}this.Va=null},(t=Fe.prototype).S=function(){Ue(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return Ue(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Ve(this.b,t)?this.b[t]:e},t.set=function(t,e){Ve(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function qe(t,e){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof qe){this.f=void 0!==e?e:t.f,je(this,t.c),this.l=t.l,this.b=t.b,We(this,t.i),this.g=t.g,e=t.a;var n=new rn;n.c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Ke(this,n),this.h=t.h}else t&&(n=String(t).match(Be))?(this.f=!!e,je(this,n[1]||"",!0),this.l=ze(n[2]||""),this.b=ze(n[3]||"",!0),We(this,n[4]),this.g=ze(n[5]||"",!0),Ke(this,n[6]||"",!0),this.h=ze(n[7]||"")):(this.f=!!e,this.a=new rn(null,this.f))}function je(t,e,n){t.c=n?ze(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function We(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Ke(t,e,n){e instanceof rn?(t.a=e,function(t,e){e&&!t.f&&(on(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(sn(this,e),cn(this,n,t))},t)),t.f=e}(t.a,t.f)):(n||(e=Ye(e,en)),t.a=new rn(e,t.f))}function He(t,e,n){t.a.set(e,n)}function Ge(t,e){return t.a.get(e)}function $e(t){return t instanceof qe?new qe(t):new qe(t,void 0)}function Qe(t,e){var n=new qe(null,void 0);return je(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ye(t,e,n){return r(t)?(t=encodeURI(t).replace(e,Xe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Xe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}qe.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Ye(e,Je,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Ye(e,Je,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ye(n,"/"==n.charAt(0)?tn:Ze,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Ye(n,nn)),t.join("")};var Je=/[#\/\?@]/g,Ze=/[#\?:]/g,tn=/[#\?]/g,en=/[#\?@]/g,nn=/#/g;function rn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function on(t){t.a||(t.a=new Fe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function an(t){var e=Me(t);if(void 0===e)throw Error("Keys are undefined");var n=new rn(null,void 0);t=xe(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];u(o)?cn(n,i,o):n.add(i,o)}return n}function sn(t,e){on(t),e=hn(t,e),Ve(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ve((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ue(t)))}function un(t,e){return on(t),e=hn(t,e),Ve(t.a.b,e)}function cn(t,e,n){sn(t,e),0<n.length&&(t.c=null,t.a.set(hn(t,e),V(n)),t.b+=n.length)}function hn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=rn.prototype).add=function(t,e){on(this),this.c=null,t=hn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){on(this),this.a.forEach(function(n,r){k(n,function(n){t.call(e,n,r,this)},this)},this)},t.U=function(){on(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.S=function(t){on(this);var e=[];if(r(t))un(this,t)&&(e=U(e,this.a.get(hn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=U(e,t[n])}return e},t.set=function(t,e){return on(this),this.c=null,un(this,t=hn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return 0<(t=t?this.S(t):[]).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ln=!Wt||9<=Number(Jt);function fn(){this.a="",this.b=dn}function pn(t){return t instanceof fn&&t.constructor===fn&&t.b===dn?t.a:(S("expected object of type Const, got '"+t+"'"),"type_error:Const")}fn.prototype.na=!0,fn.prototype.ma=function(){return this.a},fn.prototype.toString=function(){return"Const{"+this.a+"}"};var dn={};function yn(t){var e=new fn;return e.a=t,e}function mn(){this.a="",this.b=wn}function gn(t){return t instanceof mn&&t.constructor===mn&&t.b===wn?t.a:(S("expected object of type TrustedResourceUrl, got '"+t+"' of type "+a(t)),"type_error:TrustedResourceUrl")}function vn(t,e){var n=pn(t);if(!_n.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=new mn;return e.a=t,e}(t=n.replace(bn,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof fn?pn(t):encodeURIComponent(String(t))}))}yn(""),mn.prototype.na=!0,mn.prototype.ma=function(){return this.a},mn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var bn=/%{(\w+)}/g,_n=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,wn={};function En(){this.a="",this.b=In}function Tn(t){return t instanceof En&&t.constructor===En&&t.b===In?t.a:(S("expected object of type SafeUrl, got '"+t+"' of type "+a(t)),"type_error:SafeUrl")}En.prototype.na=!0,En.prototype.ma=function(){return this.a},En.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Sn=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function Cn(t){return t instanceof En?t:(t=t.na?t.ma():String(t),Sn.test(t)||(t="about:invalid#zClosurez"),An(t))}var In={};function An(t){var e=new En;return e.a=t,e}function Nn(){this.a="",this.b=Dn}An("about:blank"),Nn.prototype.na=!0,Nn.prototype.ma=function(){return this.a},Nn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Dn={};function Rn(t){var e=new Nn;return e.a=t,e}function Pn(t){var e=document;return r(t)?e.getElementById(t):t}function kn(t,e){nt(e,function(e,n){e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:On.hasOwnProperty(n)?t.setAttribute(On[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}Rn("<!DOCTYPE html>"),Rn(""),Rn("<br>");var On={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Ln(t){if(t&&"number"==typeof t.length){if(l(t))return"function"==typeof t.item||"string"==typeof t.item;if(h(t))return"function"==typeof t.item}return!1}function xn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(u(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),t(e,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Un(i,r),r.push(":"),t(e,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Un(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new function(){},t,e),e.join("")}var Mn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Fn=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Un(t,e){e.push('"',t.replace(Fn,function(t){var e=Mn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Mn[t]=e),e}),'"')}function Vn(){var t=or();return Wt&&!!Jt&&11==Jt||/Edge\/\d+/.test(t)}function Bn(){return n.window&&n.window.location.href||self&&self.location&&self.location.href||""}function qn(t,e){e=e||n.window;var r="about:blank";t&&(r=Tn(Cn(t))),e.location.href=r}function Wn(t){return!!((t=(t||or()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Kn(t){t=t||n.window;try{t.close()}catch(t){}}function Hn(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=or().toLowerCase(),r&&(e.target=r,X(n,"crios/")&&(e.target="_blank")),nr(or())==tr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof En?n:Cn(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((et("iPhone")&&!et("iPod")&&!et("iPad")||et("iPad")||et("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),e instanceof En||e instanceof En||(e=e.na?e.ma():String(e),Sn.test(e)||(e="about:invalid#zClosurez"),e=An(e)),s.href=Tn(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=Tn(e),s&&(Ht&&X(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,yn("b/12014412, meta tag with sanitized URL"),t=Rn(t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+j(t)+'">'),s.document.write(function(t){return t instanceof Nn&&t.constructor===Nn&&t.b===Dn?t.a:(S("expected object of type SafeHtml, got '"+t+"' of type "+a(t)),"type_error:SafeHtml")}(t)),s.document.close())):(s=r.open(Tn(e),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var Gn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$n=/^[^@]+@[^@]+$/;function Qn(){var t=null;return new dt(function(e){"complete"==n.document.readyState?e():(t=function(){e()},be(window,"load",t))}).s(function(e){throw _e(window,"load",t),e})}function zn(t){return t=t||or(),!("file:"!==hr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Yn(){var t=n.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Xn(){return"object"!=typeof n.window&&"function"==typeof n.importScripts}function Jn(){return jn.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":jn.INTERNAL.hasOwnProperty("node")?"Node":Xn()?"Worker":"Browser"}function Zn(){var t=Jn();return"ReactNative"===t||"Node"===t}var tr="Firefox",er="Chrome";function nr(t){var e=t.toLowerCase();return X(e,"opera/")||X(e,"opr/")||X(e,"opios/")?"Opera":X(e,"iemobile")?"IEMobile":X(e,"msie")||X(e,"trident/")?"IE":X(e,"edge/")?"Edge":X(e,"firefox/")?tr:X(e,"silk/")?"Silk":X(e,"blackberry")?"Blackberry":X(e,"webos")?"Webos":!X(e,"safari/")||X(e,"chrome/")||X(e,"crios/")||X(e,"android")?!X(e,"chrome/")&&!X(e,"crios/")||X(e,"edge/")?X(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":er:"Safari"}var rr={Uc:"FirebaseCore-web",Wc:"FirebaseUI-web"};function ir(t,e){e=e||[];var n,r=[],i={};for(n in rr)i[rr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Jn())?r=nr(i=or()):"Worker"===r&&(r=nr(i=or())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function or(){return n.navigator&&n.navigator.userAgent||""}function ar(t,e){t=t.split("."),e=e||n;for(var r=0;r<t.length&&"object"==typeof e&&null!=e;r++)e=e[t[r]];return r!=t.length&&(e=void 0),e}function sr(){try{var t=n.localStorage,e=yr();if(t)return t.setItem(e,"1"),t.removeItem(e),!Vn()||!!n.indexedDB}catch(t){return Xn()&&!!n.indexedDB}return!1}function ur(){return(cr()||"chrome-extension:"===hr()||zn())&&!Zn()&&sr()&&!Xn()}function cr(){return"http:"===hr()||"https:"===hr()}function hr(){return n.location&&n.location.protocol||null}function lr(t){return!Wn(t=t||or())&&nr(t)!=tr}function fr(t){return void 0===t?null:xn(t)}function pr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function dr(t){if(null!==t)return JSON.parse(t)}function yr(t){return t||Math.floor(1e9*Math.random()).toString()}function mr(t){return"Safari"!=nr(t=t||or())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function gr(){var t=n.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var r=0;r<t.CP.length;r++)t.CP[r]=null}function vr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=or(),e=Jn(),this.b=Wn(t)||"ReactNative"===e}function br(){var t=n.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function _r(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function wr(){return!(!ar("fireauth.oauthhelper",n)&&!ar("fireauth.iframe",n))}vr.prototype.get=function(){var t=n.navigator;return!t||"boolean"!=typeof t.onLine||!cr()&&"chrome-extension:"!==hr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Er,Tr={};function Sr(t){Tr[t]||(Tr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Cr={};Object.defineProperty(Cr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Cr,"abcd",{configurable:!0,enumerable:!0,value:2}),Er=2==Cr.abcd}catch(qt){Er=!1}function Ir(t,e,n){Er?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ar(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Ir(t,n,e[n])}function Nr(t){var e={};return Ar(e,t),e}function Dr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Ir(e,n,Dr(t[n]));return e}function Rr(t,e){this.code=kr+t,this.message=e||Or[t]||""}function Pr(t){var e=t&&t.code;return e?new Rr(e.substring(kr.length),t.message):null}b(Rr,Error),Rr.prototype.C=function(){return{code:this.code,message:this.message}},Rr.prototype.toJSON=function(){return this.C()};var kr="auth/",Or={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Lr(t){var e=t[Vr];if(void 0===e)throw new Rr("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Rr("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[xr];if(n&&"object"==typeof n){e=n[jr];var r=n[Br];if(n=n[qr],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Rr("argument-error",Br+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Rr("argument-error",qr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Rr("argument-error",jr+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Rr("missing-android-pkg-name")}}else if(void 0!==n)throw new Rr("argument-error",xr+" property must be a non null object when specified.");if(this.f=null,(e=t[Ur])&&"object"==typeof e){if("string"==typeof(e=e[Wr])&&e.length)this.f=e;else if(void 0!==e)throw new Rr("argument-error",Wr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Rr("argument-error",Ur+" property must be a non null object when specified.");if(void 0!==(e=t[Fr])&&"boolean"!=typeof e)throw new Rr("argument-error",Fr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Mr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Rr("argument-error",Mr+" property must be a non empty string when specified.");this.i=t||null}var xr="android",Mr="dynamicLinkDomain",Fr="handleCodeInApp",Ur="iOS",Vr="url",Br="installApp",qr="minimumVersion",jr="packageName",Wr="bundleId";function Kr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Hr=null,Gr=null;function $r(t){this.c=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Qr(t){return(t=zr(t))&&t.sub&&t.iss&&t.aud&&t.exp?new $r(t):null}function zr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(function(t){var e="";return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Gr[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Hr){Hr={},Gr={};for(var t=0;65>t;t++)Hr[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Gr[Hr[t]]=t,62<=t&&(Gr["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}(t))}catch(t){}return null}$r.prototype.f=function(){return this.b};var Yr,Xr={$c:{ab:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},bd:{ab:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},cd:{ab:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Jr(t){for(var e in Xr)if(Xr[e].id===t)return{firebaseEndpoint:(t=Xr[e]).ab,secureTokenEndpoint:t.ib};return null}Yr=Jr("__EID__")?"__EID__":void 0;var Zr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),ti=["client_id","response_type","scope","redirect_uri","state"],ei={Vc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",hb:ti},Xc:{Ma:null,Ba:500,Aa:620,Na:"github.com",hb:ti},Yc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",hb:ti},dd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",hb:Zr}};function ni(t){for(var e in ei)if(ei[e].Na==t)return ei[e];return null}function ri(t){var e={};e["facebook.com"]=ui,e["google.com"]=hi,e["github.com"]=ci,e["twitter.com"]=li;var n=t&&t[oi];try{if(n)return e[n]?new e[n](t):new si(t);if(void 0!==t[ii])return new ai(t)}catch(t){}return null}var ii="idToken",oi="providerId";function ai(t){var e=t[oi];if(!e&&t[ii]){var n=Qr(t[ii]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Ir(this,"providerId",e),Ir(this,"isNewUser",n)}function si(t){ai.call(this,t),Ir(this,"profile",Dr((t=dr(t.rawUserInfo||"{}"))||{}))}function ui(t){if(si.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ci(t){if(si.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Ir(this,"username",this.profile&&this.profile.login||null)}function hi(t){if(si.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function li(t){if(si.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Ir(this,"username",t.screenName||null)}function fi(t){var e=$e(t),n=Ge(e,"link"),r=Ge($e(n),"link");return Ge($e(e=Ge(e,"deep_link_id")),"link")||e||r||n||t}function pi(t,e){return t.then(function(t){if(t[zo]){var n=Qr(t[zo]);if(!n||e!=n.c)throw new Rr("user-mismatch");return t}throw new Rr("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==kr+"user-not-found"?new Rr("user-mismatch"):t})}function di(t,e){if(!e)throw new Rr("internal-error","failed to construct a credential");this.a=e,Ir(this,"providerId",t),Ir(this,"signInMethod",t)}function yi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function mi(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Ir(this,"idToken",e.idToken),e.accessToken&&Ir(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Ir(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Rr("internal-error","failed to construct a credential");Ir(this,"accessToken",e.oauthToken),Ir(this,"secret",e.oauthTokenSecret)}Ir(this,"providerId",t),Ir(this,"signInMethod",n)}function gi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:an(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function vi(t,e){this.Dc=e||[],Ar(this,{providerId:t,isOAuthProvider:!0}),this.yb={},this.cb=(ni(t)||{}).Ma||null,this.$a=null}function bi(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Rr("argument-error",'SAML provider IDs must be prefixed with "saml."');vi.call(this,t,[])}function _i(t){vi.call(this,t,ti),this.a=[]}function wi(){_i.call(this,"facebook.com")}function Ei(t){if(!t)throw new Rr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return l(t)&&(e=t.accessToken),(new wi).credential(null,e)}function Ti(){_i.call(this,"github.com")}function Si(t){if(!t)throw new Rr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return l(t)&&(e=t.accessToken),(new Ti).credential(null,e)}function Ci(){_i.call(this,"google.com"),this.ua("profile")}function Ii(t,e){var n=t;return l(t)&&(n=t.idToken,e=t.accessToken),(new Ci).credential(n,e)}function Ai(){vi.call(this,"twitter.com",Zr)}function Ni(t,e){var n=t;if(l(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Rr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new mi("twitter.com",n,"twitter.com")}function Di(t,e,n){this.a=t,this.c=e,Ir(this,"providerId","password"),Ir(this,"signInMethod",n===Ri.EMAIL_LINK_SIGN_IN_METHOD?Ri.EMAIL_LINK_SIGN_IN_METHOD:Ri.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Ri(){Ar(this,{providerId:"password",isOAuthProvider:!1})}function Pi(t,e){if(!(e=ki(e)))throw new Rr("argument-error","Invalid email link!");return new Di(t,e,Ri.EMAIL_LINK_SIGN_IN_METHOD)}function ki(t){var e=Ge((t=new function(t){this.a=$e(t)}(t=fi(t))).a,"oobCode")||null;return"signIn"===(Ge(t.a,"mode")||null)&&e?e:null}function Oi(t){if(!(t.Ta&&t.Sa||t.Fa&&t.$))throw new Rr("internal-error");this.a=t,Ir(this,"providerId","phone"),Ir(this,"signInMethod","phone")}function Li(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ta,code:t.a.Sa}}function xi(t){try{this.a=t||jn.auth()}catch(t){throw new Rr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ar(this,{providerId:"phone",isOAuthProvider:!1})}function Mi(t,e){if(!t)throw new Rr("missing-verification-id");if(!e)throw new Rr("missing-verification-code");return new Oi({Ta:t,Sa:e})}function Fi(t){if(t.temporaryProof&&t.phoneNumber)return new Oi({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Ii(o,n);case"facebook.com":return Ei(n);case"github.com":return Si(n);case"twitter.com":return Ni(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new di(e,a):new mi(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new _i(e).credential(o,n,i):null}}catch(t){return null}}function Ui(t){if(!t.isOAuthProvider)throw new Rr("invalid-oauth-provider")}function Vi(t,e,n,r,i,o){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.h=o||null,this.a=i||null,!this.f&&!this.a)throw new Rr("invalid-auth-event");if(this.f&&this.a)throw new Rr("invalid-auth-event");if(this.f&&!this.g)throw new Rr("invalid-auth-event")}function Bi(t){return(t=t||{}).type?new Vi(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Pr(t.error),t.postBody):null}function qi(){this.b=null,this.a=[]}b(si,ai),b(ui,si),b(ci,si),b(hi,si),b(li,si),di.prototype.la=function(t){return pa(t,yi(this))},di.prototype.b=function(t,e){var n=yi(this);return n.idToken=e,da(t,n)},di.prototype.f=function(t,e){return pi(ya(t,yi(this)),e)},di.prototype.C=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},mi.prototype.la=function(t){return pa(t,gi(this))},mi.prototype.b=function(t,e){var n=gi(this);return n.idToken=e,da(t,n)},mi.prototype.f=function(t,e){return pi(ya(t,gi(this)),e)},mi.prototype.C=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},vi.prototype.Da=function(t){return this.yb=it(t),this},b(bi,vi),b(_i,vi),_i.prototype.ua=function(t){return x(this.a,t)||this.a.push(t),this},_i.prototype.Eb=function(){return V(this.a)},_i.prototype.credential=function(t,e,n){if(!t&&!e)throw new Rr("argument-error","credential failed: must provide the ID token and/or the access token.");return new mi(this.providerId,{idToken:t||null,accessToken:e||null,nonce:n||null},this.providerId)},b(wi,_i),Ir(wi,"PROVIDER_ID","facebook.com"),Ir(wi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),b(Ti,_i),Ir(Ti,"PROVIDER_ID","github.com"),Ir(Ti,"GITHUB_SIGN_IN_METHOD","github.com"),b(Ci,_i),Ir(Ci,"PROVIDER_ID","google.com"),Ir(Ci,"GOOGLE_SIGN_IN_METHOD","google.com"),b(Ai,vi),Ir(Ai,"PROVIDER_ID","twitter.com"),Ir(Ai,"TWITTER_SIGN_IN_METHOD","twitter.com"),Di.prototype.la=function(t){return this.signInMethod==Ri.EMAIL_LINK_SIGN_IN_METHOD?Ka(t,Ta,{email:this.a,oobCode:this.c}):Ka(t,Ba,{email:this.a,password:this.c})},Di.prototype.b=function(t,e){return this.signInMethod==Ri.EMAIL_LINK_SIGN_IN_METHOD?Ka(t,Sa,{idToken:e,email:this.a,oobCode:this.c}):Ka(t,La,{idToken:e,email:this.a,password:this.c})},Di.prototype.f=function(t,e){return pi(this.la(t),e)},Di.prototype.C=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Ar(Ri,{PROVIDER_ID:"password"}),Ar(Ri,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ar(Ri,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Oi.prototype.la=function(t){return t.Ua(Li(this))},Oi.prototype.b=function(t,e){var n=Li(this);return n.idToken=e,Ka(t,ja,n)},Oi.prototype.f=function(t,e){var n=Li(this);return n.operation="REAUTH",pi(t=Ka(t,Wa,n),e)},Oi.prototype.C=function(){var t={providerId:"phone"};return this.a.Ta&&(t.verificationId=this.a.Ta),this.a.Sa&&(t.verificationCode=this.a.Sa),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},xi.prototype.Ua=function(t,e){var n=this.a.b;return wt(e.verify()).then(function(i){if(!r(i))throw new Rr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return Ka(n,ka,e)}(0,{phoneNumber:t,recaptchaToken:i}).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Rr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Ar(xi,{PROVIDER_ID:"phone"}),Ar(xi,{PHONE_SIGN_IN_METHOD:"phone"}),Vi.prototype.C=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,postBody:this.h,error:this.a&&this.a.C()}};var ji,Wi=null;function Ki(t){var e="unauthorized-domain",n=void 0,r=$e(t);t=r.b,"chrome-extension"==(r=r.c)?n=B("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=B("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Rr.call(this,e,n)}function Hi(t,e,n){Rr.call(this,t,n),(t=e||{}).zb&&Ir(this,"email",t.zb),t.$&&Ir(this,"phoneNumber",t.$),t.credential&&Ir(this,"credential",t.credential)}function Gi(t){if(t.code){var e=t.code||"";0==e.indexOf(kr)&&(e=e.substring(kr.length));var n={credential:Fi(t)};if(t.email)n.zb=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Rr(e,t.message||void 0);return new Hi(e,n,t.message)}return null}function $i(){}function Qi(t){return t.c||(t.c=t.b())}function zi(){}function Yi(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Xi(){}function Ji(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=m(this.ec,this),this.a.onerror=m(this.Fb,this),this.a.onprogress=m(this.fc,this),this.a.ontimeout=m(this.ic,this)}function Zi(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function to(t,e,n){this.reset(t,e,n,void 0,void 0)}function eo(t){this.f=t,this.b=this.c=this.a=null}function no(t,e){this.name=t,this.value=e}qi.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=ar("universalLinks.subscribe",n))&&t(null,this.b))},qi.prototype.unsubscribe=function(t){F(this.a,function(e){return e==t})},b(Ki,Rr),b(Hi,Rr),Hi.prototype.C=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.C();return e&&ut(t,e),t},Hi.prototype.toJSON=function(){return this.C()},$i.prototype.c=null,b(zi,$i),zi.prototype.a=function(){var t=Yi(this);return t?new ActiveXObject(t):new XMLHttpRequest},zi.prototype.b=function(){var t={};return Yi(this)&&(t[0]=!0,t[1]=!0),t},ji=new zi,b(Xi,$i),Xi.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Ji;throw Error("Unsupported browser")},Xi.prototype.b=function(){return{}},(t=Ji.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.ec=function(){this.status=200,this.responseText=this.a.responseText,Zi(this,4)},t.Fb=function(){this.status=500,this.responseText="",Zi(this,4)},t.ic=function(){this.Fb()},t.fc=function(){this.status=200,Zi(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},to.prototype.a=null,to.prototype.reset=function(t,e,n,r,i){delete this.a},no.prototype.toString=function(){return this.name};var ro=new no("SEVERE",1e3),io=new no("WARNING",900),oo=new no("CONFIG",700),ao=new no("FINE",500);eo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(S("Root logger has no level set."),null)}(this).value)for(h(e)&&(e=e()),t=new to(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var so={},uo=null;function co(t){var e;if(uo||(uo=new eo(""),so[""]=uo,uo.c=oo),!(e=so[t])){e=new eo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=co(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,so[t]=e}return e}function ho(t,e){t&&t.log(ao,e,void 0)}function lo(t){this.f=t}function fo(t){De.call(this),this.i=t,this.readyState=po,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=co("goog.net.FetchXmlHttp")}b(lo,$i),lo.prototype.a=function(){return new fo(this.f)},lo.prototype.b=function(t){return function(){return t}}({}),b(fo,De);var po=0;function yo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function mo(t){De.call(this),this.headers=new Fe,this.D=t||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.m="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=go,this.v=this.O=!1}(t=fo.prototype).open=function(t,e){if(this.readyState!=po)throw this.abort(),Error("Error reopening a connection");this.h=t,this.c=e,this.readyState=1,yo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.g,method:this.h,credentials:void 0,cache:void 0};t&&(e.body=t),this.i.fetch(new Request(this.c,e)).then(this.hc.bind(this),this.Gb.bind(this))},t.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,yo(this)),this.readyState=po},t.hc=function(t){this.a&&(this.b||(this.b=t.headers,this.readyState=2,yo(this)),this.a&&(this.readyState=3,yo(this),this.a&&t.text().then(this.gc.bind(this,t),this.Gb.bind(this))))},t.gc=function(t,e){this.a&&(this.status=t.status,this.statusText=t.statusText,this.responseText=e,this.readyState=4,yo(this))},t.Gb=function(t){var e=this.f;e&&e.log(io,"Failed to fetch url "+this.c,t instanceof Error?t:Error(t)),this.a&&(this.readyState=4,yo(this))},t.setRequestHeader=function(t,e){this.g.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.f)&&t.log(io,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.f;return t&&t.log(io,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},b(mo,De);var go="";mo.prototype.b=co("goog.net.XhrIo");var vo=/^https?$/i,bo=["POST","PUT"];function _o(t,e,i,o,a){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.m+"; newUri="+e);i=i?i.toUpperCase():"GET",t.m=e,t.h="",t.N=i,t.G=!1,t.c=!0,t.a=t.D?t.D.a():ji.a(),t.w=t.D?Qi(t.D):Qi(ji),t.a.onreadystatechange=m(t.Jb,t);try{ho(t.b,Do(t,"Opening Xhr")),t.I=!0,t.a.open(i,String(e),!0),t.I=!1}catch(e){return ho(t.b,Do(t,"Error opening Xhr: "+e.message)),void Eo(t,e)}e=o||"";var s=new Fe(t.headers);a&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(c(t)||r(t))k(t,e,void 0);else for(var n=Me(t),i=xe(t),o=i.length,a=0;a<o;a++)e.call(void 0,i[a],n&&n[a],t)}(a,function(t,e){s.set(e,t)}),a=function(t){t:{for(var e=wo,n=t.length,i=r(t)?t.split(""):t,o=0;o<n;o++)if(o in i&&e.call(void 0,i[o],o,t)){e=o;break t}e=-1}return 0>e?null:r(t)?t.charAt(e):t[e]}(s.U()),o=n.FormData&&e instanceof n.FormData,!x(bo,i)||a||o||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Io(t),0<t.g&&(t.v=function(t){return Wt&&te(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ho(t.b,Do(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=m(t.Ga,t)):t.u=Oe(t.Ga,t.g,t)),ho(t.b,Do(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){ho(t.b,Do(t,"Send error: "+e.message)),Eo(t,e)}}function wo(t){return"content-type"==t.toLowerCase()}function Eo(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,To(t),Co(t)}function To(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function So(t){if(t.c&&void 0!==e)if(t.w[1]&&4==Ao(t)&&2==No(t))ho(t.b,Do(t,"Local request error detected and ignored"));else if(t.i&&4==Ao(t))Oe(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ao(t)){ho(t.b,Do(t,"Request complete")),t.c=!1;try{var r,i=No(t);t:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}if(!(r=o)){var a;if(a=0===i){var s=String(t.m).match(Be)[1]||null;if(!s&&n.self&&n.self.location){var u=n.self.location.protocol;s=u.substr(0,u.length-1)}a=!vo.test(s?s.toLowerCase():"")}r=a}if(r)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ao(t)?t.a.statusText:""}catch(e){ho(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+No(t)+"]",To(t)}}finally{Co(t)}}}function Co(t,e){if(t.a){Io(t);var n=t.a,r=t.w[0]?o:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ro,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Io(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(n.clearTimeout(t.u),t.u=null)}function Ao(t){return t.a?t.a.readyState:0}function No(t){try{return 2<Ao(t)?t.a.status:-1}catch(t){return-1}}function Do(t,e){return e+" ["+t.N+" "+t.m+" "+No(t)+"]"}function Ro(t,e){this.g=[],this.v=t,this.u=e||null,this.f=this.a=!1,this.c=void 0,this.m=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function Po(t,e,n){t.a=!0,t.c=n,t.f=!e,xo(t)}function ko(t){if(t.a){if(!t.m)throw new Mo(t);t.m=!1}}function Oo(t,e,n,r){t.g.push([e,n,r]),t.a&&xo(t)}function Lo(t){return L(t.g,function(t){return h(t[1])})}function xo(t){if(t.h&&t.a&&Lo(t)){var e=t.h,r=Vo[e];r&&(n.clearTimeout(r.a),delete Vo[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=r=!1;t.g.length&&!t.i;){var o=t.g.shift(),a=o[0],s=o[1];if(o=o[2],a=t.f?s:a)try{var u=a.call(o||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(w(e)||"function"==typeof n.Promise&&e instanceof n.Promise)&&(i=!0,t.i=!0)}catch(n){e=n,t.f=!0,Lo(t)||(r=!0)}}t.c=e,i&&(u=m(t.o,t,!0),i=m(t.o,t,!1),e instanceof Ro?(Oo(e,u,i),e.w=!0):e.then(u,i)),r&&(e=new Uo(e),Vo[e.a]=e,t.h=e.a)}function Mo(){E.call(this)}function Fo(){E.call(this)}function Uo(t){this.a=n.setTimeout(m(this.c,this),0),this.b=t}(t=mo.prototype).Ga=function(){void 0!==e&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ho(this.b,Do(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ho(this.b,Do(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Co(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Co(this,!0)),mo.ob.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?So(this):this.wc())},t.wc=function(){So(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case go:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ro,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return ho(this.b,"Can not get response: "+t.message),null}},Ro.prototype.cancel=function(t){if(this.a)this.c instanceof Ro&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.u,this):this.m=!0,this.a||(t=new Fo(this),ko(this),Po(this,!1,t))}},Ro.prototype.o=function(t,e){this.i=!1,Po(this,t,e)},Ro.prototype.D=function(){ko(this),Po(this,!0,null)},Ro.prototype.then=function(t,e,n){var r,i,o=new dt(function(t,e){r=t,i=e});return Oo(this,r,function(t){t instanceof Fo?o.cancel():i(t)}),o.then(t,e,n)},_(Ro),b(Mo,E),Mo.prototype.message="Deferred has already fired",Mo.prototype.name="AlreadyCalledError",b(Fo,E),Fo.prototype.message="Deferred was canceled",Fo.prototype.name="CanceledError",Uo.prototype.c=function(){throw delete Vo[this.a],this.b};var Vo={};function Bo(t){var e={},n=e.document||document,r=gn(t),i=document.createElement("SCRIPT"),o={Lb:i,Ga:void 0},a=new Ro(qo,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){jo(i,!0);var t=new Ho(Ko,"Timeout reached for loading script "+r);ko(a),Po(a,!1,t)},u),o.Ga=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(jo(i,e.fd||!1,s),a.D())},i.onerror=function(){jo(i,!0,s);var t=new Ho(Wo,"Error while loading script "+r);ko(a),Po(a,!1,t)},ut(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),kn(i,o),i.src=gn(t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function qo(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&jo(t,!0,this.Ga)}}function jo(t,e,r){null!=r&&n.clearTimeout(r),t.onload=o,t.onerror=o,t.onreadystatechange=o,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var Wo=0,Ko=1;function Ho(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),E.call(this,n),this.code=t}function Go(t){this.f=t}function $o(t,e,r){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||Yo,this.f=it(t.secureTokenHeaders||Xo),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||Jo,this.a=it(t.firebaseHeaders||Zo),r&&(this.a["X-Client-Version"]=r,this.f["X-Client-Version"]=r),r="Node"==Jn(),!(r=n.XMLHttpRequest||r&&jn.INTERNAL.node&&jn.INTERNAL.node.XMLHttpRequest)&&!Xn())throw new Rr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,Xn()?this.c=new lo(self):Zn()?this.c=new Go(r):this.c=new Xi}b(Ho,E),b(Go,$i),Go.prototype.a=function(){return new this.f},Go.prototype.b=function(){return{}};var Qo,zo="idToken",Yo=new vr(3e4,6e4),Xo={"Content-Type":"application/x-www-form-urlencoded"},Jo=new vr(3e4,6e4),Zo={"Content-Type":"application/json"};function ta(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ea(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function na(t,e,r,i,o,a,s){(function(){var t=or();return!((t=nr(t)!=er?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Wt&&Jt&&!(9<Jt))})()||Xn()?t=m(t.o,t):(Qo||(Qo=new dt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{n[ia]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var r=vn(ra,{onload:ia});!function(t,e){Oo(Bo(r),null,e,void 0)}(0,function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=m(t.m,t)),t(e,r,i,o,a,s)}$o.prototype.o=function(t,e,r,i,o,a){if(Xn()&&(void 0===n.fetch||void 0===n.Headers||void 0===n.Request))throw new Rr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new mo(this.c);if(a){s.g=Math.max(0,a);var u=setTimeout(function(){s.dispatchEvent("timeout")},a)}Re(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ho(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)}),Pe(s,"ready",function(){u&&clearTimeout(u),Ut(this)}),Pe(s,"timeout",function(){u&&clearTimeout(u),Ut(this),e&&e(null)}),_o(s,t,r,i,o)};var ra=yn("https://apis.google.com/js/client.js?onload=%{onload}"),ia="__fcb"+Math.floor(1e6*Math.random()).toString();function oa(t){if(!r(t=t.email)||!$n.test(t))throw new Rr("invalid-email")}function aa(t){"email"in t&&oa(t)}function sa(t){if(!t[zo])throw new Rr("internal-error")}function ua(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Rr("internal-error")}else{if(!t.sessionInfo)throw new Rr("missing-verification-id");if(!t.code)throw new Rr("missing-verification-code")}}$o.prototype.m=function(t,e,n,r,i){var o=this;Qo.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},$o.prototype.Qa=function(){return Ka(this,xa,{})},$o.prototype.pb=function(t,e){return Ka(this,Oa,{idToken:t,email:e})},$o.prototype.qb=function(t,e){return Ka(this,La,{idToken:t,password:e})};var ca={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ha(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Rr("internal-error")}function la(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&un(t=new rn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function fa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Gi(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Gi(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Gi(t)):t.errorMessage&&(e=Ha(t.errorMessage)),e)throw e;if(!t[zo])throw new Rr("internal-error")}function pa(t,e){return e.returnIdpCredential=!0,Ka(t,Ma,e)}function da(t,e){return e.returnIdpCredential=!0,Ka(t,Ua,e)}function ya(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ka(t,Fa,e)}function ma(t){if(!t.oobCode)throw new Rr("invalid-action-code")}(t=$o.prototype).rb=function(t,e){var n={idToken:t},r=[];return nt(ca,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Ka(this,Oa,n)},t.kb=function(t,e){return ut(t={requestType:"PASSWORD_RESET",email:t},e),Ka(this,Na,t)},t.lb=function(t,e){return ut(t={requestType:"EMAIL_SIGNIN",email:t},e),Ka(this,Ia,t)},t.jb=function(t,e){return ut(t={requestType:"VERIFY_EMAIL",idToken:t},e),Ka(this,Aa,t)},t.Ua=function(t){return Ka(this,qa,t)},t.Za=function(t,e){return Ka(this,Pa,{oobCode:t,newPassword:e})},t.Ja=function(t){return Ka(this,va,{oobCode:t})},t.Wa=function(t){return Ka(this,ga,{oobCode:t})};var ga={endpoint:"setAccountInfo",B:ma,da:"email"},va={endpoint:"resetPassword",B:ma,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Rr("internal-error")}},ba={endpoint:"signupNewUser",B:function(t){if(oa(t),!t.password)throw new Rr("weak-password")},J:sa,R:!0},_a={endpoint:"createAuthUri"},wa={endpoint:"deleteAccount",T:["idToken"]},Ea={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(t){if(!u(t.deleteProvider))throw new Rr("internal-error")}},Ta={endpoint:"emailLinkSignin",T:["email","oobCode"],B:oa,J:sa,R:!0},Sa={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:oa,J:sa,R:!0},Ca={endpoint:"getAccountInfo"},Ia={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Rr("internal-error");oa(t)},da:"email"},Aa={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Rr("internal-error")},da:"email"},Na={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Rr("internal-error");oa(t)},da:"email"},Da={ub:!0,endpoint:"getProjectConfig",Ib:"GET"},Ra={ub:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Rr("internal-error")}},Pa={endpoint:"resetPassword",B:ma,da:"email"},ka={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},Oa={endpoint:"setAccountInfo",T:["idToken"],B:aa,R:!0},La={endpoint:"setAccountInfo",T:["idToken"],B:function(t){if(aa(t),!t.password)throw new Rr("weak-password")},J:sa,R:!0},xa={endpoint:"signupNewUser",J:sa,R:!0},Ma={endpoint:"verifyAssertion",B:ha,Oa:la,J:fa,R:!0},Fa={endpoint:"verifyAssertion",B:ha,Oa:la,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Rr("user-not-found");if(t.errorMessage)throw Ha(t.errorMessage);if(!t[zo])throw new Rr("internal-error")},R:!0},Ua={endpoint:"verifyAssertion",B:function(t){if(ha(t),!t.idToken)throw new Rr("internal-error")},Oa:la,J:fa,R:!0},Va={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new Rr("invalid-custom-token")},J:sa,R:!0},Ba={endpoint:"verifyPassword",B:function(t){if(oa(t),!t.password)throw new Rr("wrong-password")},J:sa,R:!0},qa={endpoint:"verifyPhoneNumber",B:ua,J:sa},ja={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new Rr("internal-error");ua(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Gi(t);sa(t)}},Wa={Xb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:ua,J:sa};function Ka(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.T))return Et(new Rr("internal-error"));var r,i=e.Ib||"POST";return wt(n).then(e.B).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,r,i,o){var a=$e(t.g+e);He(a,"key",t.b),o&&He(a,"cb",v().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&He(a,u,r[u]);return new dt(function(e,o){na(t,a.toString(),function(t){t?t.error?o(Ga(t,i||{})):e(t):o(new Rr("network-request-failed"))},n,s?void 0:xn(pr(r)),t.a,t.h.get())})}(t,e.endpoint,i,n,e.Xb,e.ub||!1)}).then(function(t){return r=t,e.Oa?e.Oa(n,r):r}).then(e.J).then(function(){if(!e.da)return r;if(!(e.da in r))throw new Rr("internal-error");return r[e.da]})}function Ha(t){return Ga({error:{errors:[{message:t}],code:400,message:t}})}function Ga(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Rr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",ut(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Rr(r[i],e);return!e&&t&&(e=fr(t)),new Rr("internal-error",e)}function $a(t){this.b=t,this.a=null,this.fb=function(t){return(Xa||(Xa=new dt(function(t,e){function r(){gr(),ar("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){gr(),e(Error("Network Error"))},timeout:za.get()})}if(ar("gapi.iframes.Iframe"))t();else if(ar("gapi.load"))r();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();n[i]=function(){ar("gapi.load")?r():e(Error("Network Error"))},wt(Bo(i=vn(Qa,{onload:i}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw Xa=null,t}))).then(function(){return new dt(function(e,n){ar("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},Ya.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var Qa=yn("https://apis.google.com/js/api.js?onload=%{onload}"),za=new vr(3e4,6e4),Ya=new vr(5e3,15e3),Xa=null;function Ja(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Qe(this.i,"/__/auth/iframe"),He(this.a,"apiKey",this.g),He(this.a,"appName",this.h),this.b=null,this.c=[]}function Za(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.l=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function ts(t){try{return jn.app(t).auth().ya()}catch(t){return[]}}function es(t,e,n,r,i){this.m=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.l=this.a=null}function ns(t){var e=Bn();return function(t){return Ka(t,Da,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=$e(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=$e(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Gn.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Ki(Bn())})}function rs(t){return t.l?t.l:(t.l=Qn().then(function(){if(!t.u){var e=t.c,n=t.h,r=ts(t.b),i=new Ja(t.m,t.f,t.b);i.f=e,i.b=n,i.c=V(r||[]),t.u=i.toString()}t.i=new $a(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.fb.then(function(){t.a.register("authEvent",e,ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Bi(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return(n={}).status=r?"ACK":"ERROR",wt(n)}return n.status="ERROR",wt(n)})}(t)}),t.l)}function is(t){return t.o||(t.v=t.c?ir(t.c,ts(t.b)):null,t.o=new $o(t.f,Jr(t.h),t.v)),t.o}function os(t,e,n,r,i,o,a,s,u,c){return(t=new Za(t,e,n,r,i)).i=o,t.g=a,t.h=s,t.b=it(u||null),t.f=c,t.toString()}function as(t){if(this.a=t||jn.INTERNAL.reactNative&&jn.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Rr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ss(t){this.b=t,this.a={},this.c=m(this.f,this)}Ja.prototype.toString=function(){return this.f?He(this.a,"v",this.f):sn(this.a.a,"v"),this.b?He(this.a,"eid",this.b):sn(this.a.a,"eid"),this.c.length?He(this.a,"fw",this.c.join(",")):sn(this.a.a,"fw"),this.a.toString()},Za.prototype.toString=function(){var t=Qe(this.o,"/__/auth/handler");if(He(t,"apiKey",this.m),He(t,"appName",this.c),He(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=jn.app(this.c).auth().ea()}catch(t){n=null}for(var r in e.$a=n,He(t,"providerId",this.a.providerId),n=pr((e=this.a).yb))n[r]=n[r].toString();r=e.Dc,n=it(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.cb&&e.$a&&!n[e.cb]&&(n[e.cb]=e.$a),rt(n)||He(t,"customParameters",fr(n))}if("function"==typeof this.a.Eb&&(e=this.a.Eb()).length&&He(t,"scopes",e.join(",")),this.i?He(t,"redirectUrl",this.i):sn(t.a,"redirectUrl"),this.g?He(t,"eventId",this.g):sn(t.a,"eventId"),this.h?He(t,"v",this.h):sn(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Ge(t,a)&&He(t,a,this.b[a]);return this.f?He(t,"eid",this.f):sn(t.a,"eid"),(a=ts(this.c)).length&&He(t,"fw",a.join(",")),t.toString()},(t=es.prototype).Ea=function(t,e,n){var r=new Rr("popup-closed-by-user"),i=new Rr("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){(function(t){var e={type:"webStorageSupport"};return rs(t).then(function(){return function(t,e){return t.fb.then(function(){return new dt(function(n){t.a.send(e.type,e,n,ar("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&Kn(t),e(i),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new dt(function(e){return function n(){Le(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return Le(n).then(function(){e(r)})})},t.Mb=function(){var t=or();return!lr(t)&&!mr(t)},t.Hb=function(){return!1},t.Cb=function(t,e,n,r,i,o,a){if(!t)return Et(new Rr("popup-blocked"));if(a&&!lr())return this.ga().s(function(e){Kn(t),i(e)}),r(),wt();this.a||(this.a=ns(is(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw Kn(t),i(e),e});return r(),e}).then(function(){Ui(n),a||qn(os(s.m,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},t.Ca=function(t,e,n){this.a||(this.a=ns(is(this)));var r=this;return this.a.then(function(){Ui(e),qn(os(r.m,r.f,r.b,t,e,Bn(),n,r.c,void 0,r.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ga=function(){var t=this;return rs(this).then(function(){return t.i.fb}).s(function(){throw t.a=null,new Rr("network-request-failed")})},t.Qb=function(){return!0},t.wa=function(t){this.g.push(t)},t.Ka=function(t){F(this.g,function(e){return e==t})},(t=as.prototype).get=function(t){return wt(this.a.getItem(t)).then(function(t){return t&&dr(t)})},t.set=function(t,e){return wt(this.a.setItem(t,fr(e)))},t.P=function(t){return wt(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var us,cs=[];function hs(t){this.a=t}function ls(t){this.c=t,this.b=!1,this.a=[]}function fs(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Et(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new dt(function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){r(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))}).then(function(e){return ps(t,c),e}).s(function(e){throw ps(t,c),e})}function ps(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),F(t.a,function(t){return t==e})}}function ds(){if(!ms())throw new Rr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=n.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.u=!1,this.h=null;var t=this;Xn()&&self?(this.l=function(){var t=Xn()?self:null;if(k(cs,function(n){n.b==t&&(e=n)}),!e){var e=new ss(t);cs.push(e)}return e}(),this.l.subscribe("keyChanged",function(e,n){return ws(t).then(function(e){return 0<e.length&&k(t.a,function(t){t(e)}),{keyProcessed:x(e,n.key)}})}),this.l.subscribe("ping",function(){return wt(["keyChanged"])})):function(){var t=n.navigator;return t&&t.serviceWorker?wt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):wt(null)}().then(function(e){(t.h=e)&&(t.g=new ls(new hs(e)),fs(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&x(e[0].value,"keyChanged")&&(t.u=!0)}).s(function(){}))})}function ys(t){return t.o||(t.o=function t(e){return new dt(function(n,r){var i=e.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}r(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){r(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?n(i):function(t){return new dt(function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}(e).then(function(){return t(e)}).then(function(t){n(t)}).s(function(t){r(t)})}})}(t)),t.o}function ms(){try{return!!n.indexedDB}catch(t){return!1}}function gs(t){return t.objectStore("firebaseLocalStorage")}function vs(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function bs(t){return new dt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function _s(t,e){return t.g&&t.h&&function(){var t=n.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?fs(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):wt()}function ws(t){return ys(t).then(function(t){var e=gs(vs(t,!1));return e.getAll?bs(e.getAll()):new dt(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(t.c,n),t.c=n}return r})}function Es(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Ts(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=wt().then(function(){if(ms()){var t=yr(),r="__sak"+t;return us||(us=new ds),(n=us).set(r,t).then(function(){return n.get(r)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){k(e.a,function(e){e(t)})}),t})}function Ss(){this.a={},this.type="inMemory"}function Cs(){if(!function(){var t="Node"==Jn();if(!(t=Is()||t&&jn.INTERNAL.node&&jn.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Jn())throw new Rr("internal-error","The LocalStorage compatibility library was not found.");throw new Rr("web-storage-unsupported")}this.a=Is()||jn.INTERNAL.node.localStorage,this.type="localStorage"}function Is(){try{var t=n.localStorage,e=yr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function As(){this.type="nullStorage"}function Ns(){if(!function(){var t="Node"==Jn();if(!(t=Ds()||t&&jn.INTERNAL.node&&jn.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Jn())throw new Rr("internal-error","The SessionStorage compatibility library was not found.");throw new Rr("web-storage-unsupported")}this.a=Ds()||jn.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Ds(){try{var t=n.sessionStorage,e=yr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}ss.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];k(r,function(e){i.push(wt().then(function(){return e(t.origin,t.data.data)}))}),St(i).then(function(r){var i=[];k(r,function(t){i.push({fulfilled:t.Db,value:t.value,reason:t.reason?t.reason.message:void 0})}),k(i,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})})}},ss.prototype.subscribe=function(t,e){rt(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},ss.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(F(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],rt(this.a)&&this.b.removeEventListener("message",this.c)},hs.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},ls.prototype.close=function(){for(;0<this.a.length;)ps(this,this.a[0]);this.b=!0},(t=ds.prototype).set=function(t,e){var n,r=!1,i=this;return ys(this).then(function(e){return bs((e=gs(vs(n=e,!0))).get(t))}).then(function(o){var a=gs(vs(n,!0));return o?(o.value=e,bs(a.put(o))):(i.b++,r=!0,(o={}).fbase_key=t,o.value=e,bs(a.add(o)))}).then(function(){return i.c[t]=e,_s(i,t)}).ia(function(){r&&i.b--})},t.get=function(t){return ys(this).then(function(e){return bs(gs(vs(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.P=function(t){var e=!1,n=this;return ys(this).then(function(r){return e=!0,n.b++,bs(gs(vs(r,!0)).delete(t))}).then(function(){return delete n.c[t],_s(n,t)}).ia(function(){e&&n.b--})},t.Y=function(t){0==this.a.length&&function(t){Es(t),function e(){t.f=setTimeout(function(){t.i=ws(t).then(function(e){0<e.length&&k(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ca=function(t){F(this.a,function(e){return e==t}),0==this.a.length&&Es(this)},(t=Ts.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.P=function(t){return this.b.then(function(e){return e.P(t)})},t.Y=function(t){this.a.push(t)},t.ca=function(t){F(this.a,function(e){return e==t})},(t=Ss.prototype).get=function(t){return wt(this.a[t])},t.set=function(t,e){return this.a[t]=e,wt()},t.P=function(t){return delete this.a[t],wt()},t.Y=function(){},t.ca=function(){},(t=Cs.prototype).get=function(t){var e=this;return wt().then(function(){return dr(e.a.getItem(t))})},t.set=function(t,e){var n=this;return wt().then(function(){var r=fr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return wt().then(function(){e.a.removeItem(t)})},t.Y=function(t){n.window&&ge(n.window,"storage",t)},t.ca=function(t){n.window&&_e(n.window,"storage",t)},(t=As.prototype).get=function(){return wt(null)},t.set=function(){return wt()},t.P=function(){return wt()},t.Y=function(){},t.ca=function(){},(t=Ns.prototype).get=function(t){var e=this;return wt().then(function(){return dr(e.a.getItem(t))})},t.set=function(t,e){var n=this;return wt().then(function(){var r=fr(e);null===r?n.P(t):n.a.setItem(t,r)})},t.P=function(t){var e=this;return wt().then(function(){e.a.removeItem(t)})},t.Y=function(){},t.ca=function(){};var Rs,Ps,ks={A:Cs,Ra:Ns},Os={A:Cs,Ra:Ns},Ls={A:as,Ra:As},xs={A:Cs,Ra:As},Ms={Zc:"local",NONE:"none",ad:"session"};function Fs(){var t=!(mr(or())||!Yn()),e=lr(),r=sr();this.o=t,this.h=e,this.l=r,this.a={},Rs||(Rs=new function(){var t={};t.Browser=ks,t.Node=Os,t.ReactNative=Ls,t.Worker=xs,this.a=t[Jn()]}),t=Rs;try{this.g=!Vn()&&wr()||!n.indexedDB?new t.a.A:new Ts(Xn()?new Ss:new t.a.A)}catch(t){this.g=new Ss,this.h=!0}try{this.i=new t.a.Ra}catch(t){this.i=new Ss}this.m=new Ss,this.f=m(this.Pb,this),this.b={}}function Us(){return Ps||(Ps=new Fs),Ps}function Vs(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g}}function Bs(t,e){return"firebase:"+t.name+(e?":"+e:"")}function qs(t,e,n){return n=Bs(e,n),"local"==e.A&&(t.b[n]=null),Vs(t,e.A).P(n)}function js(t){t.c&&(clearInterval(t.c),t.c=null)}(t=Fs.prototype).get=function(t,e){return Vs(this,t.A).get(Bs(t,e))},t.set=function(t,e,n){var r=Bs(t,n),i=this,o=Vs(this,t.A);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.A&&(i.b[r]=e)})},t.addListener=function(t,e,r){t=Bs(t,e),this.l&&(this.b[t]=n.localStorage.getItem(t)),rt(this.a)&&(Vs(this,"local").Y(this.f),this.h||(Vn()||!wr())&&n.indexedDB||!this.l||function(t){js(t),t.c=setInterval(function(){for(var e in t.a){var r=n.localStorage.getItem(e),i=t.b[e];r!=i&&(t.b[e]=r,r=new se({type:"storage",key:e,target:window,oldValue:i,newValue:r,a:!0}),t.Pb(r))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(r)},t.removeListener=function(t,e,n){t=Bs(t,e),this.a[t]&&(F(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),rt(this.a)&&(Vs(this,"local").ca(this.f),js(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var r in this.a){var i=this.b[r];void 0===i&&(i=null);var o=n.localStorage.getItem(r);o!==i&&(this.b[r]=o,this.Xa(r))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Vs(this,"local").ca(this.f):js(this),this.o)if(r=n.localStorage.getItem(e),(i=t.a.newValue)!==r)null!==i?n.localStorage.setItem(e,i):n.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var a=this;r=function(){void 0===t.a.a&&a.b[e]===n.localStorage.getItem(e)||(a.b[e]=n.localStorage.getItem(e),a.Xa(e))},Wt&&Jt&&10==Jt&&n.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(r,10):r()}}else k(t,m(this.Xa,this))},t.Xa=function(t){this.a[t]&&k(this.a[t],function(t){t()})};var Ws,Ks={name:"authEvent",A:"local"};function Hs(t,e){this.b=Gs,this.f=n.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=n.Int32Array?new Int32Array(64):Array(64),void 0!==Ws||(Ws=n.Int32Array?new Int32Array(Zs):Zs),this.reset()}b(Hs,function(){this.b=-1});for(var Gs=64,$s=Gs-1,Qs=[],zs=0;zs<$s;zs++)Qs[zs]=0;var Ys=U(128,Qs);function Xs(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Ws[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Js(t,e,n){void 0===n&&(n=e.length);var i=0,o=t.c;if(r(e))for(;i<n;)t.f[o++]=e.charCodeAt(i++),o==t.b&&(Xs(t),o=0);else{if(!c(e))throw Error("message must be string or array");for(;i<n;){var a=e[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[o++]=a,o==t.b&&(Xs(t),o=0)}}t.c=o,t.g+=n}Hs.prototype.reset=function(){this.g=this.c=0,this.a=n.Int32Array?new Int32Array(this.h):V(this.h)};var Zs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function tu(){Hs.call(this,8,eu)}b(tu,Hs);var eu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function nu(t,e,n,r,i){this.m=t,this.i=e,this.l=n,this.o=r||null,this.u=i||null,this.h=e+":"+n,this.v=new function(){this.a=Us()},this.g=new function(t){this.a=t,this.b=Us()}(this.h),this.f=null,this.b=[],this.a=this.c=null}function ru(t){return new Rr("invalid-cordova-configuration",t)}function iu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function ou(t){return t.f||(t.f=t.ga().then(function(){return new dt(function(e){t.wa(function n(r){return e(r),t.Ka(n),!1}),function(t){function e(e){i=!0,o&&o.cancel(),au(t).then(function(n){var i=r;if(n&&e&&e.url){var o=null;-1!=(i=fi(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=dr(Ge(o=$e(i),"firebaseError")||null))?Pr(o):null)?new Vi(n.b,n.c,null,null,o):new Vi(n.b,n.c,i,n.g)),i=o||r}iu(t,i)})}var r=new Vi("unknown",null,null,null,new Rr("no-auth-event")),i=!1,o=Le(500).then(function(){return au(t).then(function(){i||iu(t,r)})}),a=n.handleOpenURL;n.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(ar("BuildInfo.packageName",n).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(t){console.error(t)}},Wi||(Wi=new qi),Wi.subscribe(e)}(t)})})),t.f}function au(t){var e=null;return function(t){return t.b.get(Ks,t.a).then(function(t){return Bi(t)})}(t.g).then(function(n){return e=n,qs((n=t.g).b,Ks,n.a)}).then(function(){return e})}(t=nu.prototype).ga=function(){return this.za?this.za:this.za=(zn(void 0)?Qn().then(function(){return new dt(function(t,e){var r=n.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);r.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Et(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof ar("universalLinks.subscribe",n))throw ru("cordova-universal-links-plugin-fix is not installed");if(void 0===ar("BuildInfo.packageName",n))throw ru("cordova-plugin-buildinfo is not installed");if("function"!=typeof ar("cordova.plugins.browsertab.openUrl",n))throw ru("cordova-plugin-browsertab is not installed");if("function"!=typeof ar("cordova.InAppBrowser.open",n))throw ru("cordova-plugin-inappbrowser is not installed")},function(){throw new Rr("cordova-not-ready")})},t.Ea=function(t,e){return e(new Rr("operation-not-supported-in-this-environment")),wt()},t.Cb=function(){return Et(new Rr("operation-not-supported-in-this-environment"))},t.Qb=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,r){if(this.c)return Et(new Rr("redirect-operation-pending"));var i=this,o=n.document,a=null,s=null,u=null,c=null;return this.c=wt().then(function(){return Ui(e),ou(i)}).then(function(){return function(t,e,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Vi(e,i,null,o,new Rr("no-auth-event")),s=ar("BuildInfo.packageName",n);if("string"!=typeof s)throw new Rr("invalid-cordova-configuration");var u=ar("BuildInfo.displayName",n),c={};if(or().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!or().toLowerCase().match(/android/))return Et(new Rr("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=function(t){var e=new tu;Js(e,t),t=[];var n=8*e.g;56>e.c?Js(e,Ys,56-e.c):Js(e,Ys,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Xs(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return O(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}(o),c.sessionId=o;var h=os(t.m,t.i,t.l,e,r,null,i,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(Ks,a.C(),e)}).then(function(){var e=ar("cordova.plugins.browsertab.isAvailable",n);if("function"!=typeof e)throw new Rr("invalid-cordova-configuration");var r=null;e(function(e){if(e){if("function"!=typeof(r=ar("cordova.plugins.browsertab.openUrl",n)))throw new Rr("invalid-cordova-configuration");r(h)}else{if("function"!=typeof(r=ar("cordova.InAppBrowser.open",n)))throw new Rr("invalid-cordova-configuration");e=!(!(e=or()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=r(h,e?"_blank":"_system","location=yes")}})})}(i,t,e,r)}).then(function(){return new dt(function(t,e){s=function(){var e=ar("cordova.plugins.browsertab.close",n);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.wa(s),u=function(){a||(a=Le(2e3).then(function(){e(new Rr("redirect-cancelled-by-user"))}))},c=function(){br()&&u()},o.addEventListener("resume",u,!1),or().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).s(function(t){return au(i).then(function(){throw t})})}).ia(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&i.Ka(s),i.c=null})},t.wa=function(t){this.b.push(t),ou(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Vi("unknown",null,null,null,new Rr("no-auth-event")),t(e))})},t.Ka=function(t){F(this.b,function(e){return e==t})};var su={name:"pendingRedirect",A:"session"};function uu(t){return qs(t.b,su,t.a)}function cu(t,e,n){this.u=t,this.l=e,this.m=n,this.h=[],this.f=!1,this.i=m(this.bb,this),this.b=new bu,this.o=new Tu,this.g=new function(t){this.a=t,this.b=Us()}(this.l+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.o,this.c.linkViaPopup=this.o,this.c.reauthViaPopup=this.o,this.a=hu(this.u,this.l,this.m,Yr)}function hu(t,e,n,r){var i=jn.SDK_VERSION||null;return zn()?new nu(t,e,n,i,r):new es(t,e,n,i,r)}function lu(t){t.f||(t.f=!0,t.a.wa(t.i));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function fu(t){t.a.Mb()&&lu(t).s(function(e){var n=new Vi("unknown",null,null,null,new Rr("operation-not-supported-in-this-environment"));mu(e)&&t.bb(n)}),t.a.Hb()||_u(t.b)}(t=cu.prototype).reset=function(){this.f=!1,this.a.Ka(this.i),this.a=hu(this.u,this.l,this.m)},t.Ya=function(){this.b.Ya()},t.subscribe=function(t){if(x(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(su,t.a).then(function(t){return"pending"==t})})(this.g).then(function(t){t?uu(e.g).then(function(){lu(e).s(function(t){var n=new Vi("unknown",null,null,null,new Rr("operation-not-supported-in-this-environment"));mu(t)&&e.bb(n)})}):fu(e)}).s(function(){fu(e)})}},t.unsubscribe=function(t){F(this.h,function(e){return e==t})},t.bb=function(t){if(!t)throw new Rr("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.vb(t.b,t.c)){(e=this.c[t.b])&&e.h(t,r),e=!0;break}}return _u(this.b),e};var pu=new vr(2e3,1e4),du=new vr(3e4,6e4);function yu(t,e,n,r,i,o){return t.a.Cb(e,n,r,function(){t.f||(t.f=!0,t.a.wa(t.i))},function(){t.reset()},i,o)}function mu(t){return!(!t||"auth/cordova-not-ready"!=t.code)}cu.prototype.fa=function(){return this.b.fa()},cu.prototype.Ca=function(t,e,n){var r,i=this;return function(t){return t.b.set(su,"pending",t.a)}(this.g).then(function(){return i.a.Ca(t,e,n).s(function(t){if(mu(t))throw new Rr("operation-not-supported-in-this-environment");return r=t,uu(i.g).then(function(){throw r})}).then(function(){return i.a.Qb()?new dt(function(){}):uu(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},cu.prototype.Ea=function(t,e,n,r){return this.a.Ea(n,function(n){t.ha(e,null,n,r)},pu.get())};var gu={};function vu(t,e,n){var r=e+":"+n;return gu[r]||(gu[r]=new cu(t,e,n)),gu[r]}function bu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function _u(t){t.g||(t.g=!0,Eu(t,!1,null,null))}function wu(t,e){if(t.b=function(){return wt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Eu(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Et(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):wu(t,n):wu(t,{user:null}),t.f=[],t.c=[]}function Tu(){}function Su(){this.sb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.sb},set:function(t){this.sb=t},enumerable:!1})}function Cu(t,e){this.a=e,Ir(this,"verificationId",t)}function Iu(t,e,n,r){return new xi(t).Ua(e,n).then(function(t){return new Cu(t,r)})}function Au(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Nu(t){this.f=t,this.b=this.a=null,this.c=0}function Du(t,e){var n=e[zo],r=e.refreshToken;e=Ru(e.expiresIn),t.b=n,t.c=e,t.a=r}function Ru(t){return v()+1e3*parseInt(t,10)}function Pu(t,e){this.a=t||null,this.b=e||null,Ar(this,{lastSignInTime:_r(e||null),creationTime:_r(t||null)})}function ku(t,e){for(var n in ae.call(this,t),e)this[n]=e[n]}function Ou(t,e,n){this.G=[],this.m=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=jn.SDK_VERSION?ir(jn.SDK_VERSION):null,this.b=new $o(this.m,Jr(Yr),t),this.h=new Nu(this.b),Bu(this,e[zo]),Du(this.h,e),Ir(this,"refreshToken",this.h.a),Wu(this,n||{}),De.call(this),this.I=!1,this.u&&ur()&&(this.a=vu(this.u,this.m,this.o)),this.N=[],this.i=null,this.w=function(t){return new Au(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-v()-3e5;return 0<e?e:0})}(this),this.V=m(this.Ha,this);var r=this;this.ka=null,this.ta=function(t){r.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){xu(r,t.c)},this.W=null}function Lu(t,e){t.X&&_e(t.X,"languageCodeChanged",t.ta),(t.X=e)&&ge(e,"languageCodeChanged",t.ta)}function xu(t,e){t.O=e,ea(t.b,jn.SDK_VERSION?ir(jn.SDK_VERSION,t.O):null)}function Mu(t,e){t.W&&_e(t.W,"frameworkChanged",t.sa),(t.W=e)&&ge(e,"frameworkChanged",t.sa)}function Fu(t){try{return jn.app(t.o).auth()}catch(e){throw new Rr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function Uu(t){t.D||t.w.b||(t.w.start(),_e(t,"tokenChanged",t.V),ge(t,"tokenChanged",t.V))}function Vu(t){_e(t,"tokenChanged",t.V),t.w.stop()}function Bu(t,e){t.ra=e,Ir(t,"_lat",e)}function qu(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return St(e).then(function(){return t})}function ju(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function Wu(t,e){Ar(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new Pu(e.createdAt,e.lastLoginAt),providerData:[]})}function Ku(){}function Hu(t){return wt().then(function(){if(t.D)throw new Rr("app-deleted")})}function Gu(t){return O(t.providerData,function(t){return t.providerId})}function $u(t,e){e&&(Qu(t,e.providerId),t.providerData.push(e))}function Qu(t,e){F(t.providerData,function(t){return t.providerId==e})}function zu(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Ir(t,e,n)}function Yu(t,e){t!=e&&(Ar(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Ir(t,"metadata",function(t){return new Pu(t.a,t.b)}(e.metadata)):Ir(t,"metadata",new Pu),k(e.providerData,function(e){$u(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Ir(t,"refreshToken",t.h.a))}function Xu(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return Ka(t.b,Ca,{idToken:e}).then(m(t.xc,t))}(t,e).then(function(){return n||zu(t,"isAnonymous",!1),e})})}function Ju(t,e){e[zo]&&t.ra!=e[zo]&&(Du(t.h,e),t.dispatchEvent(new ku("tokenChanged")),Bu(t,e[zo]),zu(t,"refreshToken",t.h.a))}function Zu(t,e){return Xu(t).then(function(){if(x(Gu(t),e))return qu(t).then(function(){throw new Rr("provider-already-linked")})})}function tc(t,e,n){return Nr({user:t,credential:Fi(e),additionalUserInfo:e=ri(e),operationType:n})}function ec(t,e){return Ju(t,e),t.reload().then(function(){return t})}function nc(t,e,n,r,i){if(!ur())return Et(new Rr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Et(t.i);var o=ni(n.providerId),a=yr(t.uid+":::"),s=null;(!lr()||Yn())&&t.u&&n.isOAuthProvider&&(s=os(t.u,t.m,t.o,e,n,null,a,jn.SDK_VERSION||null));var u=Hn(s,o&&o.Ba,o&&o.Aa);return r=r().then(function(){if(ic(t),!i)return t.F().then(function(){})}).then(function(){return yu(t.a,u,e,n,a,!!s)}).then(function(){return new dt(function(n,r){t.ha(e,null,new Rr("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.c=t.a.Ea(t,e,u,a)})}).then(function(t){return u&&Kn(u),t?Nr(t):null}).s(function(t){throw u&&Kn(u),t}),oc(t,r,i)}function rc(t,e,n,r,i){if(!ur())return Et(new Rr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Et(t.i);var o=null,a=yr(t.uid+":::");return r=r().then(function(){if(ic(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,qu(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(sc,t.C(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return uc(t.ba);throw o}).then(function(){if(o)throw o}),oc(t,r,i)}function ic(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Rr("internal-error");throw new Rr("auth-domain-config-required")}}function oc(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),Et(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new ku("userInvalidated")),t.i=e),e})}(t,e,n);return t.G.push(r),r.ia(function(){M(t.G,r)}),r}function ac(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[zo]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-v())/1e3;var r=new Ou(e,n,t);return t.providerData&&k(t.providerData,function(t){t&&$u(r,Nr(t))}),t.redirectEventId&&(r.aa=t.redirectEventId),r}bu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},bu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Eu(this,!0,null,t.a),wt()):e.xa(n,r)?function(t,e,n){n=n.xa(e.b,e.c);var r=e.f,i=e.g,o=e.h,a=!!e.b.match(/Redirect$/);n(r,i,o).then(function(e){Eu(t,a,e,null)}).s(function(e){Eu(t,a,null,e)})}(this,t,e):Et(new Rr("invalid-auth-event")):(Eu(this,!1,null,null),wt())}else Et(new Rr("invalid-auth-event"))},bu.prototype.Ya=function(){this.g&&!this.i&&Eu(this,!1,null,null)},bu.prototype.fa=function(){var t=this;return new dt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Rr("timeout");t.a&&t.a.cancel(),t.a=Le(du.get()).then(function(){t.b||(t.g=!0,Eu(t,!0,null,e))})}(t))})},Tu.prototype.h=function(t,e){if(t){var n=t.b,r=t.c;t.a?(e.ha(t.b,null,t.a,t.c),wt()):e.xa(n,r)?function(t,e){var n=t.c,r=t.b;e.xa(r,n)(t.f,t.g,t.h).then(function(t){e.ha(r,t,null,n)}).s(function(t){e.ha(r,null,t,n)})}(t,e):Et(new Rr("invalid-auth-event"))}else Et(new Rr("invalid-auth-event"))},Cu.prototype.confirm=function(t){return t=Mi(this.verificationId,t),this.a(t)},Au.prototype.start=function(){this.a=this.c,function t(e,r){e.stop(),e.b=Le(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,r)).then(function(){return t=n.document,e=null,br()||!t?wt():new dt(function(n){e=function(){br()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},Au.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Nu.prototype.C=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Nu.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Et(new Rr("user-token-expired")):t||!this.b||v()>this.c-3e4?this.a?function(t,e){return function(t,e){return new dt(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?na(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(Ga(t)):t.access_token&&t.refresh_token?n(t):r(new Rr("internal-error")):r(new Rr("network-request-failed"))},"POST",an(e).toString(),t.f,t.l.get()):r(new Rr("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=Ru(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}(this,{grant_type:"refresh_token",refresh_token:this.a}):wt(null):wt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Pu.prototype.C=function(){return{lastLoginAt:this.b,createdAt:this.a}},b(ku,ae),b(Ou,De),Ou.prototype.pa=function(t){this.ka=t,ta(this.b,t)},Ou.prototype.ea=function(){return this.ka},Ou.prototype.ya=function(){return V(this.O)},Ou.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},Ir(Ou.prototype,"providerId","firebase"),(t=Ou.prototype).reload=function(){var t=this;return oc(this,Hu(this).then(function(){return Xu(t).then(function(){return qu(t)}).then(Ku)}))},t.dc=function(t){return this.F(t).then(function(t){return new function(t){var e=zr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Rr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ar(this,{token:t,expirationTime:_r(1e3*e.exp),authTime:_r(1e3*e.auth_time),issuedAtTime:_r(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}(t)})},t.F=function(t){var e=this;return oc(this,Hu(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Rr("internal-error");return t.accessToken!=e.ra&&(Bu(e,t.accessToken),e.dispatchEvent(new ku("tokenChanged"))),zu(e,"refreshToken",t.refreshToken),t.accessToken}))},t.xc=function(t){if(!(t=t.users)||!t.length)throw new Rr("internal-error");Wu(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?O(t,function(t){return new function(t,e,n,r,i,o){Ar(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)$u(this,e[n]);zu(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.gb=function(t){var e=this,n=null;return oc(this,t.f(this.b,this.uid).then(function(t){return Ju(e,t),n=tc(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.yc=function(t){return Sr("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.gb(t).then(function(){})},t.eb=function(t){var e=this,n=null;return oc(this,Zu(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.b,n)}).then(function(t){return n=tc(e,t,"link"),ec(e,t)}).then(function(){return n}))},t.pc=function(t){return Sr("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.eb(t).then(function(t){return t.user})},t.qc=function(t,e){var n=this;return oc(this,Zu(this,"phone").then(function(){return Iu(Fu(n),t,e,m(n.eb,n))}))},t.zc=function(t,e){var n=this;return oc(this,wt().then(function(){return Iu(Fu(n),t,e,m(n.gb,n))}),!0)},t.pb=function(t){var e=this;return oc(this,this.F().then(function(n){return e.b.pb(n,t)}).then(function(t){return Ju(e,t),e.reload()}))},t.Rc=function(t){var e=this;return oc(this,this.F().then(function(n){return t.b(e.b,n)}).then(function(t){return Ju(e,t),e.reload()}))},t.qb=function(t){var e=this;return oc(this,this.F().then(function(n){return e.b.qb(n,t)}).then(function(t){return Ju(e,t),e.reload()}))},t.rb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Hu(this);var e=this;return oc(this,this.F().then(function(n){return e.b.rb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Ju(e,t),zu(e,"displayName",t.displayName||null),zu(e,"photoURL",t.photoUrl||null),k(e.providerData,function(t){"password"===t.providerId&&(Ir(t,"displayName",e.displayName),Ir(t,"photoURL",e.photoURL))}),qu(e)}).then(Ku))},t.Pc=function(t){var e=this;return oc(this,Xu(this).then(function(n){return x(Gu(e),t)?function(t,e,n){return Ka(t,Ea,{idToken:e,deleteProvider:n})}(e.b,n,[t]).then(function(t){var n={};return k(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),k(Gu(e),function(t){n[t]||Qu(e,t)}),n[xi.PROVIDER_ID]||Ir(e,"phoneNumber",null),qu(e)}):qu(e).then(function(){throw new Rr("no-such-provider")})}))},t.delete=function(){var t=this;return oc(this,this.F().then(function(e){return Ka(t.b,wa,{idToken:e})}).then(function(){t.dispatchEvent(new ku("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");Lu(t,null),Mu(t,null),t.G=[],t.D=!0,Vu(t),Ir(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},t.vb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?m(this.Ab,this):"reauthViaPopup"==t&&e==(this.g||null)?m(this.Bb,this):"linkViaRedirect"==t&&(this.aa||null)==e?m(this.Ab,this):"reauthViaRedirect"==t&&(this.aa||null)==e?m(this.Bb,this):null},t.rc=function(t){var e=this;return nc(this,"linkViaPopup",t,function(){return Zu(e,t.providerId).then(function(){return qu(e)})},!1)},t.Ac=function(t){return nc(this,"reauthViaPopup",t,function(){return wt()},!0)},t.sc=function(t){var e=this;return rc(this,"linkViaRedirect",t,function(){return Zu(e,t.providerId)},!1)},t.Bc=function(t){return rc(this,"reauthViaRedirect",t,function(){return wt()},!0)},t.Ab=function(t,e,n){var r=this;this.c&&(this.c.cancel(),this.c=null);var i=null;return oc(this,this.F().then(function(i){return da(r.b,{requestUri:t,postBody:n,sessionId:e,idToken:i})}).then(function(t){return i=tc(r,t,"link"),ec(r,t)}).then(function(){return i}))},t.Bb=function(t,e,n){var r=this;this.c&&(this.c.cancel(),this.c=null);var i=null;return oc(this,wt().then(function(){return pi(ya(r.b,{requestUri:t,sessionId:e,postBody:n}),r.uid)}).then(function(t){return i=tc(r,t,"reauthenticate"),Ju(r,t),r.i=null,r.reload()}).then(function(){return i}),!0)},t.jb=function(t){var e=this,n=null;return oc(this,this.F().then(function(e){return n=e,void 0===t||rt(t)?{}:Kr(new Lr(t))}).then(function(t){return e.b.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.C()},t.C=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.u,stsTokenManager:this.h.C(),redirectEventId:this.aa||null};return this.metadata&&ut(t,this.metadata.C()),k(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var sc={name:"redirectUser",A:"session"};function uc(t){return qs(t.b,sc,t.a)}function cc(t){this.a=t,this.b=Us(),this.c=null,this.f=function(t){var e=fc("local"),r=fc("session"),i=fc("none");return function(t,e,r){var i=Bs(e,r),o=Vs(t,e.A);return t.get(e,r).then(function(a){var s=null;try{s=dr(n.localStorage.getItem(i))}catch(t){}if(s&&!a)return n.localStorage.removeItem(i),t.set(e,s,r);s&&a&&"localStorage"!=o.type&&n.localStorage.removeItem(i)})}(t.b,e,t.a).then(function(){return t.b.get(r,t.a)}).then(function(n){return n?r:t.b.get(i,t.a).then(function(n){return n?i:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(lc,t.a).then(function(t){return t?fc(t):e})})})}).then(function(e){return t.c=e,hc(t,e.A)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(fc("local"),this.a,m(this.g,this))}function hc(t,e){var n,r=[];for(n in Ms)Ms[n]!==e&&r.push(qs(t.b,fc(Ms[n]),t.a));return r.push(qs(t.b,lc,t.a)),function(t){return new dt(function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Tt(t[s],g(o,s),a);else e(i)})}(r)}cc.prototype.g=function(){var t=this,e=fc("local");mc(this,function(){return wt().then(function(){return t.c&&"local"!=t.c.A?t.b.get(e,t.a):null}).then(function(n){if(n)return hc(t,"local").then(function(){t.c=e})})})};var lc={name:"persistence",A:"session"};function fc(t){return{name:"authUser",A:t}}function pc(t,e){return mc(t,function(){return t.b.set(t.c,e.C(),t.a)})}function dc(t){return mc(t,function(){return qs(t.b,t.c,t.a)})}function yc(t,e){return mc(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),ac(t||{})})})}function mc(t,e){return t.f=t.f.then(e,e),t.f}function gc(t){if(this.m=!1,Ir(this,"settings",new Su),Ir(this,"app",t),!Sc(this).options||!Sc(this).options.apiKey)throw new Rr("invalid-api-key");t=jn.SDK_VERSION?ir(jn.SDK_VERSION):null,this.b=new $o(Sc(this).options&&Sc(this).options.apiKey,Jr(Yr),t),this.N=[],this.o=[],this.I=[],this.Tb=jn.INTERNAL.createSubscribe(m(this.mc,this)),this.O=void 0,this.Ub=jn.INTERNAL.createSubscribe(m(this.nc,this)),Ec(this,null),this.h=new cc(Sc(this).options.apiKey+":"+Sc(this).name),this.w=new function(t){this.a=t,this.b=Us()}(Sc(this).options.apiKey+":"+Sc(this).name),this.V=Nc(this,function(t){var e=Sc(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(sc,t.a).then(function(t){return t&&e&&(t.authDomain=e),ac(t||{})})}(t.w,Sc(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ba=t.w),uc(t.w)});return Nc(t,e)}(t).then(function(){return yc(t.h,e)}).then(function(e){return e?(e.ba=t.w,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then(function(){return pc(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:dc(t.h)})):null}).then(function(e){Ec(t,e||null)});return Nc(t,n)}(this)),this.i=Nc(this,function(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.m)return t.ka()}).s(function(){}).then(function(){if(!t.m){t.X=!0;var e=t.h;e.b.addListener(fc("local"),e.a,t.ka)}})}(this)),this.X=!1,this.ka=m(this.Mc,this),this.Ha=m(this.Z,this),this.ra=m(this.bc,this),this.sa=m(this.jc,this),this.ta=m(this.kc,this),function(t){var e=Sc(t).options.authDomain,n=Sc(t).options.apiKey;e&&ur()&&(t.Sb=t.V.then(function(){if(!t.m){if(t.a=vu(e,n,Sc(t).name),t.a.subscribe(t),Cc(t)&&ju(Cc(t)),t.D){ju(t.D);var r=t.D;r.pa(t.ea()),Lu(r,t),xu(r=t.D,t.G),Mu(r,t),t.D=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=m(this.delete,this),this.INTERNAL.logFramework=m(this.tc,this),this.u=0,De.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}(this),this.G=[]}function vc(t){ae.call(this,"languageCodeChanged"),this.g=t}function bc(t){ae.call(this,"frameworkChanged"),this.c=t}function _c(t){return t.Sb||Et(new Rr("auth-domain-config-required"))}function wc(t,e){var n={};return n.apiKey=Sc(t).options.apiKey,n.authDomain=Sc(t).options.authDomain,n.appName=Sc(t).name,t.V.then(function(){return function(t,e,n,r){var i=new Ou(t,e);return n&&(i.ba=n),r&&xu(i,r),i.reload().then(function(){return i})}(n,e,t.w,t.ya())}).then(function(e){return Cc(t)&&e.uid==Cc(t).uid?(Yu(Cc(t),e),t.Z(e)):(Ec(t,e),ju(e),t.Z(e))}).then(function(){Ac(t)})}function Ec(t,e){Cc(t)&&(function(t,e){F(t.N,function(t){return t==e})}(Cc(t),t.Ha),_e(Cc(t),"tokenChanged",t.ra),_e(Cc(t),"userDeleted",t.sa),_e(Cc(t),"userInvalidated",t.ta),Vu(Cc(t))),e&&(e.N.push(t.Ha),ge(e,"tokenChanged",t.ra),ge(e,"userDeleted",t.sa),ge(e,"userInvalidated",t.ta),0<t.u&&Uu(e)),Ir(t,"currentUser",e),e&&(e.pa(t.ea()),Lu(e,t),xu(e,t.G),Mu(e,t))}function Tc(t,e){var n=null,r=null;return Nc(t,e.then(function(e){return n=Fi(e),r=ri(e),wc(t,e)}).then(function(){return Nr({user:Cc(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Sc(t){return t.app}function Cc(t){return t.currentUser}function Ic(t){return Cc(t)&&Cc(t)._lat||null}function Ac(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](Ic(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](Ic(t))}}function Nc(t,e){return t.N.push(e),e.ia(function(){M(t.N,e)}),e}function Dc(){}function Rc(){this.a={},this.b=1e12}cc.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new Rr("invalid-persistence-type"),n=new Rr("unsupported-persistence-type");t:{for(r in Ms)if(Ms[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Jn()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!sr()&&"none"!==t)throw n}}(t),mc(this,function(){return t!=n.c.A?n.b.get(n.c,n.a).then(function(r){return e=r,hc(n,t)}).then(function(){if(n.c=fc(t),e)return n.b.set(n.c,e,n.a)}):wt()})},b(gc,De),b(vc,ae),b(bc,ae),(t=gc.prototype).mb=function(t){return Nc(this,t=this.h.mb(t))},t.pa=function(t){this.W===t||this.m||(this.W=t,ta(this.b,this.W),this.dispatchEvent(new vc(this.ea())))},t.ea=function(){return this.W},t.Sc=function(){var t=n.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.tc=function(t){this.G.push(t),ea(this.b,jn.SDK_VERSION?ir(jn.SDK_VERSION,this.G):null),this.dispatchEvent(new bc(this.G))},t.ya=function(){return V(this.G)},t.toJSON=function(){return{apiKey:Sc(this).options.apiKey,authDomain:Sc(this).options.authDomain,appName:Sc(this).name,currentUser:Cc(this)&&Cc(this).C()}},t.vb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ha=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?m(this.ac,this):null},t.ac=function(t,e,n){var r=this;t={requestUri:t,postBody:n,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var i=null,o=null,a=pa(r.b,t).then(function(t){return i=Fi(t),o=ri(t),t});return Nc(this,t=r.V.then(function(){return a}).then(function(t){return wc(r,t)}).then(function(){return Nr({user:Cc(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}))},t.Kc=function(t){if(!ur())return Et(new Rr("operation-not-supported-in-this-environment"));var e=this,n=ni(t.providerId),r=yr(),i=null;(!lr()||Yn())&&Sc(this).options.authDomain&&t.isOAuthProvider&&(i=os(Sc(this).options.authDomain,Sc(this).options.apiKey,Sc(this).name,"signInViaPopup",t,null,r,jn.SDK_VERSION||null));var o=Hn(i,n&&n.Ba,n&&n.Aa);return Nc(this,n=_c(this).then(function(e){return yu(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new dt(function(t,n){e.ha("signInViaPopup",null,new Rr("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.c=e.a.Ea(e,"signInViaPopup",o,r)})}).then(function(t){return o&&Kn(o),t?Nr(t):null}).s(function(t){throw o&&Kn(o),t}))},t.Lc=function(t){if(!ur())return Et(new Rr("operation-not-supported-in-this-environment"));var e=this;return Nc(this,_c(this).then(function(){return mc(t=e.h,function(){return t.b.set(lc,t.c.A,t.a)});var t}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},t.fa=function(){if(!ur())return Et(new Rr("operation-not-supported-in-this-environment"));var t=this;return Nc(this,_c(this).then(function(){return t.a.fa()}).then(function(t){return t?Nr(t):null}))},t.Qc=function(t){if(!t)return Et(new Rr("null-user"));var e=this,n={};n.apiKey=Sc(this).options.apiKey,n.authDomain=Sc(this).options.authDomain,n.appName=Sc(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.m,authDomain:t.u,appName:t.o};var i=t.h,o={};return o[zo]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-v())/1e3,e=new Ou(e,o),n&&(e.ba=n),r&&xu(e,r),Yu(e,t),e}(t,n,e.w,e.ya());return Nc(this,this.i.then(function(){if(Sc(e).options.apiKey!=t.m)return r.reload()}).then(function(){return Cc(e)&&t.uid==Cc(e).uid?(Yu(Cc(e),t),e.Z(t)):(Ec(e,r),ju(r),e.Z(r))}).then(function(){Ac(e)}))},t.nb=function(){var t=this;return Nc(this,this.i.then(function(){return Cc(t)?(Ec(t,null),dc(t.h).then(function(){Ac(t)})):wt()}))},t.Mc=function(){var t=this;return yc(this.h,Sc(this).options.authDomain).then(function(e){if(!t.m){var n;if(n=Cc(t)&&e){n=Cc(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Yu(Cc(t),e),Cc(t).F();(Cc(t)||e)&&(Ec(t,e),e&&(ju(e),e.ba=t.w),t.a&&t.a.subscribe(t),Ac(t))}})},t.Z=function(t){return pc(this.h,t)},t.bc=function(){Ac(this),this.Z(Cc(this))},t.jc=function(){this.nb()},t.kc=function(){this.nb()},t.mc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Cc(e))})},t.nc=function(t){var e=this;!function(t,e){t.I.push(e),Nc(t,t.i.then(function(){!t.m&&x(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(Ic(t)))}))}(this,function(){t.next(Cc(e))})},t.vc=function(t,e,n){var r=this;return this.X&&jn.Promise.resolve().then(function(){h(t)?t(Cc(r)):h(t.next)&&t.next(Cc(r))}),this.Tb(t,e,n)},t.uc=function(t,e,n){var r=this;return this.X&&jn.Promise.resolve().then(function(){r.O=r.getUid(),h(t)?t(Cc(r)):h(t.next)&&t.next(Cc(r))}),this.Ub(t,e,n)},t.cc=function(t){var e=this;return Nc(this,this.i.then(function(){return Cc(e)?Cc(e).F(t).then(function(t){return{accessToken:t}}):null}))},t.Nb=function(t){var e=this;return this.i.then(function(){return Tc(e,Ka(e.b,Va,{token:t}))}).then(function(t){var n=t.user;return zu(n,"isAnonymous",!1),e.Z(n),t})},t.Ec=function(t){return Sr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Nb(t)},t.Fc=function(t,e){return Sr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Ob(t,e)},t.Ob=function(t,e){var n=this;return this.i.then(function(){return Tc(n,Ka(n.b,Ba,{email:t,password:e}))})},t.xb=function(t,e){var n=this;return this.i.then(function(){return Tc(n,Ka(n.b,ba,{email:t,password:e}))})},t.Wb=function(t,e){return Sr("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.xb(t,e)},t.Hc=function(t){return Sr("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Pa(t).then(function(t){return t.user})},t.Pa=function(t){var e=this;return this.i.then(function(){return Tc(e,t.la(e.b))})},t.Qa=function(){var t=this;return this.i.then(function(){var e=Cc(t);return e&&e.isAnonymous?Nr({user:e,credential:null,additionalUserInfo:Nr({providerId:null,isNewUser:!1}),operationType:"signIn"}):Tc(t,t.b.Qa()).then(function(e){var n=e.user;return zu(n,"isAnonymous",!0),t.Z(n),e})})},t.Gc=function(){return Sr("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Qa()},t.getUid=function(){return Cc(this)&&Cc(this).uid||null},t.Vb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&Cc(this)&&Uu(Cc(this))},t.Cc=function(t){var e=this;k(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&Cc(this)&&Vu(Cc(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.o.push(t),Nc(this,this.i.then(function(){e.m||x(e.o,t)&&t(Ic(e))}))},t.removeAuthTokenListener=function(t){F(this.o,function(e){return e==t})},t.delete=function(){this.m=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(fc("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Ya()),jn.Promise.resolve()},t.Zb=function(t){return Sr("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),Nc(this,function(t,e){return Ka(t,_a,{identifier:e,continueUri:cr()?Bn():"http://localhost"}).then(function(t){return t.allProviders||[]})}(this.b,t))},t.$b=function(t){return Nc(this,function(t,e){return Ka(t,_a,{identifier:e,continueUri:cr()?Bn():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},t.oc=function(t){return!!ki(t)},t.lb=function(t,e){var n=this;return Nc(this,wt().then(function(){var t=new Lr(e);if(!t.c)throw new Rr("argument-error",Fr+" must be true when sending sign in link to email");return Kr(t)}).then(function(e){return n.b.lb(t,e)}).then(function(){}))},t.Tc=function(t){return this.Ja(t).then(function(t){return t.data.email})},t.Za=function(t,e){return Nc(this,this.b.Za(t,e).then(function(){}))},t.Ja=function(t){return Nc(this,this.b.Ja(t).then(function(t){return new function(t){var e={},n=t.email,r=t.newEmail;if(!(t=t.requestType)||"EMAIL_SIGNIN"!=t&&!n)throw Error("Invalid provider user info!");e.fromEmail=r||null,e.email=n||null,Ir(this,"operation",t),Ir(this,"data",Dr(e))}(t)}))},t.Wa=function(t){return Nc(this,this.b.Wa(t).then(function(){}))},t.kb=function(t,e){var n=this;return Nc(this,wt().then(function(){return void 0===e||rt(e)?{}:Kr(new Lr(e))}).then(function(e){return n.b.kb(t,e)}).then(function(){}))},t.Jc=function(t,e){return Nc(this,Iu(this,t,e,m(this.Pa,this)))},t.Ic=function(t,e){var n=this;return Nc(this,wt().then(function(){var r=Pi(t,e||Bn());return n.Pa(r)}))},Dc.prototype.render=function(){},Dc.prototype.reset=function(){},Dc.prototype.getResponse=function(){},Dc.prototype.execute=function(){};var Pc=null;function kc(t,e){return(e=Oc(e))&&t.a[e]||null}function Oc(t){return(t=void 0===t?1e12:t)?t.toString():null}function Lc(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Pn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ge(this.f,"click",this.i)}function xc(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Mc(){}Rc.prototype.render=function(t,e){return this.a[this.b.toString()]=new Lc(t,e),this.b++},Rc.prototype.reset=function(t){var e=kc(this,t);t=Oc(t),e&&t&&(e.delete(),delete this.a[t])},Rc.prototype.getResponse=function(t){return(t=kc(this,t))?t.getResponse():null},Rc.prototype.execute=function(t){(t=kc(this,t))&&t.execute()},Lc.prototype.getResponse=function(){return xc(this),this.b},Lc.prototype.execute=function(){xc(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()},6e4)},500))},Lc.prototype.delete=function(){xc(this),this.g=!0,clearTimeout(this.a),this.a=null,_e(this.f,"click",this.i)},Mc.prototype.g=function(){return Pc||(Pc=new Rc),wt(Pc)},Mc.prototype.c=function(){};var Fc=null;function Uc(){this.b=n.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Vc=yn("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Bc=new vr(3e4,6e4);Uc.prototype.g=function(t){var e=this;return new dt(function(r,i){var o=setTimeout(function(){i(new Rr("network-request-failed"))},Bc.get());!n.grecaptcha||t!==e.f&&!e.b?(n[e.a]=function(){if(n.grecaptcha){e.f=t;var a=n.grecaptcha.render;n.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(o),r(n.grecaptcha)}else clearTimeout(o),i(new Rr("internal-error"));delete n[e.a]},wt(Bo(vn(Vc,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(o),i(new Rr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(o),r(n.grecaptcha))})},Uc.prototype.c=function(){this.b--};var qc=null;function jc(t,e,r,i,o,a,s){if(Ir(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.m=e,this.g=null,s?(Fc||(Fc=new Mc),s=Fc):(qc||(qc=new Uc),s=qc),this.o=s,this.a=r||{theme:"light",type:"image"},this.h=[],this.a[Hc])throw new Rr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Gc],!n.document)throw new Rr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Pn(e)||!this.i&&Pn(e).hasChildNodes())throw new Rr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new $o(t,a||null,o||null),this.v=i||function(){return null};var u=this;this.l=[];var c=this.a[Wc];this.a[Wc]=function(t){if($c(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=ar(c,n);"function"==typeof e&&e(t)}};var h=this.a[Kc];this.a[Kc]=function(){if($c(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=ar(h,n);"function"==typeof t&&t()}}}var Wc="callback",Kc="expired-callback",Hc="sitekey",Gc="size";function $c(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Qc(t,e){return t.h.push(e),e.ia(function(){M(t.h,e)}),e}function zc(t){if(t.D)throw new Rr("internal-error","RecaptchaVerifier instance has been destroyed.")}function Yc(t,e,n){var r=!1;try{this.b=n||jn.app()}catch(t){throw new Rr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Rr("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().ya()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=jn.SDK_VERSION?ir(jn.SDK_VERSION,o):null,jc.call(this,n,t,e,function(){try{var t=i.b.auth().ea()}catch(e){t=null}return t},o,Jr(Yr),r)}function Xc(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Rr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Jc.length)throw new Rr("internal-error","Argument validator received an unsupported number of arguments.");n=Jc[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new Rr("argument-error",t+" failed: "+r)}(t=jc.prototype).za=function(){var t=this;return this.f?this.f:this.f=Qc(this,wt().then(function(){if(cr()&&!Xn())return Qn();throw new Rr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,Ka(t.u,Ra,{})}).then(function(e){t.a[Hc]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){zc(this);var t=this;return Qc(this,this.za().then(function(){if(null===t.c){var e=t.m;if(!t.i){var n=Pn(e);e=function(t,e,n){var i=arguments,o=document,a=String(i[0]),s=i[1];if(!ln&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(' name="',j(s.name),'"'),s.type){a.push(' type="',j(s.type),'"');var h={};ut(h,s),delete h.type,s=h}a.push(">"),a=a.join("")}return a=o.createElement(a),s&&(r(s)?a.className=s:u(s)?a.className=s.join(" "):kn(a,s)),2<i.length&&function(t,e,n){function i(n){n&&e.appendChild(r(n)?t.createTextNode(n):n)}for(var o=2;o<n.length;o++){var a=n[o];!c(a)||l(a)&&0<a.nodeType?i(a):k(Ln(a)?V(a):a,i)}}(o,a,i),a}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){zc(this);var t=this;return Qc(this,this.render().then(function(e){return new dt(function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){F(t.l,function(t){return t==e})}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){zc(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){zc(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Pn(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},b(Yc,jc);var Jc="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Zc(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:r}}function th(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:i}}function eh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:l}}function nh(t,e){return{name:t||"",K:"a function",optional:!!e,M:h}}function rh(t,e){return{name:t||"",K:"null",optional:!!e,M:s}}function ih(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function oh(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&r(t.type)&&h(t.verify))}}}function ah(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function sh(t,e){for(var n in e){var r=e[n].name;t[r]=hh(r,t[n],e[n].j)}}function uh(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:g(function(t){return this[t]},n),set:g(function(t,e,n,r){Xc(t,[n],[r],!0),this[e]=r},r,n,e[n].tb),enumerable:!0})}}function ch(t,e,n,r){t[e]=hh(e,n,r)}function hh(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Xc(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}sh(gc.prototype,{Wa:{name:"applyActionCode",j:[Zc("code")]},Ja:{name:"checkActionCode",j:[Zc("code")]},Za:{name:"confirmPasswordReset",j:[Zc("code"),Zc("newPassword")]},xb:{name:"createUserWithEmailAndPassword",j:[Zc("email"),Zc("password")]},Wb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[Zc("email"),Zc("password")]},Zb:{name:"fetchProvidersForEmail",j:[Zc("email")]},$b:{name:"fetchSignInMethodsForEmail",j:[Zc("email")]},fa:{name:"getRedirectResult",j:[]},oc:{name:"isSignInWithEmailLink",j:[Zc("emailLink")]},uc:{name:"onAuthStateChanged",j:[ah(eh(),nh(),"nextOrObserver"),nh("opt_error",!0),nh("opt_completed",!0)]},vc:{name:"onIdTokenChanged",j:[ah(eh(),nh(),"nextOrObserver"),nh("opt_error",!0),nh("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[Zc("email"),ah(eh("opt_actionCodeSettings",!0),rh(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[Zc("email"),eh("actionCodeSettings")]},mb:{name:"setPersistence",j:[Zc("persistence")]},Pa:{name:"signInAndRetrieveDataWithCredential",j:[ih()]},Qa:{name:"signInAnonymously",j:[]},Gc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Hc:{name:"signInWithCredential",j:[ih()]},Nb:{name:"signInWithCustomToken",j:[Zc("token")]},Ec:{name:"signInAndRetrieveDataWithCustomToken",j:[Zc("token")]},Ob:{name:"signInWithEmailAndPassword",j:[Zc("email"),Zc("password")]},Ic:{name:"signInWithEmailLink",j:[Zc("email"),Zc("emailLink",!0)]},Fc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[Zc("email"),Zc("password")]},Jc:{name:"signInWithPhoneNumber",j:[Zc("phoneNumber"),oh()]},Kc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Qc:{name:"updateCurrentUser",j:[ah({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof Ou)}},rh(),"user")]},nb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Zc(null,!0)]},Sc:{name:"useDeviceLanguage",j:[]},Tc:{name:"verifyPasswordResetCode",j:[Zc("code")]}}),uh(gc.prototype,{lc:{name:"languageCode",tb:ah(Zc(),rh(),"languageCode")}}),gc.Persistence=Ms,gc.Persistence.LOCAL="local",gc.Persistence.SESSION="session",gc.Persistence.NONE="none",sh(Ou.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[th("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[th("opt_forceRefresh",!0)]},eb:{name:"linkAndRetrieveDataWithCredential",j:[ih()]},pc:{name:"linkWithCredential",j:[ih()]},qc:{name:"linkWithPhoneNumber",j:[Zc("phoneNumber"),oh()]},rc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},sc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},gb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ih()]},yc:{name:"reauthenticateWithCredential",j:[ih()]},zc:{name:"reauthenticateWithPhoneNumber",j:[Zc("phoneNumber"),oh()]},Ac:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Bc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[ah(eh("opt_actionCodeSettings",!0),rh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Zc(null,!0)]},Pc:{name:"unlink",j:[Zc("provider")]},pb:{name:"updateEmail",j:[Zc("email")]},qb:{name:"updatePassword",j:[Zc("password")]},Rc:{name:"updatePhoneNumber",j:[ih("phone")]},rb:{name:"updateProfile",j:[eh("profile")]}}),sh(Rc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),sh(Dc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),sh(dt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),uh(Su.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",tb:th("appVerificationDisabledForTesting")}}),sh(Cu.prototype,{confirm:{name:"confirm",j:[Zc("verificationCode")]}}),ch(Ri,"credential",function(t,e){return new Di(t,e)},[Zc("email"),Zc("password")]),sh(wi.prototype,{ua:{name:"addScope",j:[Zc("scope")]},Da:{name:"setCustomParameters",j:[eh("customOAuthParameters")]}}),ch(wi,"credential",Ei,[ah(Zc(),eh(),"token")]),ch(Ri,"credentialWithLink",Pi,[Zc("email"),Zc("emailLink")]),sh(Ti.prototype,{ua:{name:"addScope",j:[Zc("scope")]},Da:{name:"setCustomParameters",j:[eh("customOAuthParameters")]}}),ch(Ti,"credential",Si,[ah(Zc(),eh(),"token")]),sh(Ci.prototype,{ua:{name:"addScope",j:[Zc("scope")]},Da:{name:"setCustomParameters",j:[eh("customOAuthParameters")]}}),ch(Ci,"credential",Ii,[ah(Zc(),ah(eh(),rh()),"idToken"),ah(Zc(),rh(),"accessToken",!0)]),sh(Ai.prototype,{Da:{name:"setCustomParameters",j:[eh("customOAuthParameters")]}}),ch(Ai,"credential",Ni,[ah(Zc(),eh(),"token"),Zc("secret",!0)]),sh(_i.prototype,{ua:{name:"addScope",j:[Zc("scope")]},credential:{name:"credential",j:[ah(Zc(),rh(),"idToken",!0),ah(Zc(),rh(),"accessToken",!0),ah(Zc(),rh(),"nonce",!0)]},Da:{name:"setCustomParameters",j:[eh("customOAuthParameters")]}}),ch(xi,"credential",Mi,[Zc("verificationId"),Zc("verificationCode")]),sh(xi.prototype,{Ua:{name:"verifyPhoneNumber",j:[Zc("phoneNumber"),oh()]}}),sh(Rr.prototype,{toJSON:{name:"toJSON",j:[Zc(null,!0)]}}),sh(Hi.prototype,{toJSON:{name:"toJSON",j:[Zc(null,!0)]}}),sh(Ki.prototype,{toJSON:{name:"toJSON",j:[Zc(null,!0)]}}),sh(Yc.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===jn||!jn.INTERNAL||!jn.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:gc,Error:Rr};ch(t,"EmailAuthProvider",Ri,[]),ch(t,"FacebookAuthProvider",wi,[]),ch(t,"GithubAuthProvider",Ti,[]),ch(t,"GoogleAuthProvider",Ci,[]),ch(t,"TwitterAuthProvider",Ai,[]),ch(t,"OAuthProvider",_i,[Zc("providerId")]),ch(t,"SAMLAuthProvider",bi,[Zc("providerId")]),ch(t,"PhoneAuthProvider",xi,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof gc)}}]),ch(t,"RecaptchaVerifier",Yc,[ah(Zc(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),eh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof jn.app.App)}}]),jn.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:m((t=new gc(t)).getUid,t),getToken:m(t.cc,t),addAuthTokenListener:m(t.Vb,t),removeAuthTokenListener:m(t.Cc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),jn.INTERNAL.extendNamespace({User:Ou})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Bn||(Bn={}));var Wn,Kn,Hn,Gn,$n,Qn,zn,Yn,Xn,Jn,Zn=Bn.INFO,tr=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case Bn.DEBUG:case Bn.VERBOSE:console.log.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case Bn.INFO:console.info.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case Bn.WARN:console.warn.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;case Bn.ERROR:console.error.apply(console,["["+i+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},er=function(){function t(t){this.name=t,this._logLevel=Zn,this._logHandler=tr}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Bn))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,Bn.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,Bn.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,Bn.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,Bn.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,Bn.ERROR].concat(t))},t}(),nr=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),yn(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:dn(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),rr=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return gn(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),ir=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new nr(e)}}catch(t){}return new rr},or=ir("localStorage"),ar=ir("sessionStorage"),sr=new er("@firebase/database"),ur=function(){var t=1;return function(){return t++}}(),cr=function(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;Xe(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e}(t),n=new In;n.update(e);var r=n.digest();return tn.encodeByteArray(r)},hr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"==typeof t[r]&&"number"==typeof t[r].length?n+=hr.apply(null,t[r]):"object"==typeof t[r]?n+=yn(t[r]):n+=t[r],n+=" ";return n},lr=null,fr=!0,pr=function(t,e){Xe(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(sr.logLevel=Bn.VERBOSE,lr=sr.log.bind(sr),e&&ar.set("logging_enabled",!0)):"function"==typeof t?lr=t:(lr=null,ar.remove("logging_enabled"))},dr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===fr&&(fr=!1,null===lr&&!0===ar.get("logging_enabled")&&pr(!0)),lr){var n=hr.apply(null,t);lr(n)}},yr=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];dr.apply(void 0,[t].concat(e))}},mr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+hr.apply(void 0,t);sr.error(n)},gr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+hr.apply(void 0,t);throw sr.error(n),new Error(n)},vr=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+hr.apply(void 0,t);sr.warn(n)},br=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},_r="[MIN_NAME]",wr="[MAX_NAME]",Er=function(t,e){if(t===e)return 0;if(t===_r||e===wr)return-1;if(e===_r||t===wr)return 1;var n=Rr(t),r=Rr(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},Tr=function(t,e){return t===e?0:t<e?-1:1},Sr=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+yn(e))},Cr=function(t){if("object"!=typeof t||null===t)return yn(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=yn(e[i]),r+=":",r+=Cr(t[e[i]]);return r+"}"},Ir=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},Ar=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else bn(t,function(t,n){return e(n,t)})},Nr=function(t){var e,n,r,i,o,a,s;for(Xe(!br(t),"Invalid JSON number"),0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),s=a.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},Dr=new RegExp("^-?\\d{1,10}$"),Rr=function(t){if(Dr.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},Pr=function(t){try{t()}catch(t){setTimeout(function(){var e=t.stack||"";throw vr("Exception was thrown by user callback.",e),t},Math.floor(0))}},kr=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Or=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},Lr=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=Er(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),xr=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Ln(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=Ln(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=Ln(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),Mr="long_polling",Fr=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=or.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&or.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(Xe("string"==typeof t,"typeof type must == string"),Xe("object"==typeof e,"typeof params must == object"),"websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==Mr)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return bn(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),Ur=function(t){var e=Vr(t),n=e.subdomain;"firebase"===e.domain&&gr(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||gr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&vr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new Fr(e.host,e.secure,n,r),path:new Lr(e.pathString)}},Vr=function(t){var e="",n="",r="",i="",o=!0,a="https",s=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var c=t.indexOf("/");-1===c&&(c=t.length);var h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(c,h)),c<h&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(c,h)));var l=function(t){var e={};"?"===t.charAt(0)&&(t=t.substring(1));for(var n=0,r=t.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):vr("Invalid query segment '"+i+"' in query '"+t+"'")}}return e}(t.substring(Math.min(t.length,h)));(u=e.indexOf(":"))>=0?(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10)):u=t.length;var f=e.split(".");3===f.length?(n=f[1],r=f[0].toLowerCase()):2===f.length?n=f[0]:"localhost"===f[0].slice(0,u).toLowerCase()&&(n="localhost"),""===r&&"ns"in l&&(r=l.ns)}return{host:e,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}},Br=/[\[\].#$\/\u0000-\u001F\u007F]/,qr=/[\[\].#$\u0000-\u001F\u007F]/,jr=function(t){return"string"==typeof t&&0!==t.length&&!Br.test(t)},Wr=function(t){return"string"==typeof t&&0!==t.length&&!qr.test(t)},Kr=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!br(t)||t&&"object"==typeof t&&gn(t,".sv")},Hr=function(t,e,n,r,i){i&&void 0===n||Gr(Pn(t,e,i),n,r)},Gr=function(t,e,n){var r=n instanceof Lr?new xr(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(br(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>10485760/3&&Ln(e)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(bn(e,function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!jr(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),Gr(t,n,r),r.pop()}),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},$r=function(t,e,n,r,i){if(!i||void 0!==n){var o=Pn(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];bn(n,function(t,e){var n=new Lr(t);if(Gr(o,e,r.child(n)),".priority"===n.getBack()&&!Kr(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!jr(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Lr.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(o,a)}},Qr=function(t,e,n,r){if(!r||void 0!==n){if(br(n))throw new Error(Pn(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Kr(n))throw new Error(Pn(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},zr=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Pn(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Yr=function(t,e,n,r){if(!(r&&void 0===n||jr(n)))throw new Error(Pn(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Xr=function(t,e,n,r){if(!(r&&void 0===n||Wr(n)))throw new Error(Pn(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Jr=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},Zr=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!jr(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Wr(t)}(r))throw new Error(Pn(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ti=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){Rn("OnDisconnect.cancel",0,1,arguments.length),kn("OnDisconnect.cancel",1,t,!0);var e=new an;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){Rn("OnDisconnect.remove",0,1,arguments.length),Jr("OnDisconnect.remove",this.path_),kn("OnDisconnect.remove",1,t,!0);var e=new an;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){Rn("OnDisconnect.set",1,2,arguments.length),Jr("OnDisconnect.set",this.path_),Hr("OnDisconnect.set",1,t,this.path_,!1),kn("OnDisconnect.set",2,e,!0);var n=new an;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){Rn("OnDisconnect.setWithPriority",2,3,arguments.length),Jr("OnDisconnect.setWithPriority",this.path_),Hr("OnDisconnect.setWithPriority",1,t,this.path_,!1),Qr("OnDisconnect.setWithPriority",2,e,!1),kn("OnDisconnect.setWithPriority",3,n,!0);var r=new an;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(Rn("OnDisconnect.update",1,2,arguments.length),Jr("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,vr("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$r("OnDisconnect.update",1,t,this.path_,!1),kn("OnDisconnect.update",2,e,!0);var i=new an;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),ei=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return Rn("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),ni=(Wn="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Kn=0,Hn=[],function(t){var e,n=t===Kn;Kn=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=Wn.charAt(t%64),t=Math.floor(t/64);Xe(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===Hn[e];e--)Hn[e]=0;Hn[e]++}else for(e=0;e<12;e++)Hn[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=Wn.charAt(Hn[e]);return Xe(20===i.length,"nextPushId: Length should be 20."),i}),ri=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),ii=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new ri(_r,t),r=new ri(_r,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return ri.MIN},t}(),oi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $e(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Gn},set:function(t){Gn=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return Er(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw Je("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return ri.MIN},e.prototype.maxPost=function(){return new ri(wr,Gn)},e.prototype.makePost=function(t,e){return Xe("string"==typeof t,"KeyIndex indexValue must always be a string."),new ri(t,Gn)},e.prototype.toString=function(){return".key"},e}(ii),ai=new oi,si=function(t){return"number"==typeof t?"number:"+Nr(t):"string:"+t},ui=function(t){if(t.isLeafNode()){var e=t.val();Xe("string"==typeof e||"number"==typeof e||"object"==typeof e&&gn(e,".sv"),"Priority must be a string or number.")}else Xe(t===$n||t.isEmpty(),"priority of unexpected type.");Xe(t===$n||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},ci=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,Xe(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ui(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Qn},set:function(t){Qn=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(Xe(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+si(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?Nr(this.value_):this.value_,this.lazyHash_=cr(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(Xe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return Xe(i>=0,"Unknown leaf type: "+n),Xe(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),hi=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $e(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?Er(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return ri.MIN},e.prototype.maxPost=function(){return new ri(wr,new ci("[PRIORITY-POST]",Yn))},e.prototype.makePost=function(t,e){var n=zn(t);return new ri(e,new ci("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(ii)),li=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),fi=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:di.EMPTY_NODE,this.right=null!=o?o:di.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return(i=(r=n(t,(i=this).key))<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return di.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return di.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),pi=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new fi(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),di=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,fi.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,fi.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new li(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new li(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new li(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new li(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new pi,t}(),yi=Math.log(2),mi=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/yi,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),gi=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new fi(a,o.node,fi.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],a=n?n(o):o,new fi(a,o.node,fi.BLACK,c,h)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),h=t[o],l=n?n(h):h;u(new fi(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?s(l,fi.BLACK):(s(l,fi.BLACK),s(l,fi.RED))}return o}(new mi(t.length));return new di(r||e,o)},vi={},bi=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return Xe(vi&&hi,"ChildrenNode.ts has not been loaded"),Xn=Xn||new t({".priority":vi},{".priority":hi})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=vn(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===vi?null:e},t.prototype.hasIndex=function(t){return gn(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){Xe(e!==ai,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(ri.Wrap),s=a.getNext();s;)o=o||e.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?gi(i,e.getCompare()):vi;var u=e.toString(),c=_n(this.indexSet_);c[u]=e;var h=_n(this.indexes_);return h[u]=r,new t(h,c)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(Tn(this.indexes_,function(t,i){var o=vn(r.indexSet_,i);if(Xe(o,"Missing index implementation for "+i),t===vi){if(o.isDefinedOn(e.node)){for(var a=[],s=n.getIterator(ri.Wrap),u=s.getNext();u;)u.name!=e.name&&a.push(u),u=s.getNext();return a.push(e),gi(a,o.getCompare())}return vi}var c=n.get(e.name),h=t;return c&&(h=h.remove(new ri(e.name,c))),h.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(Tn(this.indexes_,function(t){if(t===vi)return t;var r=n.get(e.name);return r?t.remove(new ri(e.name,r)):t}),this.indexSet_)},t}();function _i(t,e){return Er(t.name,e.name)}function wi(t,e){return Er(t,e)}var Ei=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ui(this.priorityNode_),this.children_.isEmpty()&&Xe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Jn||(Jn=new t(new di(wi),null,bi.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Jn},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Jn:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(Xe(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new ri(e,n),i=void 0,o=void 0;return n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_)),new t(i,i.isEmpty()?Jn:this.priorityNode_,o)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Xe(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(hi,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+si(this.getPriority().val())+":"),this.forEachChild(hi,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":cr(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new ri(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new ri(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new ri(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,ri.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,ri.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ti?-1:0},t.prototype.withIndex=function(e){if(e===ai||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===ai||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(hi),r=e.getIterator(hi),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===ai?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Ti=new(function(t){function e(){return t.call(this,new di(wi),Ei.EMPTY_NODE,bi.Default)||this}return $e(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Ei.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Ei));Object.defineProperties(ri,{MIN:{value:new ri(_r,Ei.EMPTY_NODE)},MAX:{value:new ri(wr,Ti)}}),oi.__EMPTY_NODE=Ei.EMPTY_NODE,ci.__childrenNodeConstructor=Ei,$n=Ti,Yn=Ti;var Si=!0;function Ci(t,e){if(void 0===e&&(e=null),null===t)return Ei.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),Xe(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new ci(t,Ci(e));if(t instanceof Array||!Si){var n=Ei.EMPTY_NODE,r=t;return bn(r,function(t,e){if(gn(r,t)&&"."!==t.substring(0,1)){var i=Ci(e);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}}),n.updatePriority(Ci(e))}var i=[],o=!1,a=t;if(bn(a,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=Ci(a[t]);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new ri(t,n)))}}),0==i.length)return Ei.EMPTY_NODE;var s=gi(i,_i,function(t){return t.name},wi);if(o){var u=gi(i,hi.getCompare());return new Ei(s,Ci(e),new bi({".priority":u},{".priority":hi}))}return new Ei(s,Ci(e),bi.Default)}zn=Ci;var Ii,Ai,Ni=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $e(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?Er(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return ri.MIN},e.prototype.maxPost=function(){return ri.MAX},e.prototype.makePost=function(t,e){var n=Ci(t);return new ri(e,n)},e.prototype.toString=function(){return".value"},e}(ii)),Di=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,Xe(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return $e(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?Er(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Ci(t),r=Ei.EMPTY_NODE.updateChild(this.indexPath_,n);return new ri(e,r)},e.prototype.maxPost=function(){var t=Ei.EMPTY_NODE.updateChild(this.indexPath_,Ti);return new ri(wr,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(ii),Ri=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return Rn("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return Rn("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return Rn("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return Rn("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){Rn("DataSnapshot.child",0,1,arguments.length),e=String(e),Xr("DataSnapshot.child",1,e,!1);var n=new Lr(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,hi)},t.prototype.hasChild=function(t){Rn("DataSnapshot.hasChild",1,1,arguments.length),Xr("DataSnapshot.hasChild",1,t,!1);var e=new Lr(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return Rn("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return Rn("DataSnapshot.forEach",1,1,arguments.length),kn("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),hi))})},t.prototype.hasChildren=function(){return Rn("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return Rn("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return Rn("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Pi=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+yn(this.snapshot.exportVal())},t}(),ki=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Oi=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Pi("value",this,new Ri(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Xe(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ki(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Li=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,gn(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ki(this,t,e):null},t.prototype.createEvent=function(t,e){Xe(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Pi(t.type,this,new Ri(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Xe(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=En(e.callbacks_);if(n===En(this.callbacks_)){if(1===n){var r=Cn(e.callbacks_),i=Cn(this.callbacks_);return!(i!==r||e.callbacks_[r]&&this.callbacks_[i]&&e.callbacks_[r]!==this.callbacks_[i])}return function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0}(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),xi=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Xe(Ii,"Reference.ts has not been loaded"),Ii},set:function(t){Ii=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===ai){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=_r)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=wr)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===hi){if(null!=e&&!Kr(e)||null!=n&&!Kr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Xe(t.getIndex()instanceof Di||t.getIndex()===Ni,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return Rn("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){Rn("Query.on",2,4,arguments.length),zr("Query.on",1,e,!1),kn("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new Oi(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new Li(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){Rn("Query.off",0,3,arguments.length),zr("Query.off",1,t,!0),kn("Query.off",2,e,!0),On("Query.off",3,n,!0);var r=null,i=null;"value"===t?r=new Oi(e||null,null,n||null):t&&(e&&((i={})[t]=e),r=new Li(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;Rn("Query.once",1,4,arguments.length),zr("Query.once",1,e,!1),kn("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new an;u.promise.catch(function(){});var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),u.resolve(t))};return this.on(e,c,function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),u.reject(t)}),u.promise},t.prototype.limitToFirst=function(e){if(Rn("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(Rn("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(Rn("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Xr("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new Lr(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Di(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){Rn("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(ai);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){Rn("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(hi);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){Rn("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Ni);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),Rn("Query.startAt",0,2,arguments.length),Hr("Query.startAt",1,e,this.path,!0),Yr("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),Rn("Query.endAt",0,2,arguments.length),Hr("Query.endAt",1,e,this.path,!0),Yr("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(Rn("Query.equalTo",1,2,arguments.length),Hr("Query.equalTo",1,t,this.path,!1),Yr("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return Rn("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return Rn("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=Cr(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(Rn("Query.isEqual",1,1,arguments.length),!(e instanceof t))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,kn(t,3,r.cancel,!0),r.context=n,On(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(Pn(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Mi=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return gn(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return wn(this.set)},t.prototype.count=function(){return En(this.set)},t.prototype.each=function(t){bn(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return bn(this.set,function(e){t.push(e)}),t},t}(),Fi=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();return t=t.popFront(),this.children_.contains(e)?this.children_.get(e).find(t):null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new Mi);var r=e.getFront();this.children_.contains(r)||this.children_.add(r,new t);var i=this.children_.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(hi,function(t,e){n.remember(new Lr(t),e)}),this.forget(t)}if(null!==this.children_){var r=t.getFront();return t=t.popFront(),this.children_.contains(r)&&this.children_.get(r).forget(t)&&this.children_.remove(r),!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,r){var i=new Lr(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}(),Ui=function(t,e){return t&&"object"==typeof t?(Xe(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},Vi=function(t,e){var n,r=t.getPriority().val(),i=Ui(r,e);if(t.isLeafNode()){var o=t,a=Ui(o.getValue(),e);return a!==o.getValue()||i!==o.getPriority().val()?new ci(a,Ci(i)):t}var s=t;return n=s,i!==s.getPriority().val()&&(n=n.updatePriority(new ci(i))),s.forEachChild(hi,function(t,r){var i=Vi(r,e);i!==r&&(n=n.updateImmediateChild(t,i))}),n};!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ai||(Ai={}));var Bi,qi,ji=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Xe(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),Wi=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ai.ACK_USER_WRITE,this.source=ji.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Xe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Lr(e));return new t(Lr.Empty,n,this.revert)}return Xe(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),Ki=function(){return Bi||(Bi=new di(Tr)),Bi},Hi=function(){function t(t,e){void 0===e&&(e=Ki()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return bn(e,function(t,e){n=n.set(new Lr(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Lr.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new Lr(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||t.Empty).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||t.Empty).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(Lr.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Lr.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Lr.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(Lr.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}(),Gi=function(){function t(t,e){this.source=t,this.path=e,this.type=Ai.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Lr.Empty):new t(this.source,this.path.popFront())},t}(),$i=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ai.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Lr.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),Qi=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ai.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new Lr(e));return n.isEmpty()?null:n.value?new $i(this.source,Lr.Empty,n.value):new t(this.source,Lr.Empty,n)}return Xe(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),zi=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Yi=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new zi(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new zi(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new zi(Ei.EMPTY_NODE,!1,!1),new zi(Ei.EMPTY_NODE,!1,!1)),t}(),Xi=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),Ji=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){Xe(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(Xi.childRemovedChange(e,a)):Xe(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Xi.childAddedChange(e,n)):o.trackChildChange(Xi.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(hi,function(t,r){e.hasChild(t)||n.trackChildChange(Xi.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(hi,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Xi.childChangedChange(e,r,i))}else n.trackChildChange(Xi.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Ei.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Zi=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Xe(e==Xi.CHILD_ADDED||e==Xi.CHILD_CHANGED||e==Xi.CHILD_REMOVED,"Only child changes supported for tracking"),Xe(".priority"!==n,"Only non-priority child changes can be tracked.");var r=vn(this.changeMap_,n);if(r){var i=r.type;if(e==Xi.CHILD_ADDED&&i==Xi.CHILD_REMOVED)this.changeMap_[n]=Xi.childChangedChange(n,t.snapshotNode,r.snapshotNode);else if(e==Xi.CHILD_REMOVED&&i==Xi.CHILD_ADDED)delete this.changeMap_[n];else if(e==Xi.CHILD_REMOVED&&i==Xi.CHILD_CHANGED)this.changeMap_[n]=Xi.childRemovedChange(n,r.oldSnap);else if(e==Xi.CHILD_CHANGED&&i==Xi.CHILD_ADDED)this.changeMap_[n]=Xi.childAddedChange(n,t.snapshotNode);else{if(e!=Xi.CHILD_CHANGED||i!=Xi.CHILD_CHANGED)throw Je("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap_[n]=Xi.childChangedChange(n,t.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e}(this.changeMap_)},t}(),to=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),eo=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new zi(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),no=function(t,e){this.viewCache=t,this.changes=e},ro=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){Xe(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Xe(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,s=new Zi;if(n.type===Ai.OVERWRITE){var u=n;u.source.fromUser?o=this.applyUserOverwrite_(e,u.path,u.snap,r,i,s):(Xe(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.getServerCache().isFiltered()&&!u.path.isEmpty(),o=this.applyServerOverwrite_(e,u.path,u.snap,r,i,a,s))}else if(n.type===Ai.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(e,c.path,c.children,r,i,s):(Xe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,c.path,c.children,r,i,a,s))}else if(n.type===Ai.ACK_USER_WRITE){var h=n;o=h.revert?this.revertUserWrite_(e,h.path,r,i,s):this.ackUserWrite_(e,h.path,h.affectedTree,r,i,s)}else{if(n.type!==Ai.LISTEN_COMPLETE)throw Je("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,s)}var l=s.getChanges();return t.maybeAddValueEvent_(e,o,l),new no(o,l)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Xi.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,s=void 0;if(e.isEmpty())if(Xe(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof Ei?u:Ei.EMPTY_NODE,h=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var l=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var f=e.getFront();if(".priority"==f){Xe(1==e.getLength(),"Can't have a priority with additional path components");var p=o.getNode();s=t.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(e,p,s);a=null!=d?this.filter_.updatePriority(p,d):o.getNode()}else{var y=e.popFront(),m=void 0;if(o.isCompleteForChild(f)){s=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),s);m=null!=g?o.getNode().getImmediateChild(f).updateChild(y,g):o.getNode().getImmediateChild(f)}else m=n.calcCompleteChild(f,t.getServerCache());a=null!=m?this.filter_.updateChild(o.getNode(),f,m,y,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),p=u.getNode().getImmediateChild(l).updateChild(f,n);s=".priority"==l?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),l,p,f,to,null)}var d=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),y=new eo(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,y,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new eo(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var h=e.getFront();if(".priority"===h)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),f=u.getNode().getImmediateChild(h),p=void 0;if(l.isEmpty())p=n;else{var d=c.getCompleteChild(h);p=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):Ei.EMPTY_NODE}if(f.equals(p))a=t;else{var y=this.filter_.updateChild(u.getNode(),h,p,l,c,o);a=t.updateEventSnap(y,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())&&(u=s.applyUserOverwrite_(u,h,c,i,o,a))}),r.foreach(function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())||(u=s.applyUserOverwrite_(u,h,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:Hi.Empty.setTree(e,n);var h=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(h.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),l=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new Lr(e),l,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!h.hasChild(e)&&!u){var l=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(l,n);c=s.applyServerOverwrite_(c,new Lr(e),f,r,i,o,a)}}),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=Hi.Empty;return s.getNode().forEachChild(ai,function(t,e){u=u.set(new Lr(t),e)}),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=Hi.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,to,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new eo(n,t,r),s=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Xe(h instanceof Ei,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(h)}c=c,u=this.filter_.updateFullNode(s,c,i)}else{var l=e.getFront(),f=n.calcCompleteChild(l,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(l)&&(f=s.getImmediateChild(l)),(u=null!=f?this.filter_.updateChild(s,l,f,e.popFront(),a,i):t.getEventCache().getNode().hasChild(l)?this.filter_.updateChild(s,l,Ei.EMPTY_NODE,e.popFront(),a,i):s).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Lr.Empty),t.updateEventSnap(u,o,this.filter_.filtersNodes())},t}(),io=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===Xi.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(Xi.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,Xi.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,Xi.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,Xi.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,Xi.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,Xi.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Je("Should only compare child_ events.");var n=new ri(t.childName,t.snapshotNode),r=new ri(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),oo=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Ji(n.getIndex()),i=n.getNodeFilter();this.processor_=new ro(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(Ei.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Ei.EMPTY_NODE,a.getNode(),null),c=new zi(s,o.isFullyInitialized(),r.filtersNodes()),h=new zi(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Yi(h,c),this.eventGenerator_=new io(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){Xe(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===Ai.MERGE&&null!==t.source.queryId&&(Xe(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Xe(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Xe(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(hi,function(t,e){n.push(Xi.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(Xi.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),ao=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return Xe(qi,"Reference.ts has not been loaded"),qi},set:function(t){Xe(!qi,"__referenceConstructor has already been defined"),qi=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return wn(this.views_)},t.prototype.applyOperation=function(t,e,n){var r=t.source.queryId;if(null!==r){var i=vn(this.views_,r);return Xe(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(t,e,n)}var o=[];return bn(this.views_,function(r,i){o=o.concat(i.applyOperation(t,e,n))}),o},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=vn(this.views_,o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof Ei?(s=n.calcCompleteEventChildren(r),u=!1):(s=Ei.EMPTY_NODE,u=!1);var c=new Yi(new zi(s,u,!1),new zi(r,i,!1));a=new oo(t,c),this.views_[o]=a}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i=e.queryIdentifier(),o=[],a=[],s=this.hasCompleteView();if("default"===i){var u=this;bn(this.views_,function(t,e){a=a.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete u.views_[t],e.getQuery().getQueryParams().loadsAllData()||o.push(e.getQuery()))})}else{var c=vn(this.views_,i);c&&(a=a.concat(c.removeEventRegistration(n,r)),c.isEmpty()&&(delete this.views_[i],c.getQuery().getQueryParams().loadsAllData()||o.push(c.getQuery())))}return s&&!this.hasCompleteView()&&o.push(new t.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return bn(this.views_,function(n,r){e=e||r.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return vn(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;return t=this.views_,(e=Sn(t,function(t){return t.getQuery().getQueryParams().loadsAllData()},void 0))&&t[e]||null},t}(),so=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new Hi(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=Lr.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new Hi(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return bn(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,Hi.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(Lr.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(hi,function(e,n){t.push(new ri(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new ri(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new Hi(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(Lr.Empty,this.writeTree_,e)},t.Empty=new t(new Hi(null)),t.applySubtreeWrite_=function(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(Xe(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t.applySubtreeWrite_(e.child(n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r},t}(),uo=function(){function t(){this.visibleWrites_=so.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new co(t,this)},t.prototype.addOverwrite=function(t,e,n,r){Xe(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){Xe(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});Xe(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=n&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var u=r.children;bn(u,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(Lr.Empty)){var a=t.layerTree_(this.allWrites_,function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e);return c=n||Ei.EMPTY_NODE,a.apply(c)}return null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(Lr.Empty)){var c=n||Ei.EMPTY_NODE;return u.apply(c)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Ei.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(hi,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(hi,function(t,e){var r=i.childCompoundWrite(new Lr(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Xe(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(Lr.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=l.getNext();f&&c.length<r;)0!==h(f,n)&&c.push(f),f=l.getNext();return c},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!Sn(t.children,function(n,r){return t.path.child(r).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,Lr.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=so.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=Lr.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=Lr.relativePath(a,n),r=r.addWrite(Lr.Empty,o.snap.getChild(s)));else{if(!o.children)throw Je("WriteRecord should have .snap or .children");if(n.contains(a))s=Lr.relativePath(n,a),r=r.addWrites(s,o.children);else if(a.contains(n))if((s=Lr.relativePath(a,n)).isEmpty())r=r.addWrites(Lr.Empty,o.children);else{var u=vn(o.children,s.getFront());if(u){var c=u.getChild(s.popFront());r=r.addWrite(Lr.Empty,c)}}}}}return r},t}(),co=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),ho=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=Hi.Empty,this.pendingWriteTree_=new uo,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new $i(ji.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=Hi.fromObject(e);return this.applyOperationToSyncPoints_(new Qi(ji.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=Hi.Empty;return null!=n.snap?r=r.set(Lr.Empty,!0):bn(n.children,function(t,e){r=r.set(new Lr(t),e)}),this.applyOperationToSyncPoints_(new Wi(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new $i(ji.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=Hi.fromObject(e);return this.applyOperationToSyncPoints_(new Qi(ji.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new Gi(ji.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=Lr.relativePath(a,e),c=new $i(ji.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=Lr.relativePath(a,e),c=Hi.fromObject(n),h=new Qi(ji.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,h)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=Lr.relativePath(o,e),u=new Gi(ji.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=Lr.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()});var a,s=this.syncPointTree_.get(r);s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(Lr.Empty)):(s=new ao,this.syncPointTree_=this.syncPointTree_.set(r,s)),null!=i?a=!0:(a=!1,i=Ei.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(Lr.Empty);n&&(i=i.updateImmediateChild(t,n))}));var u=s.viewExistsForQuery(e);if(!u&&!e.getQueryParams().loadsAllData()){var c=t.makeQueryKey_(e);Xe(!(c in this.queryToTagMap_),"View does not exist, but we have a tag");var h=t.getNextQueryTag_();this.queryToTagMap_[c]=h,this.tagToQueryMap_["_"+h]=c}var l=this.pendingWriteTree_.childWrites(r),f=s.addEventRegistration(e,n,l,i,a);if(!u&&!o){var p=s.viewForQuery(e);f=f.concat(this.setupListener_(e,p))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var h=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),l=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(h&&!l){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var y=p[d],m=y.getQuery(),g=this.createListenerForView_(y);this.listenProvider_.startListening(t.queryForListening_(m),this.tagForQuery_(m),g.hashFn,g.onComplete)}}!l&&c.length>0&&!r&&(h?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach(function(e){var n=i.queryToTagMap_[t.makeQueryKey_(e)];i.listenProvider_.stopListening(t.queryForListening_(e),n)})),this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=Lr.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),bn(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(r);if(i)Xe(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),bn(n,function(t,e){r=r.concat(e)}),r}),c=0;c<u.length;++c){var h=u[c];this.listenProvider_.stopListening(t.queryForListening_(h),this.tagForQuery_(h))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Ei.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return Xe(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Lr(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return vn(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Xe(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Lr.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(Lr.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Lr.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(Lr.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(Lr.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),lo=function(){function t(){this.rootNode_=Ei.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),fo=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(dr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',vr(t)},t}(),po=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),gn(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return nn(this.counters_)},t}(),yo=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new po),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),mo=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=_n(t);return this.last_&&bn(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),go=1e4,vo=3e4,bo=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new mo(t);var n=go+(vo-go)*Math.random();Or(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;bn(e,function(e,i){i>0&&gn(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),Or(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),_o=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new wo(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),wo=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();lr&&dr("event: "+e.toString()),Pr(n)}}},t.prototype.getPath=function(){return this.path_},t}(),Eo=function(){function t(t){this.allowedEvents_=t,this.listeners_={},Xe(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=this.listeners_[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){Xe(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),To=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return $e(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Xe("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Eo),So=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||sn()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return $e(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return Xe("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Eo),Co=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&Pr(function(){n.onMessage_(t[e])})},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Io="pLPCommand",Ao="pRTLPCB",No=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=yr(t),this.stats_=yo.getCollection(e),this.urlFn=function(t){return e.connectionURL(Mr,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Co(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if(cn()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new Do(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1],o=t[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==r)n.id=i,n.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),!cn()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!cn()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=yn(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n,r=(n=Ze(e),tn.encodeByteArray(n,!0)),i=Ir(r,1840),o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!cn()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=yn(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),Do=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Mi,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,cn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=ur(),window[Io+this.uniqueCallbackIdentifier]=e,window[Ao+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){dr("frame writing exception"),t.stack&&dr(t.stack),dr(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||dr("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var e=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0))),cn()&&this.myID){var n={disconn:"t"};n.id=this.myID,n.pw=this.myPW;var r=this.urlFn(n);t.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},t.prototype.addTag=function(t,e){var n=this;cn()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){dr("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}},Math.floor(1))},t}(),Ro=null;"undefined"!=typeof MozWebSocket?Ro=MozWebSocket:"undefined"!=typeof WebSocket&&(Ro=WebSocket);var Po=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=yr(this.connId),this.stats_=yo.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!cn()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL("websocket",r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,or.set("previous_websocket_failure",!0);try{if(cn()){var r={headers:{"User-Agent":"Firebase/5/"+jn.SDK_VERSION+"/"+process.platform+"/Node"}},i=process.env,o=0==this.connURL.indexOf("wss://")?i.HTTPS_PROXY||i.https_proxy:i.HTTP_PROXY||i.http_proxy;o&&(r.proxy={origin:o}),this.mySock=new Ro(this.connURL,[],r)}else this.mySock=new Ro(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var a=t.message||t.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Ro&&!t.forceDisallow_},t.previouslyFailed=function(){return or.isInMemoryStorage||!0===or.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){or.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=dn(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(Xe(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=yn(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=Ir(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),ko=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[No,Po]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=Po&&Po.isAvailable(),r=n&&!Po.previouslyFailed();if(e.webSocketOnly&&(n||vr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Po];else{var i=this.transports_=[];Ar(t.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&i.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Oo=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=yr("c:"+this.id+":"),this.transportManager_=new ko(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Or(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=Sr("t",t),n=Sr("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=Sr("t",t),n=Sr("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=Sr("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?mr("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):mr("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&vr("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Or(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Or(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(or.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Lo=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),xo=1e3,Mo=3e5,Fo=function(t){function e(n,r,i,o,a,s){var u=t.call(this)||this;if(u.repoInfo_=n,u.onDataUpdate_=r,u.onConnectStatus_=i,u.onServerInfoUpdate_=o,u.authTokenProvider_=a,u.authOverride_=s,u.id=e.nextPersistentConnectionId_++,u.log_=yr("p:"+u.id+":"),u.interruptReasons_={},u.listens_={},u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=xo,u.maxReconnectDelay_=Mo,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,s&&!cn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),To.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&So.getInstance().on("online",u.onOnline_,u),u}return $e(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(yn(i)),Xe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},Xe(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Xe(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens_[i]&&n.listens_[i][o])===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&gn(t,"w")){var n=vn(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();vr("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){var e;(t&&40===t.length||"object"==typeof(e=mn(t).claims)&&!0===e.admin)&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t,e=this;if(this.connected_&&this.authToken_){var n=this.authToken_,r=(t=mn(n).claims)&&"object"==typeof t&&t.hasOwnProperty("iat")?"auth":"gauth",i={cred:n};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,function(t){var r=t.s,i=t.d||"error";e.authToken_===n&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Xe(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+yn(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):mr("Unrecognized action received from server: "+yn(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;Xe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=xo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())};this.realtime_={close:c,sendRequest:function(t){Xe(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then(function(e){s?dr("getToken() completed but was canceled"):(dr("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new Oo(i,o.repoInfo_,t,n,r,function(t){vr(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(t){o.log_("Failed to get token: "+t),s||c()})}},e.prototype.interrupt=function(t){dr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){dr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],wn(this.interruptReasons_)&&(this.reconnectDelay_=xo,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return Cr(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new Lr(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===En(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){dr("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),bn(this.listens_,function(e,n){bn(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";t["sdk."+e+"."+jn.SDK_VERSION.replace(/\./g,"-")]=1,sn()?t["framework.cordova"]=1:un()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=So.getInstance().currentlyOnline();return wn(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Lo),Uo=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=yr("p:rest:"),i.listens_={},i}return $e(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Xe(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var s=e.getListenId_(t,r),u={};this.listens_[s]=u;var c=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),vn(o.listens_,s)===u&&i(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(e.auth=o);var a,s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(a=[],bn(e,function(t,e){Array.isArray(e)?e.forEach(function(e){a.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):a.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),a.length?"&"+a.join("&"):"");r.log_("Sending REST request for "+s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+s+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=dn(u.responseText)}catch(t){vr("Failed to parse JSON response for "+s+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&vr("Got unsuccessful REST response for "+s+" Status: "+u.status),n(u.status);n=null}},u.open("GET",s,!0),u.send()})},e}(Lo),Vo=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new _o,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Fi,this.persistentConnection_=null;var i=new fo(n);if(this.stats_=yo.getCollection(t),e||kr())this.server_=new Uo(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{yn(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new Fo(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=yo.getOrCreateReporter(t,function(){return new bo(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new lo,this.infoSyncTree_=new ho({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new ho({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new Lr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new Lr(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=Tn(e,function(t){return Ci(t)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var s=Ci(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,r)}else if(n){var u=Tn(e,function(t){return Ci(t)});o=this.serverSyncTree_.applyServerMerge(i,u)}else{var c=Ci(e);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;Ar(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new Lr("/.info/"+t),r=Ci(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=Ci(e,n),s=Vi(a,o),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(t,s,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(t.toString(),a.val(!0),function(e,n){var o="ok"===e;o||vr("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)});var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(bn(e,function(t,e){i=!1;var n=Ci(e);a[t]=Vi(n,o)}),i)dr("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,function(e,i){var o="ok"===e;o||vr("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)}),bn(e,function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=[];(function(t,e){var n=new Fi;return t.forEachTree(new Lr(""),function(t,r){n.remember(t,Vi(r,e))}),n})(this.onDisconnect_,e).forEachTree(Lr.Empty,function(e,r){n=n.concat(t.serverSyncTree_.applyServerOverwrite(e,r));var i=t.abortTransactions_(e);t.rerunTransactions_(i)}),this.onDisconnect_=new Fi,this.eventQueue_.raiseEventsForChangedPath(Lr.Empty,n)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Ci(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Ci(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(wn(e))return dr("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,o){"ok"===i&&bn(e,function(e,n){var i=Ci(n);r.onDisconnect_.remember(t.child(e),i)}),r.callOnCompleteCallback(n,i,o)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new mo(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);bn(e,function(t,e){for(var r=t.length;r<n+2;r++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),dr.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&Pr(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new zo(this))},enumerable:!0,configurable:!0}),t}(),Bo=function(){function t(e){this.indexedFilter_=new Ji(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new ri(e,n))||(n=Ei.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Ei.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Ei.EMPTY_NODE);var i=this;return e.forEachChild(hi,function(t,e){i.matches(new ri(t,e))||(r=r.updateImmediateChild(t,Ei.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),qo=function(){function t(t){this.rangedFilter_=new Bo(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new ri(e,n))||(n=Ei.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Ei.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Ei.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Ei.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();)a=i.getNext(),!l&&c(s,a)<=0&&(l=!0),l&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,Ei.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var s=t;Xe(s.numChildren()==this.limit_,"");var u=new ri(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(s.hasChild(e)){for(var l=s.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name==e||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(Xi.childChangedChange(e,n,l)),s.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Xi.childRemovedChange(e,l));var d=s.updateImmediateChild(e,Ei.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Xi.childAddedChange(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?t:h&&o(c,u)>=0?(null!=i&&(i.trackChildChange(Xi.childRemovedChange(c.name,c.node)),i.trackChildChange(Xi.childAddedChange(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Ei.EMPTY_NODE)):t},t}(),jo=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=hi}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return Xe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return Xe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:_r},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return Xe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return Xe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:wr},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return Xe(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==hi&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==hi},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new Ji(this.getIndex()):this.hasLimit()?new qo(this):new Bo(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===hi?e=n.PRIORITY_INDEX:this.index_===Ni?e=n.VALUE_INDEX:this.index_===ai?e=n.KEY_INDEX:(Xe(this.index_ instanceof Di,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=yn(e),this.startSet_&&(r[n.START_AT]=yn(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+yn(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=yn(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+yn(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),Wo=function(t){function e(e,n){if(!(e instanceof Vo))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,jo.DEFAULT,!1)||this}return $e(e,t),e.prototype.getKey=function(){return Rn("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return Rn("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof Lr||(null===this.path.getFront()?((n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Xr("Reference.child",1,n,!1)):Xr("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t));var n},e.prototype.getParent=function(){Rn("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){Rn("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){Rn("Reference.set",1,2,arguments.length),Jr("Reference.set",this.path),Hr("Reference.set",1,t,this.path,!1),kn("Reference.set",2,e,!0);var n=new an;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(Rn("Reference.update",1,2,arguments.length),Jr("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,vr("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$r("Reference.update",1,t,this.path,!1),kn("Reference.update",2,e,!0);var i=new an;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(Rn("Reference.setWithPriority",2,3,arguments.length),Jr("Reference.setWithPriority",this.path),Hr("Reference.setWithPriority",1,t,this.path,!1),Qr("Reference.setWithPriority",2,e,!1),kn("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new an;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return Rn("Reference.remove",0,1,arguments.length),Jr("Reference.remove",this.path),kn("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(Rn("Reference.transaction",1,3,arguments.length),Jr("Reference.transaction",this.path),kn("Reference.transaction",1,t,!1),kn("Reference.transaction",2,e,!0),function(t,e,n,r){if(void 0!==n&&"boolean"!=typeof n)throw new Error(Pn("Reference.transaction",3,!0)+"must be a boolean.")}(0,0,n),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new an;return"function"==typeof e&&r.promise.catch(function(){}),this.repo.startTransaction(this.path,t,function(t,n,i){t?r.reject(t):r.resolve(new ei(n,i)),"function"==typeof e&&e(t,n,i)},n),r.promise},e.prototype.setPriority=function(t,e){Rn("Reference.setPriority",1,2,arguments.length),Jr("Reference.setPriority",this.path),Qr("Reference.setPriority",1,t,!1),kn("Reference.setPriority",2,e,!0);var n=new an;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){Rn("Reference.push",0,2,arguments.length),Jr("Reference.push",this.path),Hr("Reference.push",1,t,this.path,!0),kn("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=ni(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return Jr("Reference.onDisconnect",this.path),new ti(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(xi);xi.__referenceConstructor=Wo,ao.__referenceConstructor=Wo;var Ko,Ho=function(){this.children={},this.childCount=0,this.value=null},Go=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new Ho),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof Lr?e:new Lr(e),i=this;null!==(n=r.getFront());)i=new t(n,i,vn(i.node_.children,n)||new Ho),r=r.popFront();return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){Xe(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;bn(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new Lr(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=gn(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(Ko||(Ko={})),Vo.MAX_TRANSACTION_RETRIES_=25,Vo.prototype.transactions_init_=function(){this.transactionQueueTree_=new Go},Vo.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new Wo(this,t);o.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:ur(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(t);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var c=new Ri(a.currentInputSnapshot,new Wo(this,a.path),hi);a.onComplete(null,!1,c)}}else{Gr("transaction failed: Data returned ",u,a.path),a.status=Ko.RUN;var h=this.transactionQueueTree_.subTree(t),l=h.getValue()||[];l.push(a),h.setValue(l);var f=void 0;"object"==typeof u&&null!==u&&gn(u,".priority")?(f=vn(u,".priority"),Xe(Kr(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(this.serverSyncTree_.calcCompleteEventCache(t)||Ei.EMPTY_NODE).getPriority().val(),f=f;var p=this.generateServerValues(),d=Ci(u,f),y=Vi(d,p);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(t,y,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,m),this.sendReadyTransactions_()}},Vo.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Ei.EMPTY_NODE},Vo.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Xe(n.length>0,"Sending zero length transaction queue"),n.every(function(t){return t.status===Ko.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},Vo.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map(function(t){return t.currentWriteId}),i=this.getLatestState_(t,r),o=i,a=i.hash(),s=0;s<e.length;s++){var u=e[s];Xe(u.status===Ko.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=Ko.SENT,u.retryCount++;var c=Lr.relativePath(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var h=o.val(!0),l=t;this.server_.put(l.toString(),h,function(r){n.log_("transaction put response",{path:l.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=Ko.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new Wo(n,e[a].path),c=new Ri(s,u,hi);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),a=0;a<o.length;a++)Pr(o[a])}else{if("datastale"===r)for(a=0;a<e.length;a++)e[a].status===Ko.SENT_NEEDS_ABORT?e[a].status=Ko.NEEDS_ABORT:e[a].status=Ko.RUN;else for(vr("transaction at "+l.toString()+" failed: "+r),a=0;a<e.length;a++)e[a].status=Ko.NEEDS_ABORT,e[a].abortReason=r;n.rerunTransactions_(t)}},a)},Vo.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},Vo.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter(function(t){return t.status===Ko.RUN}).map(function(t){return t.currentWriteId}),a=0;a<t.length;a++){var s=t[a],u=Lr.relativePath(e,s.path),c=!1,h=void 0;if(Xe(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Ko.NEEDS_ABORT)c=!0,h=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Ko.RUN)if(s.retryCount>=Vo.MAX_TRANSACTION_RETRIES_)c=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var l=this.getLatestState_(s.path,o);s.currentInputSnapshot=l;var f=t[a].update(l.val());if(void 0!==f){Gr("transaction failed: Data returned ",f,s.path);var p=Ci(f);"object"==typeof f&&null!=f&&gn(f,".priority")||(p=p.updatePriority(l.getPriority()));var d=s.currentWriteId,y=this.generateServerValues(),m=Vi(p,y);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else c=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],c&&(t[a].status=Ko.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===h){var g=new Wo(this,t[a].path),v=t[a].currentInputSnapshot,b=new Ri(v,g,hi);r.push(t[a].onComplete.bind(null,null,!1,b))}else r.push(t[a].onComplete.bind(null,new Error(h),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<r.length;a++)Pr(r[a]);this.sendReadyTransactions_()}},Vo.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},Vo.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},Vo.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},Vo.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==Ko.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},Vo.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},Vo.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)e[o].status===Ko.SENT_NEEDS_ABORT||(e[o].status===Ko.SENT?(Xe(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=Ko.SENT_NEEDS_ABORT,e[o].abortReason="set"):(Xe(e[o].status===Ko.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete&&n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),o=0;o<n.length;o++)Pr(n[o])}};var $o,Qo=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return $o||($o=new t),$o},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&gr("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var r=Ur(n),i=r.repoInfo;return Zr("Invalid Firebase Database URL",1,r),r.path.isEmpty()||gr("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=vn(this.repos_,t.app.name);e&&vn(e,t.repoInfo_.toURLString())===t||gr("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=vn(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=vn(n,t.toURLString());return r&&gr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Vo(t,this.useRestClient_,e),n[t.toURLString()]=r,r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),zo=function(){function t(t){this.repo_=t,t instanceof Vo||gr("Don't call new Database() directly - please use firebase.database()."),this.root_=new Wo(t,Lr.Empty),this.INTERNAL=new Yo(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),Rn("database.ref",0,1,arguments.length),t instanceof Wo?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),Rn(e,1,1,arguments.length);var n=Ur(t);Zr(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&gr(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&gr("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){Rn("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){Rn("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),Yo=function(){function t(t){this.database=t}return t.prototype.delete=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return this.database.checkDeleted_("delete"),Qo.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},t}(),Xo=Object.freeze({forceLongPolling:function(){Po.forceDisallow(),No.forceAllow()},forceWebSockets:function(){No.forceDisallow()},isWebSocketsAvailable:function(){return Po.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),Jo=Fo;Fo.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Fo.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Zo,ta=Oo,ea=Fr,na=Object.freeze({DataConnection:Jo,RealTimeConnection:ta,hijackHash:function(t){var e=Fo.prototype.put;return Fo.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Fo.prototype.put=e}},ConnectionTarget:ea,queryIdentifier:function(t){return t.queryIdentifier()},listens:function(t){return t.repo.persistentConnection_.listens_},forceRestClient:function(t){Qo.getInstance().forceRestClient(t)}}),ra=zo.ServerValue;Zo=jn.INTERNAL.registerService("database",function(t,e,n){return Qo.getInstance().databaseFromApp(t,n)},{Reference:Wo,Query:xi,Database:zo,enableLogging:pr,INTERNAL:Xo,ServerValue:ra,TEST_ACCESS:na},null,!0),cn()&&(module.exports=Zo);var ia,oa="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},aa=aa||{},sa=oa;function ua(t){return"string"==typeof t}function ca(t,e){t=t.split("."),e=e||sa;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function ha(){}function la(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function fa(t){return"array"==la(t)}function pa(t){var e=la(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==la(t)}function ya(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ma="closure_uid_"+(1e9*Math.random()>>>0),ga=0;function va(t,e,n){return t.call.apply(t.bind,arguments)}function ba(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _a(t,e,n){return(_a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?va:ba).apply(null,arguments)}function wa(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var Ea=Date.now||function(){return+new Date};function Ta(t,e){function n(){}n.prototype=e.prototype,t.L=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.mh=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Sa(t){if(Error.captureStackTrace)Error.captureStackTrace(this,Sa);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function Ca(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");Sa.call(this,n+t[r])}function Ia(){0!=Aa&&(Na[this[ma]||(this[ma]=++ga)]=this),this.Ka=this.Ka,this.Qa=this.Qa}Ta(Sa,Error),Sa.prototype.name="CustomError",Ta(Ca,Sa),Ca.prototype.name="AssertionError";var Aa=0,Na={};Ia.prototype.Ka=!1,Ia.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=Aa)){var t=this[ma]||(this[ma]=++ga);if(0!=Aa&&this.Qa&&0<this.Qa.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Na[t]}},Ia.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var Da=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(ua(t))return ua(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Ra=Array.prototype.lastIndexOf?function(t,e){return Array.prototype.lastIndexOf.call(t,e,t.length-1)}:function(t,e){var n=t.length-1;if(0>n&&(n=Math.max(0,t.length+n)),ua(t))return ua(e)&&1==e.length?t.lastIndexOf(e,n):-1;for(;0<=n;n--)if(n in t&&t[n]===e)return n;return-1},Pa=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=ua(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},ka=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=ua(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Oa(t){if(!fa(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function La(t,e){var n;return(n=0<=(e=Da(t,e)))&&Array.prototype.splice.call(t,e,1),n}function xa(t){return Array.prototype.concat.apply([],arguments)}function Ma(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Fa(t){return/^[\s\xa0]*$/.test(t)}var Ua,Va=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ba(t,e){return t<e?-1:t>e?1:0}t:{var qa=sa.navigator;if(qa){var ja=qa.userAgent;if(ja){Ua=ja;break t}}Ua=""}function Wa(t){return-1!=Ua.indexOf(t)}function Ka(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ha(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Ga(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function $a(t){var e,n={};for(e in t)n[e]=t[e];return n}var Qa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function za(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Qa.length;o++)n=Qa[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ya(t){return Ya[" "](t),t}Ya[" "]=ha;var Xa,Ja,Za=Wa("Opera"),ts=Wa("Trident")||Wa("MSIE"),es=Wa("Edge"),ns=es||ts,rs=Wa("Gecko")&&!(-1!=Ua.toLowerCase().indexOf("webkit")&&!Wa("Edge"))&&!(Wa("Trident")||Wa("MSIE"))&&!Wa("Edge"),is=-1!=Ua.toLowerCase().indexOf("webkit")&&!Wa("Edge");function os(){var t=sa.document;return t?t.documentMode:void 0}t:{var as="",ss=(Ja=Ua,rs?/rv:([^\);]+)(\)|;)/.exec(Ja):es?/Edge\/([\d\.]+)/.exec(Ja):ts?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ja):is?/WebKit\/(\S+)/.exec(Ja):Za?/(?:Version)[ \/]?(\S+)/.exec(Ja):void 0);if(ss&&(as=ss?ss[1]:""),ts){var us=os();if(null!=us&&us>parseFloat(as)){Xa=String(us);break t}}Xa=as}var cs,hs={};function ls(t){return function(t,e){var n=hs;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,function(){for(var e=0,n=Va(String(Xa)).split("."),r=Va(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Ba(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Ba(0==a[2].length,0==s[2].length)||Ba(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var fs=sa.document;cs=fs&&ts?os()||("CSS1Compat"==fs.compatMode?parseInt(Xa,10):5):void 0;var ps=Object.freeze||function(t){return t},ds=!ts||9<=Number(cs),ys=ts&&!ls("9"),ms=function(){if(!sa.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{sa.addEventListener("test",ha,e),sa.removeEventListener("test",ha,e)}catch(t){}return t}();function gs(t,e){this.type=t,this.currentTarget=this.target=e,this.defaultPrevented=this.Ea=!1,this.Be=!0}function vs(t,e){gs.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.fb=null,t&&this.Kf(t,e)}gs.prototype.stopPropagation=function(){this.Ea=!0},gs.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},Ta(vs,gs);var bs=ps({2:"touch",3:"pen",4:"mouse"});vs.prototype.Kf=function(t,e){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(rs){t:{try{Ya(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.offsetX=is||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=is||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==n?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=ua(t.pointerType)?t.pointerType:bs[t.pointerType]||"",this.state=t.state,this.fb=t,t.defaultPrevented&&this.preventDefault()},vs.prototype.stopPropagation=function(){vs.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},vs.prototype.preventDefault=function(){vs.L.preventDefault.call(this);var t=this.fb;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ys)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var _s="closure_listenable_"+(1e6*Math.random()|0);function ws(t){return!(!t||!t[_s])}var Es=0;function Ts(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Ob=i,this.key=++Es,this.Sa=this.Eb=!1}function Ss(t){this.src=t,this.J={},this.xb=0}function Cs(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Sa&&o.listener==e&&o.capture==!!n&&o.Ob==r)return i}return-1}Ts.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},(ia=Ss.prototype).add=function(t,e,n,r,i){var o=t.toString();(t=this.J[o])||(t=this.J[o]=[],this.xb++);var a=Cs(t,e,r,i);return-1<a?(e=t[a],n||(e.Eb=!1)):((e=new Ts(e,this.src,o,!!r,i)).Eb=n,t.push(e)),e},ia.remove=function(t,e,n,r){if(!((t=t.toString())in this.J))return!1;var i=this.J[t];return-1<(e=Cs(i,e,n,r))&&(i[e].Vb(),Array.prototype.splice.call(i,e,1),0==i.length&&(delete this.J[t],this.xb--),!0)},ia.ye=function(t){var e=t.type;e in this.J&&La(this.J[e],t)&&(t.Vb(),0==this.J[e].length&&(delete this.J[e],this.xb--))},ia.pb=function(t){var e;for(e in t=t&&t.toString(),this.J)if(!t||e==t){for(var n=this.J[e],r=0;r<n.length;r++)n[r].Vb();delete this.J[e],this.xb--}},ia.jb=function(t,e,n,r){var i=-1;return(t=this.J[t.toString()])&&(i=Cs(t,e,n,r)),-1<i?t[i]:null};var Is="closure_lm_"+(1e6*Math.random()|0),As={};function Ns(t,e,n,r,i){if(r&&r.once)return Rs(t,e,n,r,i);if(fa(e)){for(var o=0;o<e.length;o++)Ns(t,e[o],n,r,i);return null}return n=Us(n),ws(t)?t.nb(e,n,ya(r)?!!r.capture:!!r,i):Ds(t,e,n,!1,r,i)}function Ds(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=ya(i)?!!i.capture:!!i,s=Ms(t);if(s||(t[Is]=s=new Ss(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=xs,e=ds?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ms||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ks(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Rs(t,e,n,r,i){if(fa(e)){for(var o=0;o<e.length;o++)Rs(t,e[o],n,r,i);return null}return n=Us(n),ws(t)?t.Oc(e,n,ya(r)?!!r.capture:!!r,i):Ds(t,e,n,!0,r,i)}function Ps(t){if("number"!=typeof t&&t&&!t.Sa){var e=t.src;if(ws(e))e.Le(t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ks(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ms(e))?(n.ye(t),0==n.xb&&(n.src=null,e[Is]=null)):t.Vb()}}}function ks(t){return t in As?As[t]:As[t]="on"+t}function Os(t,e,n,r){var i=!0;if((t=Ms(t))&&(e=t.J[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Sa&&(o=Ls(o,r),i=i&&!1!==o)}return i}function Ls(t,e){var n=t.listener,r=t.Ob||t.src;return t.Eb&&Ps(t),n.call(r,e)}function xs(t,e){if(t.Sa)return!0;if(!ds){var n=e||ca("window.event");e=new vs(n,this);var r=!0;if(!(0>n.keyCode||null!=n.returnValue)){t:{var i=!1;if(0==n.keyCode)try{n.keyCode=-1;break t}catch(t){i=!0}(i||null==n.returnValue)&&(n.returnValue=!0)}for(n=[],i=e.currentTarget;i;i=i.parentNode)n.push(i);for(t=t.type,i=n.length-1;!e.Ea&&0<=i;i--){e.currentTarget=n[i];var o=Os(n[i],t,!0,e);r=r&&o}for(i=0;!e.Ea&&i<n.length;i++)e.currentTarget=n[i],o=Os(n[i],t,!1,e),r=r&&o}return r}return Ls(t,new vs(e,this))}function Ms(t){return(t=t[Is])instanceof Ss?t:null}var Fs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Us(t){return da(t)?t:(t[Fs]||(t[Fs]=function(e){return t.handleEvent(e)}),t[Fs])}function Vs(){Ia.call(this),this.ka=new Ss(this),this.Pe=this,this.Uc=null}Ta(Vs,Ia),Vs.prototype[_s]=!0,(ia=Vs.prototype).addEventListener=function(t,e,n,r){Ns(this,t,e,n,r)},ia.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(fa(n))for(var a=0;a<n.length;a++)t(e,n[a],r,i,o);else i=ya(i)?!!i.capture:!!i,r=Us(r),ws(e)?e.ed(n,r,i,o):e&&(e=Ms(e))&&(n=e.jb(n,r,i,o))&&Ps(n)}(this,t,e,n,r)},ia.dispatchEvent=function(t){var e,n=this.Uc;if(n)for(e=[];n;n=n.Uc)e.push(n);n=this.Pe;var r=t.type||t;if(ua(t))t=new gs(t,n);else if(t instanceof gs)t.target=t.target||n;else{var i=t;za(t=new gs(r,n),i)}if(i=!0,e)for(var o=e.length-1;!t.Ea&&0<=o;o--){var a=t.currentTarget=e[o];i=a.Lb(r,!0,t)&&i}if(t.Ea||(i=(a=t.currentTarget=n).Lb(r,!0,t)&&i,t.Ea||(i=a.Lb(r,!1,t)&&i)),e)for(o=0;!t.Ea&&o<e.length;o++)i=(a=t.currentTarget=e[o]).Lb(r,!1,t)&&i;return i},ia.F=function(){Vs.L.F.call(this),this.pg(),this.Uc=null},ia.nb=function(t,e,n,r){return this.ka.add(String(t),e,!1,n,r)},ia.Oc=function(t,e,n,r){return this.ka.add(String(t),e,!0,n,r)},ia.ed=function(t,e,n,r){this.ka.remove(String(t),e,n,r)},ia.Le=function(t){this.ka.ye(t)},ia.pg=function(){this.ka&&this.ka.pb(void 0)},ia.Lb=function(t,e,n){if(!(t=this.ka.J[String(t)]))return!0;t=t.concat();for(var r=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.Sa&&o.capture==e){var a=o.listener,s=o.Ob||o.src;o.Eb&&this.Le(o),r=!1!==a.call(s,n)&&r}}return r&&0!=n.Be},ia.jb=function(t,e,n,r){return this.ka.jb(String(t),e,n,r)};var Bs=sa.JSON.stringify;function qs(t,e){this.Sf=100,this.ef=t,this.ug=e,this.Zb=0,this.Pb=null}function js(){this.lc=this.Va=null}qs.prototype.get=function(){if(0<this.Zb){this.Zb--;var t=this.Pb;this.Pb=t.next,t.next=null}else t=this.ef();return t},qs.prototype.put=function(t){this.ug(t),this.Zb<this.Sf&&(this.Zb++,t.next=this.Pb,this.Pb=t)};var Ws,Ks,Hs=new qs(function(){return new Gs},function(t){t.reset()});function Gs(){this.next=this.scope=this.Gc=null}function $s(t){sa.setTimeout(function(){throw t},0)}js.prototype.add=function(t,e){var n=this.Af();n.set(t,e),this.lc?this.lc.next=n:this.Va=n,this.lc=n},js.prototype.remove=function(){var t=null;return this.Va&&(t=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),t.next=null),t},js.prototype.wg=function(t){Hs.put(t)},js.prototype.Af=function(){return Hs.get()},Gs.prototype.set=function(t,e){this.Gc=t,this.scope=e,this.next=null},Gs.prototype.reset=function(){this.next=this.scope=this.Gc=null};var Qs=!1,zs=new js;function Ys(){for(var t;t=zs.remove();){try{t.Gc.call(t.scope)}catch(t){$s(t)}zs.wg(t)}Qs=!1}function Xs(t,e){Vs.call(this),this.Na=t||1,this.wb=e||sa,this.nd=_a(this.Rg,this),this.ie=Ea()}function Js(t,e,n){if(da(t))n&&(t=_a(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_a(t.handleEvent,t)}return 2147483647<Number(e)?-1:sa.setTimeout(t,e||0)}function Zs(t,e,n){Ia.call(this),this.Uf=null!=n?_a(t,n):t,this.Na=e,this.Xe=_a(this.fg,this),this.qc=[]}function tu(t){Ia.call(this),this.i=t,this.o={}}Ta(Xs,Vs),(ia=Xs.prototype).enabled=!1,ia.B=null,ia.setInterval=function(t){this.Na=t,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},ia.Rg=function(){if(this.enabled){var t=Ea()-this.ie;0<t&&t<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-t):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},ia.ff=function(){this.dispatchEvent("tick")},ia.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=Ea())},ia.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},ia.F=function(){Xs.L.F.call(this),this.stop(),delete this.wb},Ta(Zs,Ia),(ia=Zs.prototype).Ta=!1,ia.ob=0,ia.B=null,ia.mf=function(t){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},ia.stop=function(){this.B&&(sa.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},ia.pause=function(){this.ob++},ia.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},ia.F=function(){Zs.L.F.call(this),this.stop()},ia.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},ia.Cc=function(){this.B=Js(this.Xe,this.Na),this.Uf.apply(null,this.qc)},Ta(tu,Ia);var eu=[];function nu(t,e,n){this.reset(t,e,n,void 0,void 0)}function ru(t){this.pe=t,this.Zd=this.uc=this.mb=this.$b=null}function iu(t,e){this.name=t,this.value=e}(ia=tu.prototype).nb=function(t,e,n,r){return this.Tf(t,e,n,r)},ia.Tf=function(t,e,n,r){fa(e)||(e&&(eu[0]=e.toString()),e=eu);for(var i=0;i<e.length;i++){var o=Ns(t,e[i],n||this.handleEvent,r||!1,this.i||this);if(!o)break;this.o[o.key]=o}return this},ia.Oc=function(t,e,n,r){return this.je(t,e,n,r)},ia.je=function(t,e,n,r,i){if(fa(e))for(var o=0;o<e.length;o++)this.je(t,e[o],n,r,i);else{if(!(t=Rs(t,e,n||this.handleEvent,r,i||this.i||this)))return this;this.o[t.key]=t}return this},ia.ed=function(t,e,n,r,i){if(fa(e))for(var o=0;o<e.length;o++)this.ed(t,e[o],n,r,i);else n=n||this.handleEvent,r=ya(r)?!!r.capture:!!r,i=i||this.i||this,n=Us(n),r=!!r,(e=ws(t)?t.jb(e,n,r,i):t&&(t=Ms(t))?t.jb(e,n,r,i):null)&&(Ps(e),delete this.o[e.key])},ia.pb=function(){Ka(this.o,function(t,e){this.o.hasOwnProperty(e)&&Ps(t)},this),this.o={}},ia.F=function(){tu.L.F.call(this),this.pb()},ia.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},nu.prototype.Md=null,nu.prototype.reset=function(t,e,n,r,i){this.mb=t,delete this.Md},nu.prototype.Bg=function(t){this.Md=t},nu.prototype.Ge=function(t){this.mb=t},iu.prototype.toString=function(){return this.name};var ou=new iu("SEVERE",1e3),au=new iu("WARNING",900),su=new iu("INFO",800),uu=new iu("CONFIG",700),cu=new iu("FINE",500);(ia=ru.prototype).getName=function(){return this.pe},ia.getParent=function(){return this.$b},ia.pf=function(){return this.uc||(this.uc={}),this.uc},ia.Ge=function(t){this.mb=t},ia.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(function(t,e){throw new Ca("Failure: "+t,Array.prototype.slice.call(arguments,1))}("Root logger has no level set."),null)},ia.Pf=function(t){return t.value>=this.Qd().value},ia.log=function(t,e,n){this.Pf(t)&&(da(e)&&(e=e()),this.gf(this.uf(t,e,n)))},ia.uf=function(t,e,n){return t=new nu(t,String(e),this.pe),n&&t.Bg(n),t},ia.ca=function(t,e){this.log(ou,t,e)},ia.T=function(t,e){this.log(au,t,e)},ia.info=function(t,e){this.log(su,t,e)},ia.lf=function(t){this.log(cu,t,void 0)},ia.gf=function(t){for(var e=this;e;)e.We(t),e=e.getParent()},ia.We=function(t){if(this.Zd)for(var e,n=0;e=this.Zd[n];n++)e(t)},ia.Fg=function(t){this.$b=t},ia.Qe=function(t,e){this.pf()[t]=e};var hu={},lu=null;function fu(t){var e;if(lu||(lu=new ru(""),hu[""]=lu,lu.Ge(uu)),!(e=hu[t])){e=new ru(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=fu(t.substr(0,n))).Qe(r,e),e.Fg(n),hu[t]=e}return e}function pu(t,e){t&&t.info(e,void 0)}function du(t,e){t&&t.lf(e)}function yu(){this.s=fu("goog.labs.net.webChannel.WebChannelDebug"),this.Wc=!0}(ia=yu.prototype).Id=function(){this.Wc=!1},ia.Tg=function(t,e,n,r,i){var o=this;this.info(function(){return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+t+"\n"+e+"\n"+o.Xf(i)})},ia.Ug=function(t,e,n,r,i,o){this.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+t+"\n"+e+"\n"+i+" "+o})},ia.Wa=function(t,e,n){var r=this;this.info(function(){return"XMLHTTP TEXT ("+t+"): "+r.ng(e)+(n?" "+n:"")})},ia.Sg=function(t){this.info(function(){return"TIMEOUT: "+t})},ia.debug=function(t){du(this.s,t)},ia.cb=function(t,e){var n=this.s;n&&n.ca(e||"Exception",t)},ia.info=function(t){pu(this.s,t)},ia.T=function(t){var e=this.s;e&&e.T(t,void 0)},ia.ca=function(t){var e=this.s;e&&e.ca(t,void 0)},ia.ng=function(t){if(!this.Wc)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(var n=0;n<e.length;n++)fa(e[n])&&this.Wf(e[n]);return Bs(e)}catch(e){return this.debug("Exception parsing expected JS array - probably was not JS"),t}},ia.Wf=function(t){if(!(2>t.length||(t=t[1],!fa(t)||1>t.length))){var e=t[0];if("noop"!=e&&"stop"!=e&&"close"!=e)for(e=1;e<t.length;e++)t[e]=""}},ia.Xf=function(t){if(!this.Wc)return t;if(!t)return null;var e="";t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].split("=");if(1<r.length){var i=r[0];r=r[1];var o=i.split("_");e=2<=o.length&&"type"==o[1]?e+(i+"=")+r+"&":e+(i+"=redacted&")}}return e};var mu=new Vs;function gu(t){gs.call(this,"serverreachability",t)}function vu(t){mu.dispatchEvent(new gu(mu,t))}function bu(t,e){gs.call(this,"statevent",t),this.stat=e}function _u(t){mu.dispatchEvent(new bu(mu,t))}function wu(t,e,n){gs.call(this,"timingevent",t),this.size=e,this.rtt=n}function Eu(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return sa.setTimeout(function(){t()},e)}Ta(gu,gs),Ta(bu,gs),Ta(wu,gs);var Tu={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},Su={Xg:"complete",kh:"success",Oe:"error",Ne:"abort",ih:"ready",jh:"readystatechange",TIMEOUT:"timeout",eh:"incrementaldata",hh:"progress",Zg:"downloadprogress",lh:"uploadprogress"};function Cu(){}function Iu(){}Cu.prototype.pd=null,Cu.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Au,Nu={OPEN:"a",Wg:"b",Oe:"c",fh:"d"};function Du(){gs.call(this,"d")}function Ru(){gs.call(this,"c")}function Pu(){}function ku(t,e,n,r,i){this.b=t,this.a=e,this.ra=n,this.R=r,this.Xc=i||1,this.Fc=new tu(this),this.Ua=Ou,t=ns?125:void 0,this.Vc=new Xs(t),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}Ta(Du,gs),Ta(Ru,gs),Ta(Pu,Cu),Pu.prototype.Dd=function(){var t=this.Wd();return t?new ActiveXObject(t):new XMLHttpRequest},Pu.prototype.Mf=function(){var t={};return this.Wd()&&(t[0]=!0,t[1]=!0),t},Pu.prototype.Wd=function(){if(!this.be&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],e=0;e<t.length;e++){var n=t[e];try{return new ActiveXObject(n),this.be=n}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return this.be},Au=new Pu;var Ou=45e3,Lu={},xu={};function Mu(t){if(t.H&&"function"==typeof t.H)return t.H();if(ua(t))return t.split("");if(pa(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Ha(t)}function Fu(t,e,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,n);else if(pa(t)||ua(t))Pa(t,e,n);else{if(t.W&&"function"==typeof t.W)var r=t.W();else if(t.H&&"function"==typeof t.H)r=void 0;else if(pa(t)||ua(t)){r=[];for(var i=t.length,o=0;o<i;o++)r.push(o)}else r=Ga(t);o=(i=Mu(t)).length;for(var a=0;a<o;a++)e.call(n,i[a],r&&r[a],t)}}function Uu(t,e){this.D={},this.o=[],this.j=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else t&&this.addAll(t)}function Vu(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ia=ku.prototype).ga=function(t){this.A=t},ia.setTimeout=function(t){this.Ua=t},ia.He=function(t){this.Ra=t},ia.Gg=function(t){this.ba=t},ia.la=function(){return this.ba},ia.kd=function(t,e){this.ic=1,this.ua=t.clone().Ub(),this.Da=e,this.yc=!0,this.Ce(null)},ia.jd=function(t,e,n){this.ic=1,this.ua=t.clone().Ub(),this.Da=null,this.yc=e,this.Ce(n)},ia.Ce=function(t){this.qb=Ea(),this.eb(),this.pa=this.ua.clone(),this.pa.dc("t",this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?t:null),0<this.Ra&&(this.ac=new Zs(_a(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,"readystatechange",this.mg),t=this.A?$a(this.A):{},this.Da?(this.Fa||(this.Fa="POST"),t["Content-Type"]="application/x-www-form-urlencoded",this.h.send(this.pa,this.Fa,this.Da,t)):(this.Fa="GET",this.h.send(this.pa,this.Fa,null,t)),vu(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},ia.mg=function(t){t=t.target;var e=this.ac;e&&3==t.ma()?(this.a.debug("Throttling readystatechange."),e.mf()):this.Me(t)},ia.Me=function(t){try{t==this.h?this.hg():this.a.T("Called back with an unexpected xmlhttp")}catch(t){if(this.a.debug("Failed call to OnXmlHttpReadyStateChanged_"),this.h&&this.h.ya()){var e=this;this.a.cb(t,function(){return"ResponseText: "+e.h.ya()})}else this.a.cb(t,"No response text")}},ia.hg=function(){var t=this.h.ma(),e=this.h.Ud(),n=this.h.za();if(!(3>t||3==t&&!ns&&!this.h.ya())){this.Za||4!=t||7==e||vu(8==e||0>=n?3:2),this.Fb();var r=this.h.za();if(this.w=r,!(e=this.h.ya())){var i=this;this.a.debug(function(){return"No response text for uri "+i.pa+" status "+r})}if(this.S=200==r,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,t,r),this.S){if(this.Ig()){if(!(n=this.sf()))return this.S=!1,this.I=3,_u(12),this.a.T("XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ("+this.R+")"),this.Ia(),void this.Kb();this.a.Wa(this.R,n,"Initial handshake response via X-HTTP-Initial-Response"),this.lb=!0,this.Yc(n)}this.yc?(this.Fd(t,e),ns&&this.S&&3==t&&this.Ng()):(this.a.Wa(this.R,e,null),this.Yc(e)),4==t&&this.Ia(),this.S&&!this.Za&&(4==t?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==r&&0<e.indexOf("Unknown SID")?(this.I=3,_u(12),this.a.T("XMLHTTP Unknown SID ("+this.R+")")):(this.I=0,_u(13),this.a.T("XMLHTTP Bad status "+r+" ("+this.R+")")),this.Ia(),this.Kb()}},ia.Ig=function(){return this.Ed&&!this.lb},ia.sf=function(){if(this.h){var t=this.h.kb("X-HTTP-Initial-Response");if(t&&!Fa(t))return t}return null},ia.Ag=function(){this.Ed=!0},ia.Fd=function(t,e){for(var n=!0;!this.Za&&this.Bb<e.length;){var r=this.vf(e);if(r==xu){4==t&&(this.I=4,_u(14),n=!1),this.a.Wa(this.R,null,"[Incomplete Response]");break}if(r==Lu){this.I=4,_u(15),this.a.Wa(this.R,e,"[Invalid Chunk]"),n=!1;break}this.a.Wa(this.R,r,null),this.Yc(r)}4==t&&0==e.length&&(this.I=1,_u(16),n=!1),this.S=this.S&&n,n||(this.a.Wa(this.R,e,"[Invalid Chunked Response]"),this.Ia(),this.Kb())},ia.kg=function(){if(this.h){var t=this.h.ma(),e=this.h.ya();this.Bb<e.length&&(this.Fb(),this.Fd(t,e),this.S&&4!=t&&this.eb())}},ia.Ng=function(){this.Fc.nb(this.Vc,"tick",this.kg),this.Vc.start()},ia.vf=function(t){var e=this.Bb,n=t.indexOf("\n",e);return-1==n?xu:(e=Number(t.substring(e,n)),isNaN(e)?Lu:(n+=1)+e>t.length?xu:(t=t.substr(n,e),this.Bb=n+e,t))},ia.yg=function(t){this.ic=2,this.ua=t.clone().Ub(),t=!1,sa.navigator&&sa.navigator.sendBeacon&&(t=sa.navigator.sendBeacon(this.ua.toString(),"")),!t&&sa.Image&&((new Image).src=this.ua,t=!0),t||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=Ea(),this.eb()},ia.cancel=function(){this.Za=!0,this.Ia()},ia.tg=function(t){t&&this.setTimeout(t),this.Ga&&(this.Fb(),this.eb())},ia.eb=function(){this.hd=Ea()+this.Ua,this.Ke(this.Ua)},ia.Ke=function(t){if(null!=this.Ga)throw Error("WatchDog timer not null");this.Ga=Eu(_a(this.gg,this),t)},ia.Fb=function(){this.Ga&&(sa.clearTimeout(this.Ga),this.Ga=null)},ia.gg=function(){this.Ga=null;var t=Ea();0<=t-this.hd?this.Df():(this.a.T("WatchDog timer called too early"),this.Ke(this.hd-t))},ia.Df=function(){this.S&&this.a.ca("Received watchdog timeout even though request loaded successfully"),this.a.Sg(this.pa),2!=this.ic&&(vu(3),_u(17)),this.Ia(),this.I=2,this.Kb()},ia.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},ia.Ia=function(){this.Fb();var t=this.ac;t&&"function"==typeof t.bb&&t.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(t=this.h,this.h=null,t.abort(),t.bb())},ia.Hc=function(){return this.I},ia.Yc=function(t){try{this.b.ue(this,t),vu(4)}catch(t){this.a.cb(t,"Error in httprequest callback")}},(ia=Uu.prototype).C=function(){return this.j},ia.H=function(){this.wc();for(var t=[],e=0;e<this.o.length;e++)t.push(this.D[this.o[e]]);return t},ia.W=function(){return this.wc(),this.o.concat()},ia.va=function(t){return Vu(this.D,t)},ia.X=function(){return 0==this.j},ia.clear=function(){this.D={},this.j=this.o.length=0},ia.remove=function(t){return!!Vu(this.D,t)&&(delete this.D[t],this.j--,this.o.length>2*this.j&&this.wc(),!0)},ia.wc=function(){if(this.j!=this.o.length){for(var t=0,e=0;t<this.o.length;){var n=this.o[t];Vu(this.D,n)&&(this.o[e++]=n),t++}this.o.length=e}if(this.j!=this.o.length){var r={};for(e=t=0;t<this.o.length;)Vu(r,n=this.o[t])||(this.o[e++]=n,r[n]=1),t++;this.o.length=e}},ia.get=function(t,e){return Vu(this.D,t)?this.D[t]:e},ia.set=function(t,e){Vu(this.D,t)||(this.j++,this.o.push(t)),this.D[t]=e},ia.addAll=function(t){if(t instanceof Uu)for(var e=t.W(),n=0;n<e.length;n++)this.set(e[n],t.get(e[n]));else for(e in t)this.set(e,t[e])},ia.forEach=function(t,e){for(var n=this.W(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}},ia.clone=function(){return new Uu(this)};var Bu=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function qu(t,e){var n;this.xa=this.zb=this.qa="",this.Ca=null,this.ib=this.K="",this.O=this.Qf=!1,t instanceof qu?(this.O=void 0!==e?e:t.O,this.tb(t.qa),this.cd(t.zb),this.rb(t.xa),this.sb(t.Ca),this.ec(t.K),this.bd(t.P.clone()),this.$c(t.ib)):t&&(n=String(t).match(Bu))?(this.O=!!e,this.tb(n[1]||"",!0),this.cd(n[2]||"",!0),this.rb(n[3]||"",!0),this.sb(n[4]),this.ec(n[5]||"",!0),this.bd(n[6]||"",!0),this.$c(n[7]||"",!0)):(this.O=!!e,this.P=new Yu(null,this.O))}function ju(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wu(t,e,n){return ua(t)?(t=encodeURI(t).replace(e,Ku),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ku(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}(ia=qu.prototype).toString=function(){var t=[],e=this.qa;e&&t.push(Wu(e,Hu,!0),":");var n=this.xa;return(n||"file"==e)&&(t.push("//"),(e=this.zb)&&t.push(Wu(e,Hu,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.Ca)&&t.push(":",String(n))),(n=this.K)&&(this.Ic()&&"/"!=n.charAt(0)&&t.push("/"),t.push(Wu(n,"/"==n.charAt(0)?$u:Gu,!0))),(n=this.Rd())&&t.push("?",n),(n=this.ib)&&t.push("#",Wu(n,zu)),t.join("")},ia.resolve=function(t){var e=this.clone(),n=t.Hf();n?e.tb(t.qa):n=t.If(),n?e.cd(t.zb):n=t.Ic(),n?e.rb(t.xa):n=t.Ff();var r=t.K;if(n)e.sb(t.Ca);else if(n=t.ae()){if("/"!=r.charAt(0))if(this.Ic()&&!this.ae())r="/"+r;else{var i=e.K.lastIndexOf("/");-1!=i&&(r=e.K.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.ec(r):n=t.Gf(),n?e.bd(t.P.clone()):n=t.Ef(),n&&e.$c(t.ib),e},ia.clone=function(){return new qu(this)},ia.tb=function(t,e){this.U(),(this.qa=e?ju(t,!0):t)&&(this.qa=this.qa.replace(/:$/,""))},ia.Hf=function(){return!!this.qa},ia.cd=function(t,e){this.U(),this.zb=e?ju(t):t},ia.If=function(){return!!this.zb},ia.rb=function(t,e){this.U(),this.xa=e?ju(t,!0):t},ia.Ic=function(){return!!this.xa},ia.sb=function(t){if(this.U(),t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);this.Ca=t}else this.Ca=null},ia.Ff=function(){return null!=this.Ca},ia.ec=function(t,e){this.U(),this.K=e?ju(t,!0):t},ia.ae=function(){return!!this.K},ia.Gf=function(){return""!==this.P.toString()},ia.bd=function(t,e){this.U(),t instanceof Yu?(this.P=t,this.P.ad(this.O)):(e||(t=Wu(t,Qu)),this.P=new Yu(t,this.O))},ia.Rd=function(){return this.P.toString()},ia.getQuery=function(){return this.Rd()},ia.l=function(t,e){this.U(),this.P.set(t,e)},ia.dc=function(t,e){this.U(),fa(e)||(e=[String(e)]),this.P.Ie(t,e)},ia.$c=function(t,e){this.U(),this.ib=e?ju(t):t},ia.Ef=function(){return!!this.ib},ia.Ub=function(){return this.U(),this.l("zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Ea()).toString(36)),this},ia.removeParameter=function(t){return this.U(),this.P.remove(t),this},ia.U=function(){if(this.Qf)throw Error("Tried to modify a read-only Uri")},ia.ad=function(t){this.O=t,this.P&&this.P.ad(t)};var Hu=/[#\/\?@]/g,Gu=/[#\?:]/g,$u=/[#\?]/g,Qu=/[#\?@]/g,zu=/#/g;function Yu(t,e){this.j=this.m=null,this.ja=t||null,this.O=!!e}function Xu(t,e){this.b=t,this.a=e,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function Ju(t){this.D=new Uu,t&&this.addAll(t)}function Zu(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[ma]||(t[ma]=++ga)):e.substr(0,1)+t}function tc(t){this.me=t||ec,t=sa.PerformanceNavigationTiming?0<(t=sa.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(sa.vc&&sa.vc.ke&&sa.vc.ke()&&sa.vc.ke().nh),this.Xb=t?this.me:1,this.v=null,1<this.Xb&&(this.v=new Ju),this.f=null,this.ba=[]}(ia=Yu.prototype).$=function(){if(!this.m&&(this.m=new Uu,this.j=0,this.ja)){var t=this;!function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(this.ja,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})}},ia.C=function(){return this.$(),this.j},ia.add=function(t,e){this.$(),this.Oa(),t=this.Ma(t);var n=this.m.get(t);return n||this.m.set(t,n=[]),n.push(e),this.j+=1,this},ia.remove=function(t){return this.$(),t=this.Ma(t),!!this.m.va(t)&&(this.Oa(),this.j-=this.m.get(t).length,this.m.remove(t))},ia.clear=function(){this.Oa(),this.m=null,this.j=0},ia.X=function(){return this.$(),0==this.j},ia.va=function(t){return this.$(),t=this.Ma(t),this.m.va(t)},ia.forEach=function(t,e){this.$(),this.m.forEach(function(n,r){Pa(n,function(n){t.call(e,n,r,this)},this)},this)},ia.W=function(){this.$();for(var t=this.m.H(),e=this.m.W(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ia.H=function(t){this.$();var e=[];if(ua(t))this.va(t)&&(e=xa(e,this.m.get(this.Ma(t))));else{t=this.m.H();for(var n=0;n<t.length;n++)e=xa(e,t[n])}return e},ia.set=function(t,e){return this.$(),this.Oa(),t=this.Ma(t),this.va(t)&&(this.j-=this.m.get(t).length),this.m.set(t,[e]),this.j+=1,this},ia.get=function(t,e){return t&&0<(t=this.H(t)).length?String(t[0]):e},ia.Ie=function(t,e){this.remove(t),0<e.length&&(this.Oa(),this.m.set(this.Ma(t),Ma(e)),this.j+=e.length)},ia.toString=function(){if(this.ja)return this.ja;if(!this.m)return"";for(var t=[],e=this.m.W(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.H(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.ja=t.join("&")},ia.Oa=function(){this.ja=null},ia.clone=function(){var t=new Yu;return t.ja=this.ja,this.m&&(t.m=this.m.clone(),t.j=this.j),t},ia.Ma=function(t){return t=String(t),this.O&&(t=t.toLowerCase()),t},ia.ad=function(t){t&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(this.remove(e),this.Ie(n,t))},this)),this.O=t},ia.extend=function(t){for(var e=0;e<arguments.length;e++)Fu(arguments[e],function(t,e){this.add(e,t)},this)},Ta(function(){},function(){}),(ia=Xu.prototype).g=null,ia.ga=function(t){this.A=t},ia.connect=function(t){this.K=t,t=this.b.Sd(this.K),_u(3);var e=this.b.Ib.$d;null!=e?(this.na=this.b.$a(e[0]),this.g=1,this.xd()):(t.dc("MODE","init"),!this.b.ta&&this.b.aa&&t.dc("X-HTTP-Session-Id",this.b.aa),this.f=new ku(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(t,!1,null),this.g=0)},ia.xd=function(){this.a.debug("TestConnection: starting stage 2");var t=this.b.Ib.od;if(null!=t)this.a.debug(function(){return"Buffered"}),_u(4),t?(_u(10),this.b.ub(this,!1)):(_u(11),this.b.ub(this,!0));else{this.f=new ku(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var e=this.b.Pd(this.na,this.K);_u(4),e.dc("TYPE","xmlhttp");var n=this.b.aa,r=this.b.Kc;n&&r&&e.l(n,r),this.f.jd(e,!1,this.na)}},ia.Jb=function(t){return this.b.Jb(t)},ia.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},ia.de=function(){return!1},ia.ue=function(t,e){if(this.w=t.w,0==this.g)if(this.a.debug("TestConnection: Got data for stage 1"),this.pc(t),e){try{var n=this.b.kc.zc(e)}catch(t){return this.a.cb(t),void this.b.dd(this)}this.na=this.b.$a(n[0])}else this.a.debug("TestConnection: Null responseText"),this.b.dd(this);else 1==this.g&&(this.bc?_u(6):"11111"==e?(_u(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug("Test connection succeeded; using streaming connection"),_u(11),this.b.ub(this,!0))):(_u(7),this.bc=!1))},ia.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug("TestConnection: request complete for initial check"),this.xd()):1==this.g&&(this.a.debug("TestConnection: request complete for stage 2"),this.bc?(this.a.debug("Test connection succeeded; using streaming connection"),_u(11),this.b.ub(this,!0)):(this.a.debug("Test connection failed; not using streaming"),_u(10),this.b.ub(this,!1))):(this.a.debug("TestConnection: request failed, in state "+this.g),0==this.g?_u(8):1==this.g&&_u(9),this.b.dd(this))},ia.pc=function(t){if(!this.b.ta&&(t=t.h)){var e=t.kb("X-Client-Wire-Protocol");this.Ad=e||null,this.b.aa&&((t=t.kb("X-HTTP-Session-Id"))?this.b.Fe(t):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},ia.fc=function(){return this.b.fc()},ia.Ba=function(){return this.b.Ba()},ia.Ze=function(){return!ts||10<=Number(cs)},(ia=Ju.prototype).C=function(){return this.D.C()},ia.add=function(t){this.D.set(Zu(t),t)},ia.addAll=function(t){for(var e=(t=Mu(t)).length,n=0;n<e;n++)this.add(t[n])},ia.pb=function(t){for(var e=(t=Mu(t)).length,n=0;n<e;n++)this.remove(t[n])},ia.remove=function(t){return this.D.remove(Zu(t))},ia.clear=function(){this.D.clear()},ia.X=function(){return this.D.X()},ia.contains=function(t){return this.D.va(Zu(t))},ia.H=function(){return this.D.H()},ia.clone=function(){return new Ju(this)};var ec=10;function nc(){this.xg=this.rg=void 0}function rc(){this.jg=new nc}function ic(t,e,n,r,i){try{t.debug(n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){t.cb(e)}}(ia=tc.prototype).ld=function(t){this.v||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(this.Xb=this.me,this.v=new Ju,this.f&&(this.oc(this.f),this.f=null))},ia.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},ia.xf=function(){return this.f?1:this.v?this.v.C():0},ia.Jc=function(t){return this.f?this.f==t:!!this.v&&this.v.contains(t)},ia.oc=function(t){this.v?this.v.add(t):this.f=t},ia.ze=function(t){this.f&&this.f==t?this.f=null:this.v&&this.v.contains(t)&&this.v.remove(t)},ia.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(Pa(this.v.H(),function(t){t.cancel()}),this.v.clear())},ia.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var t=this.ba;return Pa(this.v.H(),function(e){t=t.concat(e.la())}),t}return Ma(this.ba)},ia.Re=function(t){this.ba=this.ba.concat(t)},ia.$e=function(){this.ba.length=0},nc.prototype.stringify=function(t){return sa.JSON.stringify(t,this.rg)},nc.prototype.parse=function(t){return sa.JSON.parse(t,this.xg)},rc.prototype.hf=function(t,e,n){var r=n||"";try{Fu(t,function(t,n){var i=t;ya(t)&&(i=Bs(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}},rc.prototype.jf=function(t,e,n){for(var r=-1;;){var i=["count="+e];-1==r?0<e?(r=t[0].Pc,i.push("ofs="+r)):r=0:i.push("ofs="+r);for(var o=!0,a=0;a<e;a++){var s=t[a].Pc,u=t[a].map;if(0>(s-=r))r=Math.max(0,t[a].Pc-100),o=!1;else try{this.hf(u,i,"req"+s+"_")}catch(t){n&&n(u)}}if(o)return i.join("&")}},rc.prototype.zc=function(t){return this.jg.parse(t)};var oc=sa.JSON.parse;function ac(t){Vs.call(this),this.headers=new Uu,this.Xa=t||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb="",this.Pa=0,this.I="",this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=sc,this.jc=this.lg=this.Ab=!1}Ta(ac,Vs);var sc="";ac.prototype.s=fu("goog.net.XhrIo");var uc=/^https?$/i,cc=["POST","PUT"];function hc(t){return"content-type"==t.toLowerCase()}function lc(t,e){return{type:e,lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total}}function fc(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return Ka(n,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(),ua(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return t.l(e,n),t}function pc(t){this.Bd=22,this.De=0,this.M=[],this.a=new yu,this.Ib=new function(){this.od=this.$d=null},this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!ca("internalChannelParams.failFast",t),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=ca("internalChannelParams.baseRetryDelayMs",t)||5e3,this.vg=ca("internalChannelParams.retryDelaySeedMs",t)||1e4,this.nf=ca("internalChannelParams.forwardChannelMaxRetries",t)||2,this.Od=ca("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Xa=t&&t.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=t&&t.supportsCrossDomainXhr||!1,this.ra="",this.G=new tc(t&&t.concurrentRequestLimit),this.kc=new rc,this.ta=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.Nd=t&&t.fastHandshake||!1)&&!this.ta&&(this.a.T("Force backgroundChannelTest when fastHandshake is enabled."),this.ta=!0),t&&t.Id&&this.a.Id()}function dc(){}function yc(){if(ts&&!(10<=Number(cs)))throw Error("Environmental error: no available transport.")}function mc(t,e){Vs.call(this),this.b=new pc(e),this.yb=t,this.Qg=e&&e.testUrl?e.testUrl:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?e=i:((r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e=r?e+i:e+"/"+i)}return e}(this.yb,"test"),this.s=fu("goog.labs.net.webChannel.WebChannelBaseTransport"),this.Rc=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.b.ga(t),t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.zd&&(t?t["X-WebChannel-Client-Profile"]=e.zd:t={"X-WebChannel-Client-Profile":e.zd}),this.b.Eg(t),(t=e&&e.httpHeadersOverwriteParam)&&!Fa(t)&&this.b.Cg(t),this.Og=e&&e.supportsCrossDomainXhr||!1,this.zg=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Fa(e)&&(this.b.Dg(e),null!==(t=this.Rc)&&e in t&&(e in(t=this.Rc)&&delete t[e],(t=this.s)&&t.T("Ignore httpSessionIdParam also specified with messageUrlParams: "+e,void 0))),this.vd=new bc(this)}function gc(t){Du.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.ne=t)&&(t=this.ne,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function vc(t){Ru.call(this),this.status=1,this.errorCode=t}function bc(t){this.b=t}(ia=ac.prototype).Je=function(t){this.Ab=t},ia.send=function(t,e,n,r){if(this.c)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Tb+"; newUri="+t);e=e?e.toUpperCase():"GET",this.Tb=t,this.I="",this.Pa=0,this.ge=e,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():Au.Vd(),this.c.onreadystatechange=_a(this.te,this),this.lg&&"onprogress"in this.c&&(this.c.onprogress=_a(function(t){this.re(t,!0)},this),this.c.upload&&(this.c.upload.onprogress=_a(this.re,this)));try{du(this.s,this.da("Opening Xhr")),this.Lc=!0,this.c.open(e,String(t),!0),this.Lc=!1}catch(t){return du(this.s,this.da("Error opening Xhr: "+t.message)),void this.Ld(t)}t=n||"";var i=this.headers.clone();r&&Fu(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=hc,n=t.length,r=ua(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:ua(t)?t.charAt(e):t[e]}(i.W()),n=sa.FormData&&t instanceof sa.FormData,!(0<=Da(cc,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.c.setRequestHeader(e,t)},this),this.Ae&&(this.c.responseType=this.Ae),"withCredentials"in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=function(t){return ts&&ls(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.c),du(this.s,this.da("Will abort after "+this.vb+"ms if incomplete, xhr2 "+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=_a(this.Ua,this)):this.hc=Js(this.Ua,this.vb,this)),du(this.s,this.da("Sending request")),this.Qb=!0,this.c.send(t),this.Qb=!1}catch(t){du(this.s,this.da("Send error: "+t.message)),this.Ld(t)}},ia.df=function(){return this.Xa?this.Xa.Dd():Au.Dd()},ia.Ua=function(){void 0!==aa&&this.c&&(this.I="Timed out after "+this.vb+"ms, aborting",this.Pa=8,du(this.s,this.da(this.I)),this.dispatchEvent("timeout"),this.abort(8))},ia.Ld=function(t){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=t,this.Pa=5,this.Jd(),this.Gb()},ia.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent("complete"),this.dispatchEvent("error"))},ia.abort=function(t){this.c&&this.ha&&(du(this.s,this.da("Aborting")),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),this.Gb())},ia.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),ac.L.F.call(this)},ia.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},ia.eg=function(){this.se()},ia.se=function(){if(this.ha&&void 0!==aa)if(this.mc[1]&&4==this.ma()&&2==this.za())du(this.s,this.da("Local request error detected and ignored"));else if(this.Qb&&4==this.ma())Js(this.te,0,this);else if(this.dispatchEvent("readystatechange"),this.Mc()){du(this.s,this.da("Request complete")),this.ha=!1;try{this.Rf()?(this.dispatchEvent("complete"),this.dispatchEvent("success")):(this.Pa=6,this.I=this.Yd()+" ["+this.za()+"]",this.Jd())}finally{this.Gb()}}},ia.re=function(t,e){this.dispatchEvent(lc(t,"progress")),this.dispatchEvent(lc(t,e?"downloadprogress":"uploadprogress"))},ia.Gb=function(t){if(this.c){this.yd();var e=this.c,n=this.mc[0]?ha:null;this.mc=this.c=null,t||this.dispatchEvent("ready");try{e.onreadystatechange=n}catch(e){(t=this.s)&&t.ca("Problem encountered resetting onreadystatechange: "+e.message,void 0)}}},ia.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(sa.clearTimeout(this.hc),this.hc=null)},ia.Ba=function(){return!!this.c},ia.Mc=function(){return 4==this.ma()},ia.Rf=function(){var t=this.za();t:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}return e||0===t&&!this.Of()},ia.Of=function(){var t=String(this.Tb).match(Bu)[1]||null;return!t&&sa.self&&sa.self.location&&(t=(t=sa.self.location.protocol).substr(0,t.length-1)),uc.test(t?t.toLowerCase():"")},ia.ma=function(){return this.c?this.c.readyState:0},ia.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(t){return-1}},ia.Yd=function(){try{return 2<this.ma()?this.c.statusText:""}catch(t){return du(this.s,"Can not get status: "+t.message),""}},ia.ya=function(){try{return this.c?this.c.responseText:""}catch(t){return du(this.s,"Can not get responseText: "+t.message),""}},ia.yf=function(t){if(this.c){var e=this.c.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),oc(e)}},ia.getResponseHeader=function(t){if(this.c&&this.Mc())return null===(t=this.c.getResponseHeader(t))?void 0:t},ia.getAllResponseHeaders=function(){return this.c&&this.Mc()&&this.c.getAllResponseHeaders()||""},ia.kb=function(t){return this.c?this.c.getResponseHeader(t):null},ia.Ud=function(){return this.Pa},ia.Hc=function(){return ua(this.I)?this.I:String(this.I)},ia.da=function(t){return t+" ["+this.ge+" "+this.Tb+" "+this.za()+"]"},(ia=pc.prototype).tc=8,ia.g=1,ia.connect=function(t,e,n,r,i){this.a.debug("connect()"),_u(0),this.K=e,this.gb=n||{},r&&void 0!==i&&(this.gb.OSID=r,this.gb.OAID=i),this.ta&&(this.a.debug("connect() bypassed channel-test."),this.Ib.$d=[],this.Ib.od=!1),this.bf(t)},ia.disconnect=function(){if(this.a.debug("disconnect()"),this.qd(),3==this.g){var t=this.Yb++,e=this.hb.clone();e.l("SID",this.ra),e.l("RID",t),e.l("TYPE","terminate"),this.Ya(e),new ku(this,this.a,this.ra,t,void 0).yg(e)}this.qe()},ia.bf=function(t){this.a.debug("connectTest_()"),this.Ja=new Xu(this,this.a),null===this.N&&this.Ja.ga(this.A);var e=t;this.N&&this.A&&(e=fc(t,this.N,this.A)),this.Ja.connect(e)},ia.af=function(){this.a.debug("connectChannel_()"),this.hb=this.Sd(this.K),this.Dc()},ia.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(sa.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(sa.clearTimeout(this.ea),this.ea=null)},ia.ga=function(t){this.A=t},ia.Eg=function(t){this.Rb=t},ia.Cg=function(t){this.N=t},ia.Dg=function(t){this.aa=t},ia.Fe=function(t){this.Kc=t},ia.He=function(t){this.Ra=t},ia.Hg=function(){this.gc=!0},ia.Ee=function(t){this.i=t},ia.Nf=function(){return!this.fd},ia.Zc=function(t){1e3==this.M.length&&this.a.ca(function(){return"Already have 1000 queued maps upon queueing "+Bs(t)}),this.M.push(new function(t,e){this.Pc=t,this.map=e,this.context=null}(this.ag++,t)),3==this.g&&this.Dc()},ia.qf=function(){return this.kf?0:this.nf},ia.de=function(){return 0==this.g},ia.getState=function(){return this.g},ia.Dc=function(){this.G.ee()||this.ea||(this.ea=Eu(_a(this.we,this),0),this.La=0)},ia.Yf=function(t){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca("Unexpected retry request is scheduled."),!1):this.ea?(this.a.debug("Use the retry request that is already scheduled."),this.M=t.la().concat(this.M),!0):!(1==this.g||2==this.g||this.La>=this.qf()||(this.a.debug("Going to retry POST"),this.ea=Eu(_a(this.we,this,t),this.Xd(this.La)),this.La++,0))},ia.we=function(t){this.ea=null,this.Mg(t)},ia.Mg=function(t){this.a.debug("startForwardChannel_"),1==this.g?t?this.a.ca("Not supposed to retry the open"):(this.ig(),this.g=2):3==this.g&&(t?this.le(t):0==this.M.length?this.a.debug("startForwardChannel_ returned: nothing to send"):this.G.ee()?this.a.ca("startForwardChannel_ returned: connection already in progress"):(this.le(),this.a.debug("startForwardChannel_ finished, sent request")))},ia.ig=function(){this.a.debug("open_()"),this.Yb=Math.floor(1e5*Math.random());var t=this.Yb++,e=new ku(this,this.a,"",t,void 0),n=this.A;this.Rb&&(n?za(n=$a(n),this.Rb):n=this.Rb),null===this.N&&e.ga(n);var r=this.Hd(e),i=this.hb.clone();i.l("RID",t),0<this.Bd&&i.l("CVER",this.Bd),this.ta&&this.aa&&i.l("X-HTTP-Session-Id",this.aa),this.Ya(i),this.N&&n&&fc(i,this.N,n),this.G.oc(e),this.Nd?(i.l("$req",r),i.l("SID","null"),e.Ag(),e.kd(i,null)):e.kd(i,r)},ia.le=function(t){var e=t?t.R:this.Yb++,n=this.hb.clone();n.l("SID",this.ra),n.l("RID",e),n.l("AID",this.Sb),this.Ya(n),this.N&&this.A&&fc(n,this.N,this.A),e=new ku(this,this.a,this.ra,e,this.La+1),null===this.N&&e.ga(this.A),t&&this.sg(t),t=this.Hd(e),e.setTimeout(Math.round(.5*this.Od)+Math.round(.5*this.Od*Math.random())),this.G.oc(e),e.kd(n,t)},ia.Ya=function(t){this.i&&Fu({},function(e,n){t.l(n,e)})},ia.Hd=function(t){var e=Math.min(this.M.length,1e3),n=this.i?_a(this.i.Ue,this.i,this):null;return n=this.kc.jf(this.M,e,n),t.Gg(this.M.splice(0,e)),n},ia.sg=function(t){this.M=t.la().concat(this.M)},ia.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var t=this.ve;Ks||function(){if(sa.Promise&&sa.Promise.resolve){var t=sa.Promise.resolve(void 0);Ks=function(){t.then(Ys)}}else Ks=function(){var t=Ys;!da(sa.setImmediate)||sa.Window&&sa.Window.prototype&&!Wa("Edge")&&sa.Window.prototype.setImmediate==sa.setImmediate?(Ws||(Ws=function(){var t=sa.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!Wa("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_a(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!Wa("Trident")&&!Wa("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).rd;n.rd=null,t()}},function(t){r.next={rd:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){sa.setTimeout(t,0)}}()),Ws(t)):sa.setImmediate(t)}}(),Qs||(Ks(),Qs=!0),zs.add(t,this),this.Ha=0}},ia.Qc=function(){return this.u||this.ia?(this.a.ca("Request already in progress"),!1):!(3<=this.Ha||(this.a.debug("Going to retry GET"),this.rc++,this.ia=Eu(_a(this.ve,this),this.Xd(this.Ha)),this.Ha++,0))},ia.ve=function(){this.ia=null,this.Kg()},ia.Kg=function(){this.a.debug("Creating new HttpRequest"),this.u=new ku(this,this.a,this.ra,"rpc",this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var t=this.md.clone();t.l("RID","rpc"),t.l("SID",this.ra),t.l("CI",this.fd?"0":"1"),t.l("AID",this.Sb),this.Ya(t),t.l("TYPE","xmlhttp"),this.N&&this.A&&fc(t,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(t,!0,this.na),this.a.debug("New Request created")},ia.ub=function(t,e){this.a.debug("Test Connection Finished");var n=t.Ad;n&&this.G.ld(n),this.fd=this.Se&&e,this.w=t.w,this.af()},ia.dd=function(t){this.a.debug("Test Connection Failed"),this.w=t.w,this.sa(2)},ia.ue=function(t,e){if(0!=this.g&&(this.u==t||this.G.Jc(t)))if(this.w=t.w,!t.lb&&this.G.Jc(t)&&3==this.g){try{var n=this.kc.zc(e)}catch(t){n=null}fa(n)&&3==n.length?this.Cf(n,t):(this.a.debug("Bad POST response data returned"),this.sa(11))}else(t.lb||this.u==t)&&this.Hb(),Fa(e)||(n=this.kc.zc(e),this.dg(n,t))},ia.Cf=function(t,e){0==t[0]?this.Bf(e):(this.he=t[1],0<(e=this.he-this.Sb)&&(t=t[2],this.a.debug(t+" bytes (in "+e+" arrays) are outstanding on the BackChannel"),this.Jg(t)&&!this.wa&&(this.wa=Eu(_a(this.bg,this),6e3))))},ia.Bf=function(t){if(this.a.debug("Server claims our backchannel is missing."),this.ia)this.a.debug("But we are currently starting the request.");else{if(this.u){if(!(this.u.qb+3e3<t.qb))return;this.Hb(),this.u.cancel(),this.u=null}else this.a.T("We do not have a BackChannel established");this.Qc(),_u(18)}},ia.Jg=function(t){return 37500>t&&!this.Nf()&&0==this.Ha},ia.$a=function(t){return this.Te?this.i?this.i.$a(t):t:null},ia.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),_u(19))},ia.Hb=function(){null!=this.wa&&(sa.clearTimeout(this.wa),this.wa=null)},ia.Tc=function(t){this.a.debug("Request complete");var e=null;if(this.u==t){this.Hb(),this.u=null;var n=2}else{if(!this.G.Jc(t))return;e=t.la(),this.G.ze(t),n=1}if(this.w=t.w,0!=this.g)if(t.S)1==n?(function(t,e,n){mu.dispatchEvent(new wu(mu,t,e,n))}(t.Da?t.Da.length:0,Ea()-t.qb,this.La),this.Dc()):this.Kd();else{var r=t.Hc();if(3==r||0==r&&0<this.w)this.a.debug("Not retrying due to error type");else{var i=this;if(this.a.debug(function(){return"Maybe retrying, last error: "+function(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}(r,i.w)}),1==n&&this.Yf(t)||2==n&&this.Qc())return;this.a.debug("Exceeded max number of retries")}switch(e&&0<e.length&&this.G.Re(e),this.a.debug("Error: HTTP request failed"),r){case 1:this.sa(5);break;case 4:this.sa(10);break;case 3:this.sa(6);break;default:this.sa(2)}}},ia.Xd=function(t){var e=this.Ve+Math.floor(Math.random()*this.vg);return this.Ba()||(this.a.debug("Inactive channel"),e*=2),e*t},ia.pc=function(t){if(this.ta&&(t=t.h)){var e=t.kb("X-Client-Wire-Protocol");e&&this.G.ld(e),this.aa&&((t=t.kb("X-HTTP-Session-Id"))?(this.Fe(t),this.hb.l(this.aa,t)):this.a.T("Missing X_HTTP_SESSION_ID in the handshake response"))}},ia.dg=function(t,e){for(var n=this.i&&this.i.sc?[]:null,r=0;r<t.length;r++){var i=t[r];if(this.Sb=i[0],i=i[1],2==this.g)if("c"==i[0]){this.ra=i[1],this.na=this.$a(i[2]);var o=i[3];null!=o&&(this.tc=o,this.a.info("VER="+this.tc)),null!=(o=i[4])&&(this.De=o,this.a.info("SVER="+this.De)),null!=(i=i[5])&&"number"==typeof i&&0<i&&(this.Db=i*=1.5,this.a.info("backChannelRequestTimeoutMs_="+i)),this.pc(e),this.g=3,this.i&&this.i.wd(),this.Lg(e)}else"stop"!=i[0]&&"close"!=i[0]||this.sa(7);else 3==this.g&&("stop"==i[0]||"close"==i[0]?(n&&0!=n.length&&(this.i.sc(this,n),n.length=0),"stop"==i[0]?this.sa(7):this.disconnect()):"noop"!=i[0]&&(n?n.push(i):this.i&&this.i.ud(i)),this.Ha=0)}n&&0!=n.length&&this.i.sc(this,n)},ia.Lg=function(t){this.md=this.Pd(this.na,this.K),t.lb?(this.a.debug("Upgrade the handshake request to a backchannel."),this.G.ze(t),t.tg(this.Db),this.u=t):this.Kd()},ia.sa=function(t){if(this.a.info("Error code "+t),2==t){var e=null;this.i&&(e=null);var n=_a(this.Pg,this);e||(e=new qu("//www.google.com/images/cleardot.gif"),sa.location&&"http"==sa.location.protocol||e.tb("https"),e.Ub()),function(t,e){var n=new yu;n.debug("TestLoadImage: loading "+t);var r=new Image;r.onload=wa(ic,n,r,"TestLoadImage: loaded",!0,e),r.onerror=wa(ic,n,r,"TestLoadImage: error",!1,e),r.onabort=wa(ic,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=wa(ic,n,r,"TestLoadImage: timeout",!1,e),sa.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}(e.toString(),n)}else _u(2);this.cg(t)},ia.Pg=function(t){t?(this.a.info("Successfully pinged google.com"),_u(2)):(this.a.info("Failed to ping google.com"),_u(1))},ia.cg=function(t){this.a.debug("HttpChannel: error - "+t),this.g=0,this.i&&this.i.td(t),this.qe(),this.qd()},ia.qe=function(){if(this.g=0,this.w=-1,this.i){var t=this.G.la();if(0!=t.length||0!=this.M.length){var e=this;this.a.debug(function(){return"Number of undelivered maps, pending: "+t.length+", outgoing: "+e.M.length}),this.G.$e(),Ma(this.M),this.M.length=0}this.i.sd()}},ia.Sd=function(t){return t=this.Cd(null,t),this.a.debug("GetForwardChannelUri: "+t),t},ia.Pd=function(t,e){return t=this.Cd(this.fc()?t:null,e),this.a.debug("GetBackChannelUri: "+t),t},ia.Cd=function(t,e){var n=function(t){return t instanceof qu?t.clone():new qu(t,void 0)}(e);if(""!=n.xa)t&&n.rb(t+"."+n.xa),n.sb(n.Ca);else{var r=sa.location;n=function(t,e,n,r){var i=new qu(null,void 0);return t&&i.tb(t),e&&i.rb(e),n&&i.sb(n),r&&i.ec(r),i}(r.protocol,t?t+"."+r.hostname:r.hostname,+r.port,e)}return this.gb&&Ka(this.gb,function(t,e){n.l(e,t)}),t=this.aa,e=this.Kc,t&&e&&n.l(t,e),n.l("VER",this.tc),this.Ya(n),n},ia.Jb=function(t){if(t&&!this.gc)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new ac(this.Xa)).Je(this.gc),t},ia.Ba=function(){return!!this.i&&this.i.Ba()},ia.fc=function(){return this.gc},(ia=dc.prototype).sc=null,ia.wd=function(){},ia.ud=function(){},ia.td=function(){},ia.sd=function(){},ia.Ba=function(){return!0},ia.Ue=function(){},ia.$a=function(t){return t},yc.prototype.cf=function(t,e){return new mc(t,e)},Ta(mc,Vs),(ia=mc.prototype).addEventListener=function(t,e,n,r){mc.L.addEventListener.call(this,t,e,n,r)},ia.removeEventListener=function(t,e,n,r){mc.L.removeEventListener.call(this,t,e,n,r)},ia.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},ia.close=function(){this.b.disconnect()},ia.send=function(t){if(ua(t)){var e={};e.__data__=t,this.b.Zc(e)}else this.zg?((e={}).__data__=Bs(t),this.b.Zc(e)):this.b.Zc(t)},ia.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,mc.L.F.call(this)},Ta(gc,Du),Ta(vc,Ru),Ta(bc,dc),bc.prototype.wd=function(){pu(this.b.s,"WebChannel opened on "+this.b.yb),this.b.dispatchEvent("a")},bc.prototype.ud=function(t){this.b.dispatchEvent(new gc(t))},bc.prototype.td=function(t){pu(this.b.s,"WebChannel aborted on "+this.b.yb+" due to channel error: "+t),this.b.dispatchEvent(new vc(t))},bc.prototype.sd=function(){pu(this.b.s,"WebChannel closed on "+this.b.yb),this.b.dispatchEvent("b")};var _c=wa(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},yc);function wc(){this.V=[],this.Z=[]}function Ec(t,e){if(Ia.call(this),this.oe=t||0,this.Wb=e||10,this.oe>this.Wb)throw Error(Tc);this.fa=new wc,this.oa=new Ju,this.Ac=0,this.Nc=null,this.Cb()}(ia=wc.prototype).Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},ia.enqueue=function(t){this.Z.push(t)},ia.ab=function(){return this.Vf(),this.V.pop()},ia.C=function(){return this.V.length+this.Z.length},ia.X=function(){return 0==this.V.length&&0==this.Z.length},ia.clear=function(){this.V=[],this.Z=[]},ia.contains=function(t){return 0<=Da(this.V,t)||0<=Da(this.Z,t)},ia.remove=function(t){var e=this.V,n=Ra(e,t);return 0<=n?(Array.prototype.splice.call(e,n,1),e=!0):e=!1,e||La(this.Z,t)},ia.H=function(){for(var t=[],e=this.V.length-1;0<=e;--e)t.push(this.V[e]);var n=this.Z.length;for(e=0;e<n;++e)t.push(this.Z[e]);return t},Ta(Ec,Ia);var Tc="[goog.structs.Pool] Min can not be greater than max";function Sc(t,e){this.fe=t,this.gd=e}function Cc(t){this.Y=[],t&&this.Lf(t)}function Ic(){Cc.call(this)}function Ac(t,e){this.Gd=void 0,this.cc=new Ic,Ec.call(this,t,e)}function Nc(t,e,n,r){this.Jf=t,this.Ab=!!r,Ac.call(this,e,n)}(ia=Ec.prototype).Mb=function(){var t=Ea();if(!(null!=this.Nc&&t-this.Nc<this.Ac)){var e=this.qg();return e&&(this.Nc=t,this.oa.add(e)),e}},ia.og=function(t){return!!this.oa.remove(t)&&(this.nc(t),!0)},ia.qg=function(){for(var t;0<this.Td()&&(t=this.fa.ab(),!this.Sc(t));)this.Cb();return!t&&this.C()<this.Wb&&(t=this.xc()),t},ia.nc=function(t){this.oa.remove(t),this.Sc(t)&&this.C()<this.Wb?this.fa.enqueue(t):this.Bc(t)},ia.Cb=function(){for(var t=this.fa;this.C()<this.oe;)t.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(t.ab())},ia.xc=function(){return{}},ia.Bc=function(t){if("function"==typeof t.bb)t.bb();else for(var e in t)t[e]=null},ia.Sc=function(t){return"function"!=typeof t.Ye||t.Ye()},ia.contains=function(t){return this.fa.contains(t)||this.oa.contains(t)},ia.C=function(){return this.fa.C()+this.oa.C()},ia.rf=function(){return this.oa.C()},ia.Td=function(){return this.fa.C()},ia.X=function(){return this.fa.X()&&this.oa.X()},ia.F=function(){if(Ec.L.F.call(this),0<this.rf())throw Error("[goog.structs.Pool] Objects not released");delete this.oa;for(var t=this.fa;!t.X();)this.Bc(t.ab());delete this.fa},Sc.prototype.getKey=function(){return this.fe},Sc.prototype.clone=function(){return new Sc(this.fe,this.gd)},(ia=Cc.prototype).ce=function(t,e){var n=this.Y;n.push(new Sc(t,e)),this.$f(n.length-1)},ia.Lf=function(t){if(t instanceof Cc){var e=t.W();if(t=t.H(),0>=this.C()){for(var n=this.Y,r=0;r<e.length;r++)n.push(new Sc(e[r],t[r]));return}}else e=Ga(t),t=Ha(t);for(r=0;r<e.length;r++)this.ce(e[r],t[r])},ia.remove=function(){var t=this.Y,e=t.length,n=t[0];if(!(0>=e))return 1==e?Oa(t):(t[0]=t.pop(),this.Zf()),n.gd},ia.Zf=function(){for(var t=0,e=this.Y,n=e.length,r=e[t];t<n>>1;){var i=this.tf(t),o=this.zf(t);if(e[i=o<n&&e[o].getKey()<e[i].getKey()?o:i].getKey()>r.getKey())break;e[t]=e[i],t=i}e[t]=r},ia.$f=function(t){for(var e=this.Y,n=e[t];0<t;){var r=this.wf(t);if(!(e[r].getKey()>n.getKey()))break;e[t]=e[r],t=r}e[t]=n},ia.tf=function(t){return 2*t+1},ia.zf=function(t){return 2*t+2},ia.wf=function(t){return t-1>>1},ia.H=function(){for(var t=this.Y,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].gd);return e},ia.W=function(){for(var t=this.Y,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].getKey());return e},ia.va=function(t){return ka(this.Y,function(e){return e.getKey()==t})},ia.clone=function(){return new Cc(this)},ia.C=function(){return this.Y.length},ia.X=function(){return 0==this.Y.length},ia.clear=function(){Oa(this.Y)},Ta(Ic,Cc),Ic.prototype.enqueue=function(t,e){this.ce(t,e)},Ic.prototype.ab=function(){return this.remove()},Ta(Ac,Ec),(ia=Ac.prototype).Mb=function(t,e){if(!t)return(t=Ac.L.Mb.call(this))&&this.Ac&&(this.Gd=sa.setTimeout(_a(this.Nb,this),this.Ac)),t;this.cc.enqueue(void 0!==e?e:100,t),this.Nb()},ia.Nb=function(){for(var t=this.cc;0<t.C();){var e=this.Mb();if(!e)break;t.ab().apply(this,[e])}},ia.nc=function(t){Ac.L.nc.call(this,t),this.Nb()},ia.Cb=function(){Ac.L.Cb.call(this),this.Nb()},ia.F=function(){Ac.L.F.call(this),sa.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},Ta(Nc,Ac),Nc.prototype.xc=function(){var t=new ac,e=this.Jf;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.Ab&&t.Je(!0),t},Nc.prototype.Sc=function(t){return!t.Ka&&!t.Ba()},yc.prototype.createWebChannel=yc.prototype.cf,mc.prototype.send=mc.prototype.send,mc.prototype.open=mc.prototype.open,mc.prototype.close=mc.prototype.close,Tu.NO_ERROR=0,Tu.TIMEOUT=8,Tu.HTTP_ERROR=6,Su.COMPLETE="complete",Iu.EventType=Nu,Nu.OPEN="a",Nu.CLOSE="b",Nu.ERROR="c",Nu.MESSAGE="d",Vs.prototype.listen=Vs.prototype.nb,Nc.prototype.getObject=Nc.prototype.Mb,Nc.prototype.releaseObject=Nc.prototype.og,ac.prototype.listenOnce=ac.prototype.Oc,ac.prototype.getLastError=ac.prototype.Hc,ac.prototype.getLastErrorCode=ac.prototype.Ud,ac.prototype.getStatus=ac.prototype.za,ac.prototype.getStatusText=ac.prototype.Yd,ac.prototype.getResponseJson=ac.prototype.yf,ac.prototype.getResponseText=ac.prototype.ya,ac.prototype.getResponseText=ac.prototype.ya,ac.prototype.send=ac.prototype.send;var Dc,Rc,Pc={createWebChannelTransport:_c,ErrorCode:Tu,EventType:Su,WebChannel:Iu,XhrIoPool:Nc},kc=Pc.createWebChannelTransport,Oc=Pc.ErrorCode,Lc=Pc.EventType,xc=Pc.WebChannel,Mc=Pc.XhrIoPool,Fc=jn.SDK_VERSION,Uc=new er("@firebase/firestore");function Vc(){return Uc.logLevel===Bn.DEBUG?Dc.DEBUG:Uc.logLevel===Bn.SILENT?Dc.SILENT:Dc.ERROR}function Bc(t){switch(t){case Dc.DEBUG:Uc.logLevel=Bn.DEBUG;break;case Dc.ERROR:Uc.logLevel=Bn.ERROR;break;case Dc.SILENT:Uc.logLevel=Bn.SILENT;break;default:Uc.error("Firestore ("+Fc+"): Invalid value passed to `setLogLevel`")}}function qc(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(Uc.logLevel<=Bn.DEBUG){var i=n.map(Wc);Uc.debug.apply(Uc,["Firestore ("+Fc+") ["+t+"]: "+e].concat(i))}}function jc(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Uc.logLevel<=Bn.ERROR){var r=e.map(Wc);Uc.error.apply(Uc,["Firestore ("+Fc+"): "+t].concat(r))}}function Wc(t){if("string"==typeof t)return t;var e=Gc.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function Kc(t){var e="FIRESTORE ("+Fc+") INTERNAL ASSERTION FAILED: "+t;throw jc(e),new Error(e)}function Hc(t,e){t||Kc(e)}(Rc=Dc||(Dc={}))[Rc.DEBUG=0]="DEBUG",Rc[Rc.ERROR=1]="ERROR",Rc[Rc.SILENT=2]="SILENT";var Gc=function(){function t(){}return t.setPlatform=function(e){t.platform&&Kc("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||Kc("Platform not set"),t.platform},t}();function $c(){return Gc.getPlatform().emptyByteString}var Qc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},zc=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return $e(e,t),e}(Error);function Yc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new zc(Qc.INVALID_ARGUMENT,t)}for(var r in n.prototype=t.prototype,t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function Xc(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Jc(t,e){return void 0!==t?t:e}function Zc(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function th(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function eh(t){for(var e in Hc(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function nh(t,e,n){if(e.length!==n)throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires "+gh(n,"argument")+", but was called with "+gh(e.length,"argument")+".")}function rh(t,e,n){if(e.length<n)throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires at least "+gh(n,"argument")+", but was called with "+gh(e.length,"argument")+".")}function ih(t,e,n,r){if(e.length<n||e.length>r)throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+gh(e.length,"argument")+".")}function oh(t,e,n,r){hh(t,e,mh(n)+" argument",r)}function ah(t,e,n,r){void 0!==r&&oh(t,e,n,r)}function sh(t,e,n,r){hh(t,e,n+" option",r)}function uh(t,e,n,r){void 0!==r&&sh(t,e,n,r)}function ch(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(fh(u))}var c=fh(r);throw new zc(Qc.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function hh(t,e,n,r){if(!("object"===e?lh(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=fh(r);throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function lh(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function fh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Kc("Unknown wrong type: "+typeof t)}function ph(t,e,n){if(void 0===n)throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+mh(e)+" argument, but it was undefined.")}function dh(t,e,n){th(e,function(e,r){if(n.indexOf(e)<0)throw new zc(Qc.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function yh(t,e,n,r){var i=fh(r);return new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires its "+mh(n)+" argument to be a "+e+", but it was: "+i)}function mh(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function gh(t,e){return t+" "+e+(1===t?"":"s")}var vh=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return Hc(20===e.length,"Invalid auto ID: "+e),e},t}();function bh(t,e){return t<e?-1:t>e?1:0}function _h(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function wh(){if("undefined"==typeof Uint8Array)throw new zc(Qc.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Eh(){if(!Gc.getPlatform().base64Available)throw new zc(Qc.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Th,Sh,Ch=function(){function t(t){Eh(),this._binaryString=t}return t.fromBase64String=function(e){nh("Blob.fromBase64String",arguments,1),oh("Blob.fromBase64String","string",1,e),Eh();try{return new t(Gc.getPlatform().atob(e))}catch(t){throw new zc(Qc.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(nh("Blob.fromUint8Array",arguments,1),wh(),!(e instanceof Uint8Array))throw yh("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return nh("Blob.toBase64",arguments,0),Eh(),Gc.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){nh("Blob.toUint8Array",arguments,0),wh();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return bh(this._binaryString,t._binaryString)},t}(),Ih=Yc(Ch,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Ah=function(){function t(t,e){if(nh("GeoPoint",arguments,2),oh("GeoPoint","number",1,t),oh("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new zc(Qc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new zc(Qc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return bh(this._lat,t._lat)||bh(this._long,t._long)},t}(),Nh=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new zc(Qc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new zc(Qc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new zc(Qc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new zc(Qc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?bh(this.nanoseconds,t.nanoseconds):bh(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),Dh=function(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r},Rh="(default)",Ph=function(){function t(t,e){this.projectId=t,this.database=e||Rh}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===Rh},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return bh(this.projectId,t.projectId)||bh(this.database,t.database)},t}(),kh=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&Kc("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Kc("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"==typeof e?n.push(e):Kc("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,Hc(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return Hc(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return Hc(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return Hc(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return Hc(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $e(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new zc(Qc.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(kh),Lh=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $e(e,t),e.isValidIdentifier=function(t){return Lh.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new zc(Qc.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new zc(Qc.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new zc(Qc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new zc(Qc.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(kh),Mh=function(){function t(e){this.path=e,Hc(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(t){return null!==t&&0===Oh.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Oh.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Oh(e.slice()))},t.fromPathString=function(e){return new t(Oh.fromString(e))},t.EMPTY=new t(new Oh([])),t}(),Fh=function(){function t(t,e){this.key=t,this.version=e}return t.compareByKey=function(t,e){return Mh.comparator(t.key,e.key)},t}(),Uh=function(t){function e(e,n,r,i,o){var a=t.call(this,e,n)||this;return a.data=r,a.proto=o,a.hasLocalMutations=!!i.hasLocalMutations,a.hasCommittedMutations=!!i.hasCommittedMutations,a}return $e(e,t),e.prototype.field=function(t){return this.data.field(t)},e.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},e.prototype.value=function(){return this.data.value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.data.isEqual(t.data)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):Kc("Trying to compare documents on fields that don't exist")},e}(Fh),Vh=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return $e(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Fh),Bh=function(t){function e(e,n){return t.call(this,e,n)||this}return $e(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Fh),qh=function(){function t(t,e){this.comparator=t,this.root=e||Wh.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Wh.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wh.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new jh(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new jh(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new jh(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new jh(this.root,t,this.comparator,!0)},t}(),jh=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){Hc(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Wh=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Kc("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw Kc("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw Kc("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Kh=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Wh(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();Wh.EMPTY=new Kh,function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(Th||(Th={})),function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(Sh||(Sh={}));var Hh=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Sh.Estimate,n);case"previous":return new t(Sh.Previous,n);case"none":case void 0:return new t(Sh.Default,n);default:return Kc("fromSnapshotOptions() called with invalid options.")}},t}(),Gh=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return Hc(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),bh(this.typeOrder,t.typeOrder)},t}(),$h=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Th.NullValue,e.internalValue=null,e}return $e(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Gh),Qh=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.BooleanValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?bh(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Gh),zh=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.NumberValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?(n=this.internalValue)<(r=t.internalValue)?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1:this.defaultCompareTo(t);var n,r},e}(Gh);function Yh(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Xh=function(t){function e(e){return t.call(this,e)||this}return $e(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Yh(this.internalValue,t.internalValue)},e}(zh),Jh=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return $e(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Yh(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(zh),Zh=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.StringValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?bh(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Gh),tl=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.TimestampValue,n}return $e(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof el?-1:this.defaultCompareTo(t)},e}(Gh),el=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Th.TimestampValue,r}return $e(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Sh.Estimate?new tl(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Sh.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof tl?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Gh),nl=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.BlobValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Gh),rl=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Th.RefValue,r}return $e(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId)},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:Mh.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Gh),il=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.GeoPointValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Gh),ol=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.ObjectValue,n}return $e(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=bh(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return bh(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(Hc(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(Hc(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){Hc(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e&&n.internalValue.get(t)||void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new qh(bh)),e}(Gh),al=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Th.ArrayValue,n}return $e(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return bh(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(Gh),sl=Number,ul=sl.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),cl=sl.MAX_SAFE_INTEGER||Math.pow(2,53)-1,hl=sl.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function ll(t){return null==t}function fl(t){return hl(t)&&t<=cl&&t>=ul}var pl,dl=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[Tl]:this.memoizedOrderBy=[new El(t),Tl];else{Hc(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:_l.ASCENDING;this.memoizedOrderBy.push(a===_l.ASCENDING?Tl:Sl)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){Hc(null==this.getInequalityFilterField()||!(e instanceof gl)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),Hc(!Mh.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){Hc(!Mh.isDocumentKey(this.path),"No ordering allowed for document query"),Hc(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";ll(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),ll(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return Hc(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!ll(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof gl&&n.isInequality())return n.field}return null},t.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(t){return t instanceof gl&&t.op===ml.ARRAY_CONTAINS})},t.prototype.isDocumentQuery=function(){return Mh.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return Mh.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){Hc(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),yl=function(){function t(){}return t.create=function(t,e,n){if(n.isEqual($h.INSTANCE)){if(e!==ml.EQUAL)throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new vl(t)}if(n.isEqual(Jh.NAN)){if(e!==ml.EQUAL)throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new bl(t)}return new gl(t,e,n)},t}(),ml=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;default:return Kc("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t}(),gl=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return $e(e,t),e.prototype.matches=function(t){if(this.field.isKeyField()){Hc(this.value instanceof rl,"Comparing on key, but filter value not a RefValue"),Hc(this.op!==ml.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var e=this.value,n=Mh.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},e.prototype.matchesValue=function(t){var e=this;return this.op===ml.ARRAY_CONTAINS?t instanceof al&&void 0!==t.internalValue.find(function(t){return t.isEqual(e.value)}):this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},e.prototype.matchesComparison=function(t){switch(this.op){case ml.LESS_THAN:return t<0;case ml.LESS_THAN_OR_EQUAL:return t<=0;case ml.EQUAL:return 0===t;case ml.GREATER_THAN:return t>0;case ml.GREATER_THAN_OR_EQUAL:return t>=0;default:return Kc("Unknown relation op"+this.op)}},e.prototype.isInequality=function(){return this.op!==ml.EQUAL&&this.op!==ml.ARRAY_CONTAINS},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},e.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},e}(yl),vl=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return $e(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},e.prototype.toString=function(){return this.field.canonicalString()+" IS null"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}(yl),bl=function(t){function e(e){var n=t.call(this)||this;return n.field=e,n}return $e(e,t),e.prototype.matches=function(t){var e=t.field(this.field),n=e&&e.value();return"number"==typeof n&&isNaN(n)},e.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},e.prototype.isEqual=function(t){return t instanceof e&&this.field.isEqual(t.field)},e}(yl),_l=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),wl=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},t.prototype.sortsBeforeDocument=function(t,e){Hc(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())Hc(o instanceof rl,"Bound has a non-key value where the key path is being used."),n=Mh.comparator(o.key,e.key);else{var a=e.field(i.field);Hc(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===_l.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),El=function(){function t(t,e){this.field=t,void 0===e&&(e=_l.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?Uh.compareByKey(t,e):Uh.compareByField(this.field,t,e);switch(this.dir){case _l.ASCENDING:return n;case _l.DESCENDING:return-1*n;default:return Kc("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Tl=new El(xh.keyField(),_l.ASCENDING),Sl=new El(xh.keyField(),_l.DESCENDING),Cl=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new Nh(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new Nh(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(pl||(pl={}));var Il,Al=function(){function t(t,e,n,r,i,o){void 0===i&&(i=Cl.MIN),void 0===o&&(o=$c()),this.query=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.resumeToken=o}return t.prototype.copy=function(e){return new t(this.query,this.targetId,this.purpose,void 0===e.sequenceNumber?this.sequenceNumber:e.sequenceNumber,void 0===e.snapshotVersion?this.snapshotVersion:e.snapshotVersion,void 0===e.resumeToken?this.resumeToken:e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.sequenceNumber===t.sequenceNumber&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),Nl=function(){function t(t){this.comparator=t,this.data=new qh(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Dl(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Dl(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Dl=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Rl=function(){function t(t){this.fields=t}return t.fromSet=function(e){return new t(e)},t.fromArray=function(e){var n=new Nl(xh.comparator);return e.forEach(function(t){return n=n.add(t)}),new t(n)},t.prototype.covers=function(t){var e=!1;return this.fields.forEach(function(n){n.isPrefixOf(t)&&(e=!0)}),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),Pl=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),kl=function(t,e){this.version=t,this.transformResults=e};!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(Il||(Il={}));var Ol=function(){function t(t,e){this.updateTime=t,this.exists=e,Hc(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof Uh&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Uh:(Hc(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Ll=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&Hc(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof Uh?t.version:Cl.MIN},t}(),xl=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=Il.Set,i}return $e(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),Hc(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Uh(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ll.getPostMutationVersion(t);return new Uh(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(Ll),Ml=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=Il.Patch,o}return $e(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Hc(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return new Bh(this.key,e.version);var n=this.patchDocument(t);return new Uh(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=Ll.getPostMutationVersion(t),i=this.patchDocument(t);return new Uh(this.key,r,i,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof Uh?t.data:ol.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){var e=this;return this.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t=void 0!==r?t.set(n,r):t.delete(n)}}),t},e}(Ll),Fl=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=Il.Transform,r.precondition=Ol.exists(!0),r}return $e(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),Hc(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(t))return new Bh(this.key,e.version);var n=this.requireDocument(t),r=this.serverTransformResults(t,e.transformResults),i=e.version,o=this.transformObject(n.data,r);return new Uh(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new Uh(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&_h(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){Hc(t instanceof Uh,"Unknown MaybeDocument type "+t);var e=t;return Hc(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.serverTransformResults=function(t,e){var n=[];Hc(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;t instanceof Uh&&(a=t.field(i.field)||null),n.push(o.applyToRemoteDocument(a,e[r]))}return n},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;e instanceof Uh&&(s=e.field(o.field)||null),n.push(a.applyToLocalView(s,t))}return n},e.prototype.transformObject=function(t,e){Hc(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},e}(Ll),Ul=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=Il.Delete,r}return $e(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),Hc(null==e.transformResults,"Transform results received by DeleteMutation."),new Vh(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&Hc(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Vh(this.key,Cl.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(Ll),Vl=function(){function t(){}return t.prototype.applyToLocalView=function(t,e){return new el(e,t)},t.prototype.applyToRemoteDocument=function(t,e){return e},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Bl=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=jl(t),n=function(t){e.find(function(e){return e.isEqual(t)})||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new al(e)},t.prototype.isEqual=function(e){return e instanceof t&&_h(e.elements,this.elements)},t}(),ql=function(){function t(t){this.elements=t}return t.prototype.applyToLocalView=function(t,e){return this.apply(t)},t.prototype.applyToRemoteDocument=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=jl(t),n=function(t){e=e.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++)n(i[r]);return new al(e)},t.prototype.isEqual=function(e){return e instanceof t&&_h(e.elements,this.elements)},t}();function jl(t){return t instanceof al?t.internalValue.slice():[]}var Wl,Kl=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();function Hl(t){switch(t){case Qc.OK:return Kc("Treated status OK as error");case Qc.CANCELLED:case Qc.UNKNOWN:case Qc.DEADLINE_EXCEEDED:case Qc.RESOURCE_EXHAUSTED:case Qc.INTERNAL:case Qc.UNAVAILABLE:case Qc.UNAUTHENTICATED:return!1;case Qc.INVALID_ARGUMENT:case Qc.NOT_FOUND:case Qc.ALREADY_EXISTS:case Qc.PERMISSION_DENIED:case Qc.FAILED_PRECONDITION:case Qc.ABORTED:case Qc.OUT_OF_RANGE:case Qc.UNIMPLEMENTED:case Qc.DATA_LOSS:return!0;default:return Kc("Unknown status code: "+t)}}function Gl(t){if(void 0===t)return jc("GRPC error has no .code"),Qc.UNKNOWN;switch(t){case Wl.OK:return Qc.OK;case Wl.CANCELLED:return Qc.CANCELLED;case Wl.UNKNOWN:return Qc.UNKNOWN;case Wl.DEADLINE_EXCEEDED:return Qc.DEADLINE_EXCEEDED;case Wl.RESOURCE_EXHAUSTED:return Qc.RESOURCE_EXHAUSTED;case Wl.INTERNAL:return Qc.INTERNAL;case Wl.UNAVAILABLE:return Qc.UNAVAILABLE;case Wl.UNAUTHENTICATED:return Qc.UNAUTHENTICATED;case Wl.INVALID_ARGUMENT:return Qc.INVALID_ARGUMENT;case Wl.NOT_FOUND:return Qc.NOT_FOUND;case Wl.ALREADY_EXISTS:return Qc.ALREADY_EXISTS;case Wl.PERMISSION_DENIED:return Qc.PERMISSION_DENIED;case Wl.FAILED_PRECONDITION:return Qc.FAILED_PRECONDITION;case Wl.ABORTED:return Qc.ABORTED;case Wl.OUT_OF_RANGE:return Qc.OUT_OF_RANGE;case Wl.UNIMPLEMENTED:return Qc.UNIMPLEMENTED;case Wl.DATA_LOSS:return Qc.DATA_LOSS;default:return Kc("Unknown status code: "+t)}}!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(Wl||(Wl={}));var $l=new qh(Mh.comparator);function Ql(){return $l}function zl(){return Ql()}var Yl=new qh(Mh.comparator);function Xl(){return Yl}var Jl=new qh(Mh.comparator);function Zl(){return Jl}var tf=new Nl(Mh.comparator);function ef(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=tf,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var nf=new Nl(bh);function rf(){return nf}var of,af,sf=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Mh.comparator(e.key,n.key)}:function(t,e){return Mh.comparator(t.key,e.key)},this.keyedMap=Xl(),this.sortedSet=new qh(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}();!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(of||(of={})),function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(af||(af={}));var uf,cf=function(){function t(){this.changeMap=new qh(Mh.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);n?t.type!==of.Added&&n.type===of.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===of.Metadata&&n.type!==of.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===of.Modified&&n.type===of.Modified?this.changeMap=this.changeMap.insert(e,{type:of.Modified,doc:t.doc}):t.type===of.Modified&&n.type===of.Added?this.changeMap=this.changeMap.insert(e,{type:of.Added,doc:t.doc}):t.type===of.Removed&&n.type===of.Added?this.changeMap=this.changeMap.remove(e):t.type===of.Removed&&n.type===of.Modified?this.changeMap=this.changeMap.insert(e,{type:of.Removed,doc:n.doc}):t.type===of.Added&&n.type===of.Removed?this.changeMap=this.changeMap.insert(e,{type:of.Modified,doc:t.doc}):Kc("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(e,t)},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),hf=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:of.Added,doc:t})}),new t(e,n,sf.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),lf=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r,i=((r={})[e]=ff.createSynthesizedTargetChangeForCurrentChange(e,n),r);return new t(Cl.MIN,i,rf(),Ql(),ef())},t}(),ff=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t($c(),n,ef(),ef(),ef())},t}(),pf=function(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r},df=function(t,e){this.targetId=t,this.existenceFilter=e};!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(uf||(uf={}));var yf=function(t,e,n,r){void 0===n&&(n=$c()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mf=function(){function t(){this.pendingResponses=0,this.documentChanges=bf(),this._resumeToken=$c(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPending",{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingChanges",{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),t.prototype.updateResumeToken=function(t){t.length>0&&(this._hasPendingChanges=!0,this._resumeToken=t)},t.prototype.toTargetChange=function(){var t=ef(),e=ef(),n=ef();return this.documentChanges.forEach(function(r,i){switch(i){case of.Added:t=t.add(r);break;case of.Modified:e=e.add(r);break;case of.Removed:n=n.add(r);break;default:Kc("Encountered invalid change type: "+i)}}),new ff(this._resumeToken,this._current,t,e,n)},t.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=bf()},t.prototype.addDocumentChange=function(t,e){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(t,e)},t.prototype.removeDocumentChange=function(t){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(t)},t.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},t.prototype.recordTargetResponse=function(){this.pendingResponses-=1},t.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},t}(),gf=function(){function t(t){this.metadataProvider=t,this.targetStates={},this.pendingDocumentUpdates=Ql(),this.pendingDocumentTargetMapping=vf(),this.pendingTargetResets=new Nl(bh)}return t.prototype.handleDocumentChange=function(t){for(var e=0,n=t.updatedTargetIds;e<n.length;e++){var r=n[e];t.newDoc instanceof Uh?this.addDocumentToTarget(r,t.newDoc):t.newDoc instanceof Vh&&this.removeDocumentFromTarget(r,t.key,t.newDoc)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.removeDocumentFromTarget(r,t.key,t.newDoc)},t.prototype.handleTargetChange=function(t){var e=this;this.forEachTarget(t,function(n){var r=e.ensureTargetState(n);switch(t.state){case uf.NoChange:e.isActiveTarget(n)&&r.updateResumeToken(t.resumeToken);break;case uf.Added:r.recordTargetResponse(),r.isPending||r.clearPendingChanges(),r.updateResumeToken(t.resumeToken);break;case uf.Removed:r.recordTargetResponse(),r.isPending||e.removeTarget(n),Hc(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case uf.Current:e.isActiveTarget(n)&&(r.markCurrent(),r.updateResumeToken(t.resumeToken));break;case uf.Reset:e.isActiveTarget(n)&&(e.resetTarget(n),r.updateResumeToken(t.resumeToken));break;default:Kc("Unknown target watch change state: "+t.state)}})},t.prototype.forEachTarget=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):Zc(this.targetStates,e)},t.prototype.handleExistenceFilter=function(t){var e=t.targetId,n=t.existenceFilter.count,r=this.queryDataForActiveTarget(e);if(r){var i=r.query;if(i.isDocumentQuery())if(0===n){var o=new Mh(i.path);this.removeDocumentFromTarget(e,o,new Vh(o,Cl.forDeletedDoc()))}else Hc(1===n,"Single document existence filter with count: "+n);else this.getCurrentDocumentCountForTarget(e)!==n&&(this.resetTarget(e),this.pendingTargetResets=this.pendingTargetResets.add(e))}},t.prototype.createRemoteEvent=function(t){var e=this,n={};Zc(this.targetStates,function(r,i){var o=e.queryDataForActiveTarget(r);if(o){if(i.current&&o.query.isDocumentQuery()){var a=new Mh(o.query.path);null!==e.pendingDocumentUpdates.get(a)||e.targetContainsDocument(r,a)||e.removeDocumentFromTarget(r,a,new Vh(a,t))}i.hasPendingChanges&&(n[r]=i.toTargetChange(),i.clearPendingChanges())}});var r=ef();this.pendingDocumentTargetMapping.forEach(function(t,n){var i=!0;n.forEachWhile(function(t){var n=e.queryDataForActiveTarget(t);return!n||n.purpose===pl.LimboResolution||(i=!1,!1)}),i&&(r=r.add(t))});var i=new lf(t,n,this.pendingTargetResets,this.pendingDocumentUpdates,r);return this.pendingDocumentUpdates=Ql(),this.pendingDocumentTargetMapping=vf(),this.pendingTargetResets=new Nl(bh),i},t.prototype.addDocumentToTarget=function(t,e){if(this.isActiveTarget(t)){var n=this.targetContainsDocument(t,e.key)?of.Modified:of.Added;this.ensureTargetState(t).addDocumentChange(e.key,n),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e.key,e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e.key,this.ensureDocumentTargetMapping(e.key).add(t))}},t.prototype.removeDocumentFromTarget=function(t,e,n){if(this.isActiveTarget(t)){var r=this.ensureTargetState(t);this.targetContainsDocument(t,e)?r.addDocumentChange(e,of.Removed):r.removeDocumentChange(e),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(e,this.ensureDocumentTargetMapping(e).delete(t)),n&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(e,n))}},t.prototype.removeTarget=function(t){delete this.targetStates[t]},t.prototype.getCurrentDocumentCountForTarget=function(t){var e=this.ensureTargetState(t).toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.recordPendingTargetRequest=function(t){this.ensureTargetState(t).recordPendingTargetRequest()},t.prototype.ensureTargetState=function(t){return this.targetStates[t]||(this.targetStates[t]=new mf),this.targetStates[t]},t.prototype.ensureDocumentTargetMapping=function(t){var e=this.pendingDocumentTargetMapping.get(t);return e||(e=new Nl(bh),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(t,e)),e},t.prototype.isActiveTarget=function(t){return null!==this.queryDataForActiveTarget(t)},t.prototype.queryDataForActiveTarget=function(t){var e=this.targetStates[t];return e&&e.isPending?null:this.metadataProvider.getQueryDataForTarget(t)},t.prototype.resetTarget=function(t){var e=this;Hc(!this.targetStates[t].isPending,"Should only reset active targets"),this.targetStates[t]=new mf,this.metadataProvider.getRemoteKeysForTarget(t).forEach(function(n){e.removeDocumentFromTarget(t,n,null)})},t.prototype.targetContainsDocument=function(t,e){return this.metadataProvider.getRemoteKeysForTarget(t).has(e)},t}();function vf(){return new qh(Mh.comparator)}function bf(){return new qh(Mh.comparator)}var _f,wf,Ef=((_f={})[_l.ASCENDING.name]="ASCENDING",_f[_l.DESCENDING.name]="DESCENDING",_f),Tf=((wf={})[ml.LESS_THAN.name]="LESS_THAN",wf[ml.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",wf[ml.GREATER_THAN.name]="GREATER_THAN",wf[ml.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",wf[ml.EQUAL.name]="EQUAL",wf[ml.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",wf),Sf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Cf(t,e){Hc(!ll(t),e+" is missing")}function If(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Kc("can't parse "+t)}var Af=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?Qc.UNKNOWN:Gl(t.code);return new zc(e,t.message||"")},t.prototype.toInt32Value=function(t){return ll(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return ll(e="object"==typeof t?t.value:t)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"==typeof t)return this.fromIso8601String(t);Hc(!!t,"Cannot deserialize null or undefined timestamp.");var e=If(t.seconds||"0"),n=t.nanos||0;return new Nh(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=Sf.exec(t);if(Hc(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new Nh(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"==typeof t?(Hc(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Ch.fromBase64String(t)):(Hc(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Ch.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return Hc(!!t,"Trying to deserialize version that isn't set"),Cl.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=Oh.fromString(t);return Hc(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return Hc(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),Hc(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new Mh(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?Oh.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new Oh(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new Oh(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return Hc(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof $h)return{nullValue:"NULL_VALUE"};if(t instanceof Qh)return{booleanValue:t.value()};if(t instanceof Xh)return{integerValue:""+t.value()};if(t instanceof Jh){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Zh?{stringValue:t.value()}:t instanceof ol?{mapValue:this.toMapValue(t)}:t instanceof al?{arrayValue:this.toArrayValue(t)}:t instanceof tl?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof il?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof nl?{bytesValue:this.toBytes(t.value())}:t instanceof rl?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:Kc("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(Nf(t,n,"nullValue"))return $h.INSTANCE;if(Nf(t,n,"booleanValue"))return Qh.of(t.booleanValue);if(Nf(t,n,"integerValue"))return new Xh(If(t.integerValue));if(Nf(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Jh.NAN;if("Infinity"===t.doubleValue)return Jh.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Jh.NEGATIVE_INFINITY}return new Jh(t.doubleValue)}if(Nf(t,n,"stringValue"))return new Zh(t.stringValue);if(Nf(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(Nf(t,n,"arrayValue")){Cf(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new al(r.map(function(t){return e.fromValue(t)}))}if(Nf(t,n,"timestampValue"))return Cf(t.timestampValue,"timestampValue"),new tl(this.fromTimestamp(t.timestampValue));if(Nf(t,n,"geoPointValue")){Cf(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new il(new Ah(i,o))}if(Nf(t,n,"bytesValue")){Cf(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new nl(a)}if(Nf(t,n,"referenceValue")){Cf(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),u=new Ph(s.get(1),s.get(3)),c=new Mh(this.extractLocalPathFromResourceName(s));return new rl(u,c)}return Kc("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return Hc(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t,e){return new Uh(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasCommittedMutations:!!e})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=ol.EMPTY;return th(n,function(t,n){r=r.set(new xh([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){Hc(!!t.found,"Tried to deserialize a found document from a missing document."),Cf(t.found.name,"doc.found.name"),Cf(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new Uh(e,n,r,{},t.found)},t.prototype.fromMissing=function(t){Hc(!!t.missing,"Tried to deserialize a missing document from a found document."),Hc(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new Vh(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result;return Nf(t,e,"found")?this.fromFound(t):Nf(t,e,"missing")?this.fromMissing(t):Kc("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case uf.Added:return"ADD";case uf.Current:return"CURRENT";case uf.NoChange:return"NO_CHANGE";case uf.Removed:return"REMOVE";case uf.Reset:return"RESET";default:return Kc("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof df)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof pf){if(t.newDoc instanceof Uh){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof Vh)return e=t.newDoc,{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof yf){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Wl.OK;switch(t){case Qc.OK:return Wl.OK;case Qc.CANCELLED:return Wl.CANCELLED;case Qc.UNKNOWN:return Wl.UNKNOWN;case Qc.DEADLINE_EXCEEDED:return Wl.DEADLINE_EXCEEDED;case Qc.RESOURCE_EXHAUSTED:return Wl.RESOURCE_EXHAUSTED;case Qc.INTERNAL:return Wl.INTERNAL;case Qc.UNAVAILABLE:return Wl.UNAVAILABLE;case Qc.UNAUTHENTICATED:return Wl.UNAUTHENTICATED;case Qc.INVALID_ARGUMENT:return Wl.INVALID_ARGUMENT;case Qc.NOT_FOUND:return Wl.NOT_FOUND;case Qc.ALREADY_EXISTS:return Wl.ALREADY_EXISTS;case Qc.PERMISSION_DENIED:return Wl.PERMISSION_DENIED;case Qc.FAILED_PRECONDITION:return Wl.FAILED_PRECONDITION;case Qc.ABORTED:return Wl.ABORTED;case Qc.OUT_OF_RANGE:return Wl.OUT_OF_RANGE;case Qc.UNIMPLEMENTED:return Wl.UNIMPLEMENTED;case Qc.DATA_LOSS:return Wl.DATA_LOSS;default:return Kc("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return Kc("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.response_type;if(Nf(t,n,"targetChange")){Cf(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new yf(r,i,o,s||null)}else if(Nf(t,n,"documentChange")){Cf(t.documentChange,"documentChange"),Cf(t.documentChange.document,"documentChange.name"),Cf(t.documentChange.document.name,"documentChange.document.name"),Cf(t.documentChange.document.updateTime,"documentChange.document.updateTime");var u=t.documentChange,c=this.fromName(u.document.name),h=this.fromVersion(u.document.updateTime),l=this.fromFields(u.document.fields||{}),f=new Uh(c,h,l,{},u.document),p=u.targetIds||[],d=u.removedTargetIds||[];e=new pf(p,d,f.key,f)}else if(Nf(t,n,"documentDelete")){Cf(t.documentDelete,"documentDelete"),Cf(t.documentDelete.document,"documentDelete.document");var y=t.documentDelete;c=this.fromName(y.document),h=y.readTime?this.fromVersion(y.readTime):Cl.forDeletedDoc(),f=new Vh(c,h),d=y.removedTargetIds||[],e=new pf([],d,f.key,f)}else if(Nf(t,n,"documentRemove")){Cf(t.documentRemove,"documentRemove"),Cf(t.documentRemove.document,"documentRemove");var m=t.documentRemove;c=this.fromName(m.document),d=m.removedTargetIds||[],e=new pf([],d,c,null)}else{if(!Nf(t,n,"filter"))return Kc("Unknown change type "+JSON.stringify(t));Cf(t.filter,"filter"),Cf(t.filter.targetId,"filter.targetId");var g=t.filter,v=g.count||0,b=new Kl(v),_=g.targetId;e=new df(_,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?uf.NoChange:"ADD"===t?uf.Added:"REMOVE"===t?uf.Removed:"CURRENT"===t?uf.Current:"RESET"===t?uf.Reset:Kc("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!Nf(t,t.response_type,"targetChange"))return Cl.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Cl.MIN:e.readTime?this.fromVersion(e.readTime):Cl.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof xl)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof Ul)e={delete:this.toName(t.key)};else if(t instanceof Ml)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof Fl))return Kc("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):Ol.NONE;if(t.update){Cf(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new Ml(r,i,o,n)}return new xl(r,i,n)}if(t.delete)return r=this.fromName(t.delete),new Ul(r,n);if(t.transform){r=this.fromName(t.transform.document);var a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return Hc(!0===n.exists,'Transforms only support precondition "exists == true"'),new Fl(r,a)}return Kc("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return Hc(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Kc("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?Ol.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Ol.exists(t.exists):Ol.NONE},t.prototype.fromWriteResult=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e),i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map(function(t){return n.fromValue(t)})),new kl(r,i)},t.prototype.fromWriteResults=function(t,e){var n=this;return t&&t.length>0?(Hc(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.fromWriteResult(t,e)})):[]},t.prototype.toFieldTransform=function(t){var e=this,n=t.transform;if(n instanceof Vl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Bl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(t){return e.toValue(t)})}};if(n instanceof ql)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(t){return e.toValue(t)})}};throw Kc("Unknown transform: "+t.transform)},t.prototype.fromFieldTransform=function(t){var e=this,n=t.transform_type,r=null;if(Nf(t,n,"setToServerValue"))Hc("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),r=Vl.instance;else if(Nf(t,n,"appendMissingElements")){var i=t.appendMissingElements.values||[];r=new Bl(i.map(function(t){return e.fromValue(t)}))}else Nf(t,n,"removeAllFromArray")?(i=t.removeAllFromArray.values||[],r=new ql(i.map(function(t){return e.fromValue(t)}))):Kc("Unknown transform proto: "+JSON.stringify(t));var o=xh.fromServerFormat(t.fieldPath);return new Pl(o,r)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;Hc(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return dl.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(Oh.EMPTY_PATH);else{var n=t.path;Hc(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){Hc(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new dl(e,a,o,s,u,c)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case pl.Listen:return null;case pl.ExistenceFilterMismatch:return"existence-filter-mismatch";case pl.LimboResolution:return"limbo-document";default:return Kc("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return(e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof gl?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):Kc("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new wl(r,n)},t.prototype.toDirection=function(t){return Ef[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return _l.ASCENDING;case"DESCENDING":return _l.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return Tf[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return ml.EQUAL;case"GREATER_THAN":return ml.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return ml.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return ml.LESS_THAN;case"LESS_THAN_OR_EQUAL":return ml.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return ml.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return Kc("Unspecified relation");default:return Kc("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return xh.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new El(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof gl?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:Kc("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new gl(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof bl?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof vl?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:Kc("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new bl(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new vl(n);case"OPERATOR_UNSPECIFIED":return Kc("Unspecified filter");default:return Kc("Unknown filter")}},t.prototype.toDocumentMask=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.canonicalString())}),{fieldPaths:e}},t.prototype.fromDocumentMask=function(t){var e=(t.fieldPaths||[]).map(function(t){return xh.fromServerFormat(t)});return Rl.fromArray(e)},t}();function Nf(t,e,n){return e===n||!e&&n in t}var Df=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){Hc(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){Hc(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){Hc(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){Hc(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){Hc(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){Hc(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),Rf="Connection",Pf={BatchGetDocuments:"batchGet",Commit:"commit"},kf="gl-js/ fire/"+Fc,Of=function(){function t(t){this.databaseId=t.databaseId,this.pool=new Mc;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=kf},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(o,a){r.pool.getObject(function(s){s.listenOnce(Lc.COMPLETE,function(){try{switch(s.getLastErrorCode()){case Oc.NO_ERROR:var e=s.getResponseJson();qc(Rf,"XHR received:",JSON.stringify(e)),o(e);break;case Oc.TIMEOUT:qc(Rf,'RPC "'+t+'" timed out'),a(new zc(Qc.DEADLINE_EXCEEDED,"Request time out"));break;case Oc.HTTP_ERROR:var n=s.getStatus();qc(Rf,'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0?a(new zc(function(t){switch(t){case 200:return Qc.OK;case 400:return Qc.INVALID_ARGUMENT;case 401:return Qc.UNAUTHENTICATED;case 403:return Qc.PERMISSION_DENIED;case 404:return Qc.NOT_FOUND;case 409:return Qc.ABORTED;case 416:return Qc.OUT_OF_RANGE;case 429:return Qc.RESOURCE_EXHAUSTED;case 499:return Qc.CANCELLED;case 500:return Qc.UNKNOWN;case 501:return Qc.UNIMPLEMENTED;case 503:return Qc.UNAVAILABLE;case 504:return Qc.DEADLINE_EXCEEDED;default:return t>=200&&t<300?Qc.OK:t>=400&&t<500?Qc.FAILED_PRECONDITION:t>=500&&t<600?Qc.INTERNAL:Qc.UNKNOWN}}(n),"Server responded with status "+s.getStatusText())):(qc(Rf,'RPC "'+t+'" failed'),a(new zc(Qc.UNAVAILABLE,"Connection failed.")));break;default:Kc('RPC "'+t+'" failed with unanticipated webchannel error '+s.getLastErrorCode()+": "+s.getLastError()+", giving up.")}}finally{qc(Rf,'RPC "'+t+'" completed.'),r.pool.releaseObject(s)}});var u=JSON.stringify(e);qc(Rf,"XHR sending: ",i+" "+u);var c={"Content-Type":"text/plain"};r.modifyHeadersForRequest(c,n),s.send(i,"POST",u,c,15)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=kc(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e),un()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");qc(Rf,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new Df({sendFn:function(t){u?qc(Rf,"Not sending because WebChannel is closed:",t):(s||(qc(Rf,"Opening WebChannel transport."),a.open(),s=!0),qc(Rf,"WebChannel sending:",t),a.send(t))},closeFn:function(){return a.close()}}),h=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return h(xc.EventType.OPEN,function(){u||qc(Rf,"WebChannel transport opened.")}),h(xc.EventType.CLOSE,function(){u||(u=!0,qc(Rf,"WebChannel transport closed"),c.callOnClose())}),h(xc.EventType.ERROR,function(t){u||(u=!0,qc(Rf,"WebChannel transport errored:",t),c.callOnClose(new zc(Qc.UNAVAILABLE,"The operation could not be completed")))}),h(xc.EventType.MESSAGE,function(t){if(!u){var e=t.data[0];Hc(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){qc(Rf,"WebChannel received error:",n);var r=n.status,i=function(t){var e=Wl[r];if(void 0!==e)return Gl(e)}(),o=n.message;void 0===i&&(i=Qc.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),u=!0,c.callOnClose(new zc(i,o)),a.close()}else qc(Rf,"WebChannel received:",e),c.callOnMessage(e)}}),setTimeout(function(){c.callOnOpen()},0),c},t.prototype.makeUrl=function(t){var e=Pf[t];Hc(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),Lf=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.loadConnection=function(t){return Promise.resolve(new Of(t))},t.prototype.newSerializer=function(t){return new Af(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();Gc.setPlatform(new Lf);var xf,Mf=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.setPreviousValue(t)},this.writeNewSequenceNumber=function(t){return e.writeSequenceNumber(t)})}return t.prototype.setPreviousValue=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(t),t},t.INVALID=-1,t}(),Ff=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})};!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout",t.ClientMetadataRefresh="client_metadata_refresh",t.LruGarbageCollection="lru_garbage_collection"}(xf||(xf={}));var Uf=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ff,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new zc(Qc.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),Vf=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw jc("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),Hc(e>=0,"Attempted to schedule an operation with a negative delay of "+e),Hc(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=Uf.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&Kc("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){Hc(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){for(var e=0,n=this.delayedOperations;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){Hc(t===xf.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==xf.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);Hc(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),Bf="",qf="",jf="",Wf="";function Kf(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Gf(e)),e=Hf(t.get(n),e);return Gf(e)}function Hf(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=Bf+jf;break;case Bf:n+=Bf+Wf;break;default:n+=o}}return n}function Gf(t){return t+Bf+qf}function $f(t){var e=t.length;if(Hc(e>=2,"Invalid path "+t),2===e)return Hc(t.charAt(0)===Bf&&t.charAt(1)===qf,"Non-empty path "+t+" had length 2"),Oh.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(Bf,o);switch((a<0||a>n)&&Kc('Invalid encoded resource path: "'+t+'"'),t.charAt(a+1)){case qf:var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case jf:i+=t.substring(o,a),i+="\0";break;case Wf:i+=t.substring(o,a+1);break;default:Kc('Invalid encoded resource path: "'+t+'"')}o=a+2}return new Oh(r)}var Qf,zf=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n,Hc(n.length>0,"Cannot create an empty mutation batch")}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&Hc(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;Hc(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&Hc(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=e,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t)&&(e=i.applyToLocalView(e,n,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=ef(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&_h(this.mutations,t.mutations)},t}(),Yf=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){Hc(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Zl(),a=e.mutations,s=0;s<a.length;s++)o=o.insert(a[s].key,r[s].version);return new t(e,n,r,i,o)},t}(),Xf=1;!function(t){t[t.QueryCache=0]="QueryCache",t[t.SyncEngine=1]="SyncEngine"}(Qf||(Qf={}));var Jf=function(){function t(t,e){this.generatorId=t,Hc((t&Xf)===t,"Generator ID "+t+" contains more than "+Xf+" reserved bits"),this.seek(void 0!==e?e:this.generatorId)}return t.prototype.next=function(){var t=this.nextId;return this.nextId+=1<<Xf,t},t.prototype.after=function(t){return this.seek(t+(1<<Xf)),this.next()},t.prototype.seek=function(t){Hc((t&Xf)===this.generatorId,"Cannot supply target ID from different generator ID"),this.nextId=t},t.forQueryCache=function(){return new t(Qf.QueryCache,2)},t.forSyncEngine=function(){return new t(Qf.SyncEngine)},t}(),Zf=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Kc("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.waitFor(r)},t}(),tp=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return Hc(t.isAvailable(),"IndexedDB not supported in current environment."),qc("SimpleDb","Opening database:",e),new Zf(function(i,o){var a=window.indexedDB.open(e,n);a.onsuccess=function(e){var n=e.target.result;i(new t(n))},a.onblocked=function(){o(new zc(Qc.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new zc(Qc.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},a.onupgradeneeded=function(t){qc("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new np(a.transaction);r.createOrUpgrade(n,i,t.oldVersion,_p).next(function(){qc("SimpleDb","Database upgrade to version "+_p+" complete")})}}).toPromise()},t.delete=function(t){return qc("SimpleDb","Removing database:",t),ip(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.getStore=function(t,e){return t.store(e)},t.prototype.runTransaction=function(t,e,n){var r=np.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(t),Zf.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),ep=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return ip(this.dbCursor.delete())},t}(),np=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionDeferred=new Ff,this.transaction.oncomplete=function(){e.completionDeferred.resolve()},this.transaction.onabort=function(){t.error?e.completionDeferred.reject(t.error):e.completionDeferred.resolve()},this.transaction.onerror=function(t){e.completionDeferred.reject(t.target.error)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"completionPromise",{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.completionDeferred.reject(t),this.aborted||(qc("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return Hc(!!e,"Object store not part of transaction: "+t),new rp(e)},t}(),rp=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(qc("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(qc("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ip(n)},t.prototype.add=function(t){return qc("SimpleDb","ADD",this.store.name,t,t),ip(this.store.add(t))},t.prototype.get=function(t){var e=this;return ip(this.store.get(t)).next(function(n){return void 0===n&&(n=null),qc("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return qc("SimpleDb","DELETE",this.store.name,t),ip(this.store.delete(t))},t.prototype.count=function(){return qc("SimpleDb","COUNT",this.store.name),ip(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){qc("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateSerial=function(t){var e=this.cursor({});return new Zf(function(n,r){e.onerror=function(t){r(t.target.error)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.iterateCursor=function(t,e){var n=[];return new Zf(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new ep(i),a=e(i.primaryKey,i.value,o);if(a instanceof Zf){var s=a.catch(function(t){return o.done(),Zf.reject(t)});n.push(s)}o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}else r()}}).next(function(){return Zf.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(Hc(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ip(t){return new Zf(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}var op=function(){function t(t,e){this.referenceDelegate=t,this.serializer=e,this.targetIdGenerator=Jf.forQueryCache()}return t.prototype.allocateTargetId=function(t){var e=this;return this.retrieveMetadata(t).next(function(n){return n.highestTargetId=e.targetIdGenerator.after(n.highestTargetId),e.saveMetadata(t,n).next(function(){return n.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.retrieveMetadata(t).next(function(t){return Cl.fromTimestamp(new Nh(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(t){return up(t.simpleDbTransaction)},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.retrieveMetadata(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.saveMetadata(t,i)})},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.retrieveMetadata(t).next(function(r){return r.targetCount+=1,n.updateMetadataFromQueryData(e,r),n.saveMetadata(t,r)})})},t.prototype.updateQueryData=function(t,e){return this.saveQueryData(t,e)},t.prototype.removeQueryData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return ap(t).delete(e.targetId)}).next(function(){return n.retrieveMetadata(t)}).next(function(e){return Hc(e.targetCount>0,"Removing from an empty query cache"),e.targetCount-=1,n.saveMetadata(t,e)})},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return ap(t).iterate(function(a,s){var u=r.serializer.fromDbTarget(s);u.sequenceNumber<=e&&void 0===n[u.targetId]&&(i++,o.push(r.removeQueryData(t,u)))}).next(function(){return Zf.waitFor(o)}).next(function(){return i})},t.prototype.forEachTarget=function(t,e){var n=this;return ap(t).iterate(function(t,r){var i=n.serializer.fromDbTarget(r);e(i)})},t.prototype.retrieveMetadata=function(t){return sp(t.simpleDbTransaction)},t.prototype.saveMetadata=function(t,e){return(n=t,rd.getStore(n,Op.store)).put(Op.key,e);var n},t.prototype.saveQueryData=function(t,e){return ap(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getQueryCount=function(t){return this.retrieveMetadata(t).next(function(t){return t.targetCount})},t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return ap(t).iterate({range:i,index:Pp.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=cp(t);return e.forEach(function(e){var a=Kf(e.path);i.push(o.put(new kp(n,a))),i.push(r.referenceDelegate.addReference(t,e))}),Zf.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=cp(t);return Zf.forEach(e,function(e){var o=Kf(e.path);return Zf.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,e)])})},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=cp(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=cp(t),i=ef();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=$f(t[1]),o=new Mh(r);i=i.add(o)}).next(function(){return i})},t.prototype.containsKey=function(t,e){var n,r=Kf(e.path),i=IDBKeyRange.bound([r],[(n=r,n+"\0")],!1,!0),o=0;return cp(t).iterate({index:kp.documentTargetsIndex,keysOnly:!0,range:i},function(t,e,n){var r=t[0];t[1],0!==r&&(o++,n.done())}).next(function(){return o>0})},t.prototype.getQueryDataForTarget=function(t,e){var n=this;return ap(t).get(e).next(function(t){return t?n.serializer.fromDbTarget(t):null})},t}();function ap(t){return rd.getStore(t,Pp.store)}function sp(t){return tp.getStore(t,Op.store).get(Op.key).next(function(t){return Hc(null!==t,"Missing metadata row."),t})}function up(t){return sp(t).next(function(t){return t.highestListenSequenceNumber})}function cp(t){return rd.getStore(t,kp.store)}var hp=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){th(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return eh(this.inner)},t}(),lp=function(){function t(){this.changes=Ql(),this.documentSizes=new hp(function(t){return t.toString()})}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this,r=this.assertChanges().get(e);return r?Zf.resolve(r):this.getFromCache(t,e).next(function(t){return null===t?(n.documentSizes.set(e,0),null):(n.documentSizes.set(e,t.size),t.maybeDocument)})},t.prototype.getEntries=function(t,e){var n=this;return this.getAllFromCache(t,e).next(function(t){var e=t.maybeDocuments;return t.sizeMap.forEach(function(t,e){n.documentSizes.set(t,e)}),e})},t.prototype.apply=function(t){var e=this.applyChanges(t);return this.changes=null,e},t.prototype.assertChanges=function(){return Hc(null!==this.changes,"Changes have already been applied."),this.changes},t}(),fp="The remote document changelog no longer contains all changes for all local query views. It may be necessary to rebuild these views.",pp=function(){function t(t,e){this.serializer=t,this.keepDocumentChangeLog=e,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(t.prototype,"lastProcessedDocumentChangeId",{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),t.prototype.start=function(t){var e=tp.getStore(t,xp.store);return this.synchronizeLastDocumentChangeId(e)},t.prototype.addEntries=function(t,e,n){var r=[];if(e.length>0){for(var i=mp(t),o=ef(),a=0,s=e;a<s.length;a++){var u=s[a],c=u.key,h=u.doc;r.push(i.put(vp(c),h)),o=o.add(c)}this.keepDocumentChangeLog&&r.push(gp(t).put({changes:this.serializer.toDbResourcePaths(o)})),r.push(this.updateSize(t,n))}return Zf.waitFor(r)},t.prototype.removeEntry=function(t,e){var n=mp(t),r=vp(e);return n.get(r).next(function(t){return t?n.delete(r).next(function(){return bp(t)}):Zf.resolve(0)})},t.prototype.getEntry=function(t,e){var n=this;return mp(t).get(vp(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getSizedEntry=function(t,e){var n=this;return mp(t).get(vp(e)).next(function(t){return t?{maybeDocument:n.serializer.fromDbRemoteDocument(t),size:bp(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=zl();return this.forEachDbEntry(t,e,function(t,e){r=e?r.insert(t,n.serializer.fromDbRemoteDocument(e)):r.insert(t,null)}).next(function(){return r})},t.prototype.getSizedEntries=function(t,e){var n=this,r=zl(),i=new qh(Mh.comparator);return this.forEachDbEntry(t,e,function(t,e){e?(r=r.insert(t,n.serializer.fromDbRemoteDocument(e)),i=i.insert(t,bp(e))):(r=r.insert(t,null),i=i.insert(t,0))}).next(function(){return{maybeDocuments:r,sizeMap:i}})},t.prototype.forEachDbEntry=function(t,e,n){if(e.isEmpty())return Zf.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return mp(t).iterate({range:r},function(t,e,r){for(var a=Mh.fromSegments(t);o&&Mh.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.skip(o.path.toArray()):r.done()}).next(function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=Xl(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return mp(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof Uh&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t.prototype.getNewDocumentChanges=function(t){var e=this;Hc(this.keepDocumentChangeLog,"Can only call getNewDocumentChanges() when document change log is enabled");var n=ef(),r=Ql(),i=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),o=!0,a=gp(t);return a.iterate({range:i},function(t,r){if(o&&(o=!1,e._lastProcessedDocumentChangeId+1!==r.id))return e.synchronizeLastDocumentChangeId(a).next(function(){return Zf.reject(new zc(Qc.DATA_LOSS,fp))});n=n.unionWith(e.serializer.fromDbResourcePaths(r.changes)),e._lastProcessedDocumentChangeId=r.id}).next(function(){var i=[];return n.forEach(function(n){i.push(e.getEntry(t,n).next(function(t){var e=t||new Vh(n,Cl.forDeletedDoc());r=r.insert(n,e)}))}),Zf.waitFor(i)}).next(function(){return r})},t.prototype.removeDocumentChangesThroughChangeId=function(t,e){var n=IDBKeyRange.upperBound(e);return gp(t).delete(n)},t.prototype.synchronizeLastDocumentChangeId=function(t){var e=this;return this._lastProcessedDocumentChangeId=0,t.iterate({keysOnly:!0,reverse:!0},function(t,n,r){e._lastProcessedDocumentChangeId=t,r.done()})},t.prototype.newChangeBuffer=function(){return new yp(this)},t.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return dp(t).get(Rp.key).next(function(t){return Hc(!!t,"Missing document cache metadata"),t})},t.prototype.setMetadata=function(t,e){return dp(t).put(Rp.key,e)},t.prototype.updateSize=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.setMetadata(t,r)})},t}();function dp(t){return rd.getStore(t,Rp.store)}var yp=function(t){function e(e){var n=t.call(this)||this;return n.documentCache=e,n}return $e(e,t),e.prototype.applyChanges=function(t){var e=this,n=0,r=[];return this.assertChanges().forEach(function(t,i){var o=e.documentCache.serializer.toDbRemoteDocument(i),a=e.documentSizes.get(t);Hc(void 0!==a,"Attempting to change document "+t.toString()+" without having read it first");var s=bp(o);n+=s-a,r.push({key:t,doc:o})}),this.documentCache.addEntries(t,r,n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(lp);function mp(t){return rd.getStore(t,Dp.store)}function gp(t){return rd.getStore(t,xp.store)}function vp(t){return t.path.toArray()}function bp(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Kc("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var _p=7,wp=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Hc(n<r&&n>=0&&r<=_p,"Unexpected schema upgrade from v"+n+" to v{toVersion}."),n<1&&r>=1&&(function(t){t.createObjectStore(Tp.store)}(t),function(t){t.createObjectStore(Sp.store,{keyPath:Sp.keyPath}),t.createObjectStore(Cp.store,{keyPath:Cp.keyPath,autoIncrement:!0}).createIndex(Cp.userMutationsIndex,Cp.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ip.store)}(t),Lp(t),function(t){t.createObjectStore(Dp.store)}(t));var o=Zf.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(kp.store),t.deleteObjectStore(Pp.store),t.deleteObjectStore(Op.store)}(t),Lp(t)),o=o.next(function(){return function(t){var e=t.store(Op.store),n=new Op(0,0,Cl.MIN.toTimestamp(),0);return e.put(Op.key,n)}(e)})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return function(t,e){return e.store(Cp.store).loadAll().next(function(n){t.deleteObjectStore(Cp.store),t.createObjectStore(Cp.store,{keyPath:Cp.keyPath,autoIncrement:!0}).createIndex(Cp.userMutationsIndex,Cp.userMutationsKeyPath,{unique:!0});var r=e.store(Cp.store),i=n.map(function(t){return r.put(t)});return Zf.waitFor(i)})}(t,e)})),o=o.next(function(){!function(t){t.createObjectStore(Mp.store,{keyPath:Mp.keyPath})}(t),function(t){t.createObjectStore(xp.store,{keyPath:"id",autoIncrement:!0})}(t)})),n<5&&r>=5&&(o=o.next(function(){return i.removeAcknowledgedMutations(e)})),n<6&&r>=6&&(o=o.next(function(){return function(t){t.createObjectStore(Rp.store)}(t),i.addDocumentGlobal(e)})),n<7&&r>=7&&(o=o.next(function(){return i.ensureSequenceNumbers(e)})),o},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Dp.store).iterate(function(t,n){e+=bp(n)}).next(function(){var n=new Rp(e);return t.store(Rp.store).put(Rp.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Sp.store),r=t.store(Cp.store);return n.loadAll().next(function(n){return Zf.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.loadAll(Cp.userMutationsIndex,i).next(function(r){return Zf.forEach(r,function(r){Hc(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.fromDbMutationBatch(r);return Bp(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(kp.store),n=t.store(Dp.store);return up(t).next(function(t){var r=[];return n.iterate(function(n,i){var o=new Oh(n),a=[0,Kf(o)];r.push(e.get(a).next(function(n){return n?Zf.resolve():function(n){return e.put(new kp(0,Kf(n),t))}(o)}))}).next(function(){return Zf.waitFor(r)})})},t}(),Ep=function(t,e){this.seconds=t,this.nanoseconds=e},Tp=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}(),Sp=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Cp=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}(),Ip=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Kf(e)]},t.key=function(t,e,n){return[t,Kf(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),Ap=function(t,e){this.path=t,this.readTime=e},Np=function(t,e){this.path=t,this.version=e},Dp=function(){function t(t,e,n,r){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r}return t.store="remoteDocuments",t}(),Rp=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}(),Pp=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),kp=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,Hc(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Op=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}();function Lp(t){t.createObjectStore(kp.store,{keyPath:kp.keyPath}).createIndex(kp.documentTargetsIndex,kp.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Pp.store,{keyPath:Pp.keyPath}).createIndex(Pp.queryTargetsIndexName,Pp.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Op.store)}var xp=function(){function t(t){this.changes=t}return t.store="remoteDocumentChanges",t.keyPath="id",t}(),Mp=function(){function t(t,e,n,r,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r,this.lastProcessedDocumentChangeId=i}return t.store="clientMetadata",t.keyPath="clientId",t}(),Fp=[Sp.store,Cp.store,Ip.store,Dp.store,Pp.store,Tp.store,Op.store,kp.store].concat([Mp.store,xp.store]).concat([Rp.store]),Up=function(){function t(t,e,n){this.userId=t,this.serializer=e,this.referenceDelegate=n,this.documentKeysByBatchId={}}return t.forUser=function(e,n,r){return Hc(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n,r)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jp(t).iterate({index:Cp.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.acknowledgeBatch=function(t,e,n){return this.getMutationQueueMetadata(t).next(function(e){return e.lastStreamToken=qp(n),Kp(t).put(e)})},t.prototype.getLastStreamToken=function(t){return this.getMutationQueueMetadata(t).next(function(t){return t.lastStreamToken})},t.prototype.setLastStreamToken=function(t,e){return this.getMutationQueueMetadata(t).next(function(n){return n.lastStreamToken=qp(e),Kp(t).put(n)})},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=Wp(t),o=jp(t);return o.add({}).next(function(t){Hc("number"==typeof t,"Auto-generated key is not a number");var a=new zf(t,e,n),s=r.serializer.toDbMutationBatch(r.userId,a);r.documentKeysByBatchId[t]=a.keys();for(var u=[],c=0,h=n;c<h.length;c++){var l=h[c],f=Ip.key(r.userId,l.key.path,t);u.push(o.put(s)),u.push(i.put(f,Ip.PLACEHOLDER))}return Zf.waitFor(u).next(function(){return a})})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return jp(t).get(e).next(function(t){return t?(Hc(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.fromDbMutationBatch(t)):null})},t.prototype.lookupMutationKeys=function(t,e){var n=this;return this.documentKeysByBatchId[e]?Zf.resolve(this.documentKeysByBatchId[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){var r=t.keys();return n.documentKeysByBatchId[e]=r,r}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this;return this.getMutationQueueMetadata(t).next(function(r){var i=e+1,o=IDBKeyRange.lowerBound([n.userId,i]),a=null;return jp(t).iterate({index:Cp.userMutationsIndex,range:o},function(t,e,r){e.userId===n.userId&&(Hc(e.batchId>=i,"Should have found mutation after "+i),a=n.serializer.fromDbMutationBatch(e)),r.done()}).next(function(){return a})})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jp(t).loadAll(Cp.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ip.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Wp(t).iterate({range:i},function(r,i,a){var s=r[0],u=r[1],c=r[2],h=$f(u);if(s===n.userId&&e.path.isEqual(h))return jp(t).get(c).next(function(t){if(!t)throw Kc("Dangling document-mutation reference found: "+r+" which points to "+c);Hc(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.fromDbMutationBatch(t))});a.done()}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Nl(bh),i=[];return e.forEach(function(e){var o=Ip.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Wp(t).iterate({range:a},function(t,i,o){var a=t[0],s=t[1],u=t[2],c=$f(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()});i.push(s)}),Zf.waitFor(i).next(function(){return n.lookupMutationBatches(t,r)})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;Hc(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=Ip.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Nl(bh);return Wp(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],h=$f(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.lookupMutationBatches(t,s)})},t.prototype.lookupMutationBatches=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(jp(t).get(e).next(function(t){if(null===t)throw Kc("Dangling document-mutation reference found, which points to "+e);Hc(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.fromDbMutationBatch(t))}))}),Zf.waitFor(i).next(function(){return r})},t.prototype.removeMutationBatch=function(t,e){var n=this;return Bp(t.simpleDbTransaction,this.userId,e).next(function(r){return n.removeCachedMutationKeys(e.batchId),Zf.forEach(r,function(e){return n.referenceDelegate.removeMutationReference(t,e)})})},t.prototype.removeCachedMutationKeys=function(t){delete this.documentKeysByBatchId[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return Zf.resolve();var r=IDBKeyRange.lowerBound(Ip.prefixForUser(e.userId)),i=[];return Wp(t).iterate({range:r},function(t,n,r){if(t[0]===e.userId){var o=$f(t[1]);i.push(o)}else r.done()}).next(function(){Hc(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.containsKey=function(t,e){return Vp(t,this.userId,e)},t.prototype.getMutationQueueMetadata=function(t){var e=this;return Kp(t).get(this.userId).next(function(t){return t||new Sp(e.userId,-1,"")})},t}();function Vp(t,e,n){var r=Ip.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Wp(t).iterate({range:o,keysOnly:!0},function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()}).next(function(){return a})}function Bp(t,e,n){var r=t.store(Cp.store),i=t.store(Ip.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.iterate({range:a},function(t,e,n){return s++,n.delete()});o.push(u.next(function(){Hc(1===s,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Ip.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return Zf.waitFor(o).next(function(){return c})}function qp(t){return t instanceof Uint8Array?(Hc("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence."),t.toString()):t}function jp(t){return rd.getStore(t,Cp.store)}function Wp(t){return rd.getStore(t,Ip.store)}function Kp(t){return rd.getStore(t,Sp.store)}var Hp=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Mh.fromSegments(t.noDocument.path),n=this.fromDbTimestamp(t.noDocument.readTime);return new Vh(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=Mh.fromSegments(t.unknownDocument.path),n=this.fromDbTimestamp(t.unknownDocument.version),new Bh(e,n)):Kc("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof Uh){var e=t.proto?t.proto:this.remoteSerializer.toDocument(t),n=t.hasCommittedMutations;return new Dp(null,null,e,n)}if(t instanceof Vh){var r=t.key.path.toArray(),i=this.toDbTimestamp(t.version);return n=t.hasCommittedMutations,new Dp(null,new Ap(r,i),null,n)}return t instanceof Bh?(r=t.key.path.toArray(),i=this.toDbTimestamp(t.version),new Dp(new Np(r,i),null,null,!0)):Kc("Unexpected MaybeDocumment")},t.prototype.toDbTimestamp=function(t){var e=t.toTimestamp();return new Ep(e.seconds,e.nanoseconds)},t.prototype.fromDbTimestamp=function(t){var e=new Nh(t.seconds,t.nanoseconds);return Cl.fromTimestamp(e)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Cp(t,e.batchId,e.localWriteTime.toMillis(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=Nh.fromMillis(t.localWriteTimeMs);return new zf(t.batchId,r,n)},t.prototype.toDbResourcePaths=function(t){var e=[];return t.forEach(function(t){e.push(Kf(t.path))}),e},t.prototype.fromDbResourcePaths=function(t){for(var e=ef(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new Mh($f(i)))}return e},t.prototype.fromDbTarget=function(t){var e,n=this.fromDbTimestamp(t.readTime);return e=void 0!==t.query.documents?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new Al(e,t.targetId,pl.Listen,t.lastListenSequenceNumber,n,t.resumeToken)},t.prototype.toDbTarget=function(t){Hc(pl.Listen===t.purpose,"Only queries with purpose "+pl.Listen+" may be stored, got "+t.purpose);var e,n,r=this.toDbTimestamp(t.snapshotVersion);return e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),t.resumeToken instanceof Uint8Array?(Hc("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=t.resumeToken.toString()):n=t.resumeToken,new Pp(t.targetId,t.query.canonicalId(),r,n,t.sequenceNumber,e)},t}();function Gp(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=bh(n,i);return 0===a?bh(r,o):a}var $p=function(){function t(t){this.maxElements=t,this.buffer=new Nl(Gp),this.previousIndex=0}return t.prototype.nextIndex=function(){return++this.previousIndex},t.prototype.addElement=function(t){var e=[t,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Gp(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),Qp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zp=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t.COLLECTION_DISABLED=-1,t.MINIMUM_CACHE_SIZE_BYTES=1048576,t.DEFAULT_CACHE_SIZE_BYTES=41943040,t.DEFAULT_COLLECTION_PERCENTILE=10,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,t.DEFAULT=new t(t.DEFAULT_CACHE_SIZE_BYTES,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),t.DISABLED=new t(t.COLLECTION_DISABLED,0,0),t}(),Yp=function(){function t(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.gcTask=null}return t.prototype.start=function(){Hc(null===this.gcTask,"Cannot start an already started LruScheduler"),this.garbageCollector.params.cacheSizeCollectionThreshold!==zp.COLLECTION_DISABLED&&this.scheduleGC()},t.prototype.stop=function(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.gcTask},enumerable:!0,configurable:!0}),t.prototype.scheduleGC=function(){var t=this;Hc(null===this.gcTask,"Cannot schedule GC while a task is pending");var e=this.hasRun?3e5:6e4;qc("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.gcTask=this.asyncQueue.enqueueAfterDelay(xf.LruGarbageCollection,e,function(){return t.gcTask=null,t.hasRun=!0,t.localStore.collectGarbage(t.garbageCollector).then(function(){return t.scheduleGC()}).catch(id)})},t}(),Xp=function(){function t(t,e){this.delegate=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.delegate.getSequenceNumberCount(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Zf.resolve(Mf.INVALID);var r=new $p(e);return this.delegate.forEachTarget(t,function(t){return r.addElement(t.sequenceNumber)}).next(function(){return n.delegate.forEachOrphanedDocumentSequenceNumber(t,function(t){return r.addElement(t)})}).next(function(){return r.maxValue})},t.prototype.removeTargets=function(t,e,n){return this.delegate.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.delegate.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return this.params.cacheSizeCollectionThreshold===zp.COLLECTION_DISABLED?(qc("LruGarbageCollector","Garbage collection skipped; disabled"),Zf.resolve(Qp)):this.getCacheSize(t).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(qc("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Qp):n.runGarbageCollection(t,e)})},t.prototype.getCacheSize=function(t){return this.delegate.getCacheSize(t)},t.prototype.runGarbageCollection=function(t,e){var n,r,i,o,a,s,u,c,h=this;return o=Date.now(),this.calculateTargetCount(t,this.params.percentileToCollect).next(function(e){return e>h.params.maximumSequenceNumbersToCollect?(qc("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),r=h.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),h.nthSequenceNumber(t,r)}).next(function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)}).next(function(e){return i=e,u=Date.now(),h.removeOrphanedDocuments(t,n)}).next(function(t){return c=Date.now(),Vc()<=Dc.DEBUG&&qc("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-o)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-o)+"ms"),Zf.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})})},t}(),Jp="IndexedDbPersistence",Zp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",td="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.",ed="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",nd=function(t){function e(e,n){var r=t.call(this)||this;return r.simpleDbTransaction=e,r.currentSequenceNumber=n,r}return $e(e,t),e}(function(){}),rd=function(){function t(e,n,r,i,o,a,s){if(this.persistenceKey=e,this.clientId=n,this.queue=i,this.multiClientParams=s,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=Number.NEGATIVE_INFINITY,this.primaryStateListener=function(t){return Promise.resolve()},!t.isAvailable())throw new zc(Qc.UNIMPLEMENTED,ed);if(this.referenceDelegate=new sd(this,a),this.dbName=e+t.MAIN_DATABASE,this.serializer=new Hp(o),this.document=r.document,this.allowTabSynchronization=void 0!==s,this.queryCache=new op(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new pp(this.serializer,this.allowTabSynchronization),!r.window||!r.window.localStorage)throw new zc(Qc.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.webStorage=this.window.localStorage}return t.getStore=function(t,e){if(t instanceof nd)return tp.getStore(t.simpleDbTransaction,e);throw Kc("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.createIndexedDbPersistence=function(e,n,r,i,o,a){return ze(this,void 0,void 0,function(){var s;return Ye(this,function(u){switch(u.label){case 0:return[4,(s=new t(e,n,r,i,o,a)).start()];case 1:return u.sent(),[2,s]}})})},t.createMultiClientIndexedDbPersistence=function(e,n,r,i,o,a,s){return ze(this,void 0,void 0,function(){var u;return Ye(this,function(c){switch(c.label){case 0:return[4,(u=new t(e,n,r,i,o,a,s)).start()];case 1:return c.sent(),[2,u]}})})},t.prototype.start=function(){var t=this;return Hc(!this.started,"IndexedDbPersistence double-started!"),Hc(null!==this.window,"Expected 'window' to be defined"),tp.openOrCreate(this.dbName,_p,new wp(this.serializer)).then(function(e){t.simpleDb=e}).then(function(){return t.startRemoteDocumentCache()}).then(function(){return t.attachVisibilityHandler(),t.attachWindowUnloadHook(),t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return t.simpleDb.runTransaction("readonly",[Op.store],function(e){return up(e).next(function(e){var n=t.multiClientParams?t.multiClientParams.sequenceNumberSyncer:void 0;t.listenSequence=new Mf(e,n)})})}).then(function(){t._started=!0}).catch(function(e){return t.simpleDb&&t.simpleDb.close(),Promise.reject(e)})},t.prototype.startRemoteDocumentCache=function(){var t=this;return this.simpleDb.runTransaction("readonly",Fp,function(e){return t.remoteDocumentCache.start(e)})},t.prototype.setPrimaryStateListener=function(t){var e=this;return this.primaryStateListener=function(n){return ze(e,void 0,void 0,function(){return Ye(this,function(e){return this.started?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.queue.enqueueAndForget(function(){return ze(e,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.updateClientMetadataAndTryBecomePrimary=function(){var t=this;return this.simpleDb.runTransaction("readwrite",Fp,function(e){return ad(e).put(new Mp(t.clientId,Date.now(),t.networkEnabled,t.inForeground,t.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(t.isPrimary)return t.verifyPrimaryLease(e).next(function(e){e||(t.isPrimary=!1,t.queue.enqueueAndForget(function(){return t.primaryStateListener(!1)}))})}).next(function(){return t.canActAsPrimary(e)}).next(function(n){var r=t.isPrimary;return t.isPrimary=n,r!==t.isPrimary&&t.queue.enqueueAndForget(function(){return t.primaryStateListener(t.isPrimary)}),r&&!t.isPrimary?t.releasePrimaryLeaseIfHeld(e):t.isPrimary?t.acquireOrExtendPrimaryLease(e):void 0})})},t.prototype.verifyPrimaryLease=function(t){var e=this;return od(t).get(Tp.key).next(function(t){return Zf.resolve(e.isLocalClient(t))})},t.prototype.removeClientMetadata=function(t){return ad(t).delete(this.clientId)},t.prototype.maybeGarbageCollectMultiClientState=function(){return ze(this,void 0,void 0,function(){var e,n,r=this;return Ye(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,18e5)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),n=[],[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(i){var o=t.getStore(i,Mp.store);return o.loadAll().next(function(t){e=r.filterActiveClients(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)})}).next(function(){return Zf.forEach(n,function(t){return o.delete(t.clientId)})}).next(function(){if((e=e.filter(function(t){return t.clientId!==r.clientId})).length>0){var t=e.map(function(t){return t.lastProcessedDocumentChangeId||0}),n=Math.min.apply(Math,t);return r.remoteDocumentCache.removeDocumentChangesThroughChangeId(i,n)}})})]);case 1:i.sent(),n.forEach(function(t){r.window.localStorage.removeItem(r.zombiedClientLocalStorageKey(t.clientId))}),i.label=2;case 2:return[2]}})})},t.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var t=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(xf.ClientMetadataRefresh,4e3,function(){return t.updateClientMetadataAndTryBecomePrimary().then(function(){return t.maybeGarbageCollectMultiClientState()}).then(function(){return t.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},t.prototype.isLocalClient=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.canActAsPrimary=function(t){var e=this;return od(t).get(Tp.key).next(function(n){if(null!==n&&e.isWithinAge(n.leaseTimestampMs,5e3)&&!e.isClientZombied(n.ownerId)){if(e.isLocalClient(n)&&e.networkEnabled)return!0;if(!e.isLocalClient(n)){if(!n.allowTabSynchronization)throw new zc(Qc.FAILED_PRECONDITION,td);return!1}}return!(!e.networkEnabled||!e.inForeground)||ad(t).loadAll().next(function(t){return void 0===e.filterActiveClients(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&qc(Jp,"Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.shutdown=function(t){return ze(this,void 0,void 0,function(){var e=this;return Ye(this,function(n){switch(n.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction("readwrite",[Tp.store,Mp.store],function(t){return e.releasePrimaryLeaseIfHeld(t).next(function(){return e.removeClientMetadata(t)})})];case 1:return n.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),t?[4,tp.delete(this.dbName)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.filterActiveClients=function(t,e){var n=this;return t.filter(function(t){return n.isWithinAge(t.updateTimeMs,e)&&!n.isClientZombied(t.clientId)})},t.prototype.getActiveClients=function(){var t=this;return this.simpleDb.runTransaction("readonly",[Mp.store],function(e){return ad(e).loadAll().next(function(e){return t.filterActiveClients(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getMutationQueue=function(t){return Hc(this.started,"Cannot initialize MutationQueue before persistence is started."),Up.forUser(t,this.serializer,this.referenceDelegate)},t.prototype.getQueryCache=function(){return Hc(this.started,"Cannot initialize QueryCache before persistence is started."),this.queryCache},t.prototype.getRemoteDocumentCache=function(){return Hc(this.started,"Cannot initialize RemoteDocumentCache before persistence is started."),this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;return qc(Jp,"Starting transaction:",t),this.simpleDb.runTransaction("readonly"===e?"readonly":"readwrite",Fp,function(i){return"readwrite-primary"===e?r.verifyPrimaryLease(i).next(function(e){if(!e)throw jc("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.queue.enqueueAndForget(function(){return r.primaryStateListener(!1)}),new zc(Qc.FAILED_PRECONDITION,Zp);return n(new nd(i,r.listenSequence.next()))}).next(function(t){return r.acquireOrExtendPrimaryLease(i).next(function(){return t})}):r.verifyAllowTabSynchronization(i).next(function(){return n(new nd(i,r.listenSequence.next()))})})},t.prototype.verifyAllowTabSynchronization=function(t){var e=this;return od(t).get(Tp.key).next(function(t){if(null!==t&&e.isWithinAge(t.leaseTimestampMs,5e3)&&!e.isClientZombied(t.ownerId)&&!e.isLocalClient(t)&&!t.allowTabSynchronization)throw new zc(Qc.FAILED_PRECONDITION,td)})},t.prototype.acquireOrExtendPrimaryLease=function(t){var e=new Tp(this.clientId,this.allowTabSynchronization,Date.now());return od(t).put(Tp.key,e)},t.isAvailable=function(){return tp.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.releasePrimaryLeaseIfHeld=function(t){var e=this,n=od(t);return n.get(Tp.key).next(function(t){return e.isLocalClient(t)?(qc(Jp,"Releasing primary lease."),n.delete(Tp.key)):Zf.resolve()})},t.prototype.isWithinAge=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(jc("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.attachVisibilityHandler=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){t.queue.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener("visibilitychange",this.documentVisibilityHandler),this.inForeground="visible"===this.document.visibilityState)},t.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(Hc(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.documentVisibilityHandler),this.documentVisibilityHandler=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){t.markClientZombied(),t.queue.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("unload",this.windowUnloadHandler))},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(Hc("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.isClientZombied=function(t){try{var e=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(t));return qc(Jp,"Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return jc(Jp,"Failed to get zombied client id.",t),!1}},t.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),String(Date.now()))}catch(t){jc("Failed to set zombie client id.",t)}},t.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(t){}},t.prototype.zombiedClientLocalStorageKey=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.MAIN_DATABASE="main",t}();function id(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){if(!function(t){return t.code===Qc.FAILED_PRECONDITION&&t.message===Zp}(t))throw t;return qc(Jp,"Unexpectedly lost primary lease"),[2]})})}function od(t){return t.store(Tp.store)}function ad(t){return t.store(Mp.store)}var sd=function(){function t(t,e){this.db=t,this.garbageCollector=new Xp(this,e)}return t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocmentCount(t);return this.db.getQueryCache().getQueryCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocmentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachTarget=function(t,e){return this.db.getQueryCache().forEachTarget(t,e)},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){return this.forEachOrphanedDocument(t,function(t,n){return e(n)})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return ud(t,e)},t.prototype.removeReference=function(t,e){return ud(t,e)},t.prototype.removeTargets=function(t,e,n){return this.db.getQueryCache().removeTargets(t,e,n)},t.prototype.removeMutationReference=function(t,e){return ud(t,e)},t.prototype.isPinned=function(t,e){return this.inMemoryPins.containsKey(e)?Zf.resolve(!0):function(t,e){var n=!1;return Kp(t).iterateSerial(function(r){return Vp(t,r,e).next(function(t){return t&&(n=!0),Zf.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=0,o=[];return this.forEachOrphanedDocument(t,function(a,s){if(s<=e){var u=n.isPinned(t,a).next(function(e){if(!e)return r++,n.removeOrphanedDocument(t,a).next(function(t){i+=t})});o.push(u)}}).next(function(){return Zf.waitFor(o)}).next(function(){return n.db.getRemoteDocumentCache().updateSize(t,-i)}).next(function(){return r})},t.prototype.removeOrphanedDocument=function(t,e){var n,r=0,i=this.db.getRemoteDocumentCache();return Zf.waitFor([cp(t).delete((n=e,[0,Kf(n.path)])),i.removeEntry(t,e).next(function(t){r+=t})]).next(function(){return r})},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(t,n)},t.prototype.updateLimboDocument=function(t,e){return ud(t,e)},t.prototype.forEachOrphanedDocument=function(t,e){var n,r=cp(t),i=Mf.INVALID;return r.iterate({index:kp.documentTargetsIndex},function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==Mf.INVALID&&e(new Mh($f(n)),i),i=s,n=a):i=Mf.INVALID}).next(function(){i!==Mf.INVALID&&e(new Mh($f(n)),i)})},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function ud(t,e){return cp(t).put(function(t,e){return new kp(0,Kf(t.path),e)}(e,t.currentSequenceNumber))}var cd,hd=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(r){return n.getDocumentInternal(t,e,r)})},t.prototype.getDocumentInternal=function(t,e,n){return this.remoteDocumentCache.getEntry(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t})},t.prototype.applyLocalMutationsToDocuments=function(t,e,n){var r=zl();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)}),r},t.prototype.getDocuments=function(t,e){var n=this;return this.remoteDocumentCache.getEntries(t,e).next(function(e){return n.getLocalViewOfDocuments(t,e)})},t.prototype.getLocalViewOfDocuments=function(t,e){var n=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(r){var i=n.applyLocalMutationsToDocuments(t,e,r),o=Ql();return i.forEach(function(t,e){e||(e=new Vh(t,Cl.forDeletedDoc())),o=o.insert(t,e)}),o})},t.prototype.getDocumentsMatchingQuery=function(t,e){return Mh.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new Mh(e)).next(function(t){var e=Xl();return t instanceof Uh&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(t){for(var r=0,i=t;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;if(e.path.isImmediateParentOf(c.path)){var h=n.get(c),l=u.applyToLocalView(h,h,o.localWriteTime);n=l instanceof Uh?n.insert(c,l):n.remove(c)}}}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t}(),ld=function(){function t(){this.refsByKey=new Nl(fd.compareByKey),this.refsByTarget=new Nl(fd.compareByTargetId)}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new fd(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new fd(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=Mh.EMPTY,r=new fd(n,t),i=new fd(n,t+1),o=[];return this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t),o.push(t.key)}),o},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t)},t.prototype.referencesForId=function(t){var e=Mh.EMPTY,n=new fd(e,t),r=new fd(e,t+1),i=ef();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.containsKey=function(t){var e=new fd(t,0),n=this.refsByKey.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),fd=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return Mh.comparator(t.key,e.key)||bh(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return bh(t.targetOrBatchId,e.targetOrBatchId)||Mh.comparator(t.key,e.key)},t}(),pd=function(){function t(t,e){this.persistence=t,this.localViewReferences=new ld,this.queryDataByTarget={},Hc(t.started,"LocalStore was passed an unstarted persistence implementation"),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new hd(this.remoteDocuments,this.mutationQueue)}return t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change","readonly",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.mutationQueue=e.persistence.getMutationQueue(t),e.localDocuments=new hd(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=[],o=[],a=ef(),s=0,u=r;s<u.length;s++){var c=u[s];i.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p],o.push(c.batchId);for(var y=0,m=c.mutations;y<m.length;y++)f=m[y],a=a.add(f.key)}return e.localDocuments.getDocuments(n,a).next(function(t){return{affectedDocuments:t,removedBatchIds:i,addedBatchIds:o}})})})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations","readwrite",function(n){var r,i=Nh.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){var i=(r=t).keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.lookupMutationDocuments=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(n){return e.mutationQueue.lookupMutationKeys(n,t).next(function(t){return t?e.localDocuments.getDocuments(n,t):Zf.resolve(null)})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(n){var r=t.batch.keys(),i=e.remoteDocuments.newChangeBuffer();return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){return e.applyWriteToRemoteDocuments(n,t,i)}).next(function(){return i.apply(n)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(n){var r;return e.mutationQueue.lookupMutationBatch(n,t).next(function(t){return Hc(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.mutationQueue.removeMutationBatch(n,t)}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.queryCache.getLastRemoteSnapshotVersion(e)})},t.prototype.applyRemoteEvent=function(e){var n=this,r=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(i){var o=[],a=ef();Zc(e.targetChanges,function(r,s){var u=n.queryDataByTarget[r];if(u){s.addedDocuments.forEach(function(t){a=a.add(t)}),s.modifiedDocuments.forEach(function(t){a=a.add(t)}),o.push(n.queryCache.removeMatchingKeys(i,s.removedDocuments,r).next(function(){return n.queryCache.addMatchingKeys(i,s.addedDocuments,r)}));var c=s.resumeToken;if(c.length>0){var h=u;u=u.copy({resumeToken:c,snapshotVersion:e.snapshotVersion}),n.queryDataByTarget[r]=u,t.shouldPersistQueryData(h,u,s)&&o.push(n.queryCache.updateQueryData(i,u))}}});var s=Ql(),u=ef();e.documentUpdates.forEach(function(t,e){u=u.add(t)}),o.push(r.getEntries(i,u).next(function(t){e.documentUpdates.forEach(function(u,c){var h=t.get(u);null==h||c.version.isEqual(Cl.MIN)||a.has(c.key)&&!h.hasPendingWrites||c.version.compareTo(h.version)>=0?(r.addEntry(c),s=s.insert(u,c)):qc("LocalStore","Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",c.version),e.resolvedLimboDocuments.has(u)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))})}));var c=e.snapshotVersion;if(!c.isEqual(Cl.MIN)){var h=n.queryCache.getLastRemoteSnapshotVersion(i).next(function(t){return Hc(c.compareTo(t)>=0,"Watch stream reverted to previous snapshot?? "+c+" < "+t),n.queryCache.setTargetsMetadata(i,i.currentSequenceNumber,c)});o.push(h)}return Zf.waitFor(o).next(function(){return r.apply(i)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(i,s)})})},t.shouldPersistQueryData=function(t,e,n){return 0!==e.resumeToken.length&&(0===t.resumeToken.length||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=this.RESUME_TOKEN_MAX_AGE_MICROS||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Zf.forEach(t,function(t){return e.localViewReferences.addReferences(t.addedKeys,t.targetId),e.localViewReferences.removeReferences(t.removedKeys,t.targetId),Zf.forEach(t.removedKeys,function(t){return e.persistence.referenceDelegate.removeReference(n,t)})})})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(n){return void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query","readwrite",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){return i?(r=i,Zf.resolve()):e.queryCache.allocateTargetId(n).next(function(i){return r=new Al(t,i,pl.Listen,n.currentSequenceNumber),e.queryCache.addQueryData(n,r)})}).next(function(){return Hc(!e.queryDataByTarget[r.targetId],"Tried to allocate an already allocated query: "+t),e.queryDataByTarget[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t,e){var n=this,r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release query",r,function(r){return n.queryCache.getQueryData(r,t).next(function(i){Hc(null!=i,"Tried to release nonexistent query: "+t);var o=i.targetId,a=n.queryDataByTarget[o],s=n.localViewReferences.removeReferencesForId(o);return delete n.queryDataByTarget[o],e?Zf.resolve():Zf.forEach(s,function(t){return n.persistence.referenceDelegate.removeReference(r,t)}).next(function(){return n.persistence.referenceDelegate.removeTarget(r,a)})})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query","readonly",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},t.prototype.removeCachedMutationBatchMetadata=function(t){this.mutationQueue.removeCachedMutationKeys(t)},t.prototype.setNetworkEnabled=function(t){this.persistence.setNetworkEnabled(t)},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=this,i=e.batch,o=i.keys(),a=Zf.resolve();return o.forEach(function(r){a=a.next(function(){return n.getEntry(t,r)}).next(function(t){var o=t,a=e.docVersions.get(r);Hc(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&((o=i.applyToRemoteDocument(r,o,e))?n.addEntry(o):Hc(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))})}),a.next(function(){return r.mutationQueue.removeMutationBatch(t,i)})},t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.collect(n,e.queryDataByTarget)})},t.prototype.getQueryForTarget=function(t){var e=this;return this.queryDataByTarget[t]?Promise.resolve(this.queryDataByTarget[t].query):this.persistence.runTransaction("Get query data","readonly",function(n){return e.queryCache.getQueryDataForTarget(n,t).next(function(t){return t?t.query:null})})},t.prototype.getNewDocumentChanges=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",function(e){return t.remoteDocuments.getNewDocumentChanges(e)})},t.RESUME_TOKEN_MAX_AGE_MICROS=3e8,t}(),dd=function(){function t(t){this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.lastStreamToken=$c(),this.batchesByDocumentKey=new Nl(fd.compareByKey)}return t.prototype.checkEmpty=function(t){return Zf.resolve(0===this.mutationQueue.length)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId,i=this.indexOfExistingBatchId(r,"acknowledged");Hc(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.mutationQueue[i];return Hc(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,Zf.resolve()},t.prototype.getLastStreamToken=function(t){return Zf.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,Zf.resolve()},t.prototype.addMutationBatch=function(t,e,n){Hc(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&Hc(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var i=new zf(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new fd(s.key,r))}return Zf.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return Zf.resolve(this.findMutationBatch(e))},t.prototype.lookupMutationKeys=function(t,e){var n=this.findMutationBatch(e);return Hc(null!=n,"Failed to find local mutation batch."),Zf.resolve(n.keys())},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.indexOfBatchId(n),i=r<0?0:r;return Zf.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)},t.prototype.getAllMutationBatches=function(t){return Zf.resolve(this.mutationQueue.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new fd(e,0),i=new fd(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){Hc(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);Hc(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),Zf.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Nl(bh);return e.forEach(function(t){var e=new fd(t,0),i=new fd(t,Number.POSITIVE_INFINITY);n.batchesByDocumentKey.forEachInRange([e,i],function(e){Hc(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.targetOrBatchId)})}),Zf.resolve(this.findMutationBatches(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Mh.isDocumentKey(i)||(i=i.child(""));var o=new fd(new Mh(i),0),a=new Nl(bh);return this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.targetOrBatchId)),!0)},o),Zf.resolve(this.findMutationBatches(a))},t.prototype.findMutationBatches=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.findMutationBatch(t);null!==r&&n.push(r)}),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Hc(0===this.indexOfExistingBatchId(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.mutationQueue.shift();var r=this.batchesByDocumentKey;return Zf.forEach(e.mutations,function(i){var o=new fd(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.removeMutationReference(t,i.key)}).next(function(){n.batchesByDocumentKey=r})},t.prototype.removeCachedMutationKeys=function(t){},t.prototype.containsKey=function(t,e){var n=new fd(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return Zf.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&Hc(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),Zf.resolve()},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return Hc(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return Hc(n.batchId===t,"If found batch must match"),n},t}(),yd=function(){function t(t){this.persistence=t,this.queries=new hp(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Cl.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ld,this.targetCount=0,this.targetIdGenerator=Jf.forQueryCache()}return t.prototype.getTargetCount=function(t){return Zf.resolve(this.targetCount)},t.prototype.forEachTarget=function(t,e){return this.queries.forEach(function(t,n){return e(n)}),Zf.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Zf.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Zf.resolve(this.highestSequenceNumber)},t.prototype.allocateTargetId=function(t){var e=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=e,Zf.resolve(e)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.highestSequenceNumber&&(this.highestSequenceNumber=e),Zf.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=t.sequenceNumber)},t.prototype.addQueryData=function(t,e){return Hc(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,Zf.resolve()},t.prototype.updateQueryData=function(t,e){return Hc(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),Zf.resolve()},t.prototype.removeQueryData=function(t,e){return Hc(this.targetCount>0,"Removing a target from an empty cache"),Hc(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,Zf.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.queries.forEach(function(a,s){s.sequenceNumber<=e&&!n[s.targetId]&&(r.queries.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)}),Zf.waitFor(o).next(function(){return i})},t.prototype.getQueryCount=function(t){return Zf.resolve(this.targetCount)},t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return Zf.resolve(n)},t.prototype.getQueryDataForTarget=function(t,e){return Kc("Not yet implemented.")},t.prototype.addMatchingKeys=function(t,e,n){this.references.addReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.addReference(t,e))}),Zf.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){this.references.removeReferences(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(function(e){i.push(r.removeReference(t,e))}),Zf.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),Zf.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return Zf.resolve(n)},t.prototype.containsKey=function(t,e){return Zf.resolve(this.references.containsKey(e))},t}(),md=function(){function t(t){this.sizer=t,this.docs=new qh(Mh.comparator),this.newDocumentChanges=ef(),this.size=0}return t.prototype.addEntries=function(t,e,n){for(var r=0,i=e;r<i.length;r++){var o=i[r],a=o.maybeDocument.key;this.docs=this.docs.insert(a,o),this.newDocumentChanges=this.newDocumentChanges.add(a)}return this.size+=n,Zf.resolve()},t.prototype.removeEntry=function(t,e){var n=this.docs.get(e);return n?(this.docs=this.docs.remove(e),this.size-=n.size,Zf.resolve(n.size)):Zf.resolve(0)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Zf.resolve(n?n.maybeDocument:null)},t.prototype.getSizedEntry=function(t,e){return Zf.resolve(this.docs.get(e))},t.prototype.getEntries=function(t,e){var n=this,r=zl();return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)}),Zf.resolve(r)},t.prototype.getSizedEntries=function(t,e){var n=this,r=zl(),i=new qh(Mh.comparator);return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null),i=i.insert(t,e?e.size:0)}),Zf.resolve({maybeDocuments:r,sizeMap:i})},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=Xl(),r=new Mh(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value.maybeDocument;if(!e.path.isPrefixOf(a.path))break;s instanceof Uh&&e.matches(s)&&(n=n.insert(s.key,s))}return Zf.resolve(n)},t.prototype.forEachDocumentKey=function(t,e){return Zf.forEach(this.docs,function(t){return e(t)})},t.prototype.getNewDocumentChanges=function(t){var e=this,n=Ql();return this.newDocumentChanges.forEach(function(t){var r=e.docs.get(t),i=r?r.maybeDocument:new Vh(t,Cl.forDeletedDoc());n=n.insert(t,i)}),this.newDocumentChanges=ef(),Zf.resolve(n)},t.prototype.newChangeBuffer=function(){return new gd(this.sizer,this)},t.prototype.getSize=function(t){return Zf.resolve(this.size)},t}(),gd=function(t){function e(e,n){var r=t.call(this)||this;return r.sizer=e,r.documentCache=n,r}return $e(e,t),e.prototype.applyChanges=function(t){var e=this,n=0,r=[];return this.assertChanges().forEach(function(t,i){var o=e.documentSizes.get(t);Hc(void 0!==o,"Attempting to change document "+t.toString()+" without having read it first");var a=e.sizer(i);n+=a-o,r.push({maybeDocument:i,size:a})}),this.documentCache.addEntries(t,r,n)},e.prototype.getFromCache=function(t,e){return this.documentCache.getSizedEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.documentCache.getSizedEntries(t,e)},e}(lp),vd=function(){function t(t,e){var n=this;this.clientId=t,this.mutationQueues={},this.listenSequence=new Mf(0),this._started=!1,this._started=!0,this.referenceDelegate=e(this),this.queryCache=new yd(this),this.remoteDocumentCache=new md(function(t){return n.referenceDelegate.documentSize(t)})}return t.createLruPersistence=function(e,n,r){return new t(e,function(t){return new wd(t,new Hp(n),r)})},t.createEagerPersistence=function(e){return new t(e,function(t){return new _d(t)})},t.prototype.shutdown=function(t){return this._started=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this._started},enumerable:!0,configurable:!0}),t.prototype.getActiveClients=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return[2,[this.clientId]]})})},t.prototype.setPrimaryStateListener=function(t){return t(!0)},t.prototype.setNetworkEnabled=function(t){},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new dd(this.referenceDelegate),this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e,n){var r=this;qc("MemoryPersistence","Starting transaction:",t);var i=new bd(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),n(i).next(function(t){return r.referenceDelegate.onTransactionCommitted(i).next(function(){return t})}).toPromise()},t.prototype.mutationQueuesContainKey=function(t,e){return Zf.or((n=this.mutationQueues,r=[],th(n,function(t,e){return r.push(e)}),r).map(function(n){return function(){return n.containsKey(t,e)}}));var n,r},t}(),bd=function(t){this.currentSequenceNumber=t},_d=function(){function t(t){this.persistence=t}return t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.addReference=function(t,e){return this.orphanedDocuments.delete(e),Zf.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedDocuments.add(e),Zf.resolve()},t.prototype.removeMutationReference=function(t,e){return this.orphanedDocuments.add(e),Zf.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.getQueryCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.orphanedDocuments.add(t)})}).next(function(){return r.removeQueryData(t,e)})},t.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},t.prototype.onTransactionCommitted=function(t){var e=this,n=this.persistence.getRemoteDocumentCache();return Zf.forEach(this.orphanedDocuments,function(r){return e.isReferenced(t,r).next(function(e){return e?Zf.resolve():n.removeEntry(t,r).next(function(){})})})},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.isReferenced(t,e).next(function(t){t?n.orphanedDocuments.delete(e):n.orphanedDocuments.add(e)})},t.prototype.documentSize=function(t){return 0},t.prototype.isReferenced=function(t,e){var n=this;return Zf.or([function(){return n.persistence.getQueryCache().containsKey(t,e)},function(){return n.persistence.mutationQueuesContainKey(t,e)},function(){return Zf.resolve(n.inMemoryPins.containsKey(e))}])},t}(),wd=function(){function t(t,e,n){this.persistence=t,this.serializer=e,this.orphanedSequenceNumbers=new hp(function(t){return Kf(t.path)}),this.garbageCollector=new Xp(this,n)}return t.prototype.onTransactionStarted=function(){},t.prototype.onTransactionCommitted=function(t){return Zf.resolve()},t.prototype.forEachTarget=function(t,e){return this.persistence.getQueryCache().forEachTarget(t,e)},t.prototype.getSequenceNumberCount=function(t){var e=this.orphanedDocumentCount(t);return this.persistence.getQueryCache().getTargetCount(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.orphanedDocumentCount=function(t){var e=0;return this.forEachOrphanedDocumentSequenceNumber(t,function(t){e++}).next(function(){return e})},t.prototype.forEachOrphanedDocumentSequenceNumber=function(t,e){var n=this;return Zf.forEach(this.orphanedSequenceNumbers,function(r,i){return n.isPinned(t,r,i).next(function(t){return t?Zf.resolve():e(i)})})},t.prototype.setInMemoryPins=function(t){this.inMemoryPins=t},t.prototype.removeTargets=function(t,e,n){return this.persistence.getQueryCache().removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=0,i=this.persistence.getRemoteDocumentCache();return i.forEachDocumentKey(t,function(o){return n.isPinned(t,o,e).next(function(e){return e?Zf.resolve():(r++,i.removeEntry(t,o).next())})}).next(function(){return r})},t.prototype.removeMutationReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Zf.resolve()},t.prototype.removeTarget=function(t,e){var n=e.copy({sequenceNumber:t.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(t,n)},t.prototype.addReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Zf.resolve()},t.prototype.removeReference=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Zf.resolve()},t.prototype.updateLimboDocument=function(t,e){return this.orphanedSequenceNumbers.set(e,t.currentSequenceNumber),Zf.resolve()},t.prototype.documentSize=function(t){var e,n=this.serializer.toDbRemoteDocument(t);if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Kc("Unknown remote document type");e=n.noDocument}return JSON.stringify(e).length},t.prototype.isPinned=function(t,e,n){var r=this;return Zf.or([function(){return r.persistence.mutationQueuesContainKey(t,e)},function(){return Zf.resolve(r.inMemoryPins.containsKey(e))},function(){return r.persistence.getQueryCache().containsKey(t,e)},function(){var t=r.orphanedSequenceNumbers.get(e);return Zf.resolve(void 0!==t&&t>n)}])},t.prototype.getCacheSize=function(t){return this.persistence.getRemoteDocumentCache().getSize(t)},t}(),Ed=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){var e=this;this.cancel();var n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);this.currentBaseMs>0&&qc("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.currentBaseMs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,function(){return e.lastAttemptTime=Date.now(),t()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Starting=1]="Starting",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff"}(cd||(cd={}));var Td,Sd,Cd=1e3,Id=6e4,Ad=1.5,Nd=function(){function t(t,e,n,r,i,o){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.listener=o,this.state=cd.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new Ed(t,e,Cd,Ad,Id)}return t.prototype.isStarted=function(){return this.state===cd.Starting||this.state===cd.Open||this.state===cd.Backoff},t.prototype.isOpen=function(){return this.state===cd.Open},t.prototype.start=function(){this.state!==cd.Error?(Hc(this.state===cd.Initial,"Already started"),this.auth()):this.performBackoff()},t.prototype.stop=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return this.isStarted()?[4,this.close(cd.Initial)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.inhibitBackoff=function(){Hc(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=cd.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return this.isOpen()?[2,this.close(cd.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},t.prototype.close=function(t,e){return ze(this,void 0,void 0,function(){return Ye(this,function(n){switch(n.label){case 0:return Hc(this.isStarted(),"Only started streams should be closed."),Hc(t===cd.Error||ll(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,t!==cd.Error?this.backoff.reset():e&&e.code===Qc.RESOURCE_EXHAUSTED?(jc(e.toString()),jc("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):e&&e.code===Qc.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.onClose(e)];case 1:return n.sent(),[2]}})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;Hc(this.state===cd.Initial,"Must be in initial state to auth"),this.state=cd.Starting;var e=this.getCloseGuardedDispatcher(this.closeCount),n=this.closeCount;this.credentialsProvider.getToken().then(function(e){t.closeCount===n&&t.startStream(e)},function(n){e(function(){var e=new zc(Qc.UNKNOWN,"Fetching auth token failed: "+n.message);return t.handleStreamClose(e)})})},t.prototype.startStream=function(t){var e=this;Hc(this.state===cd.Starting,"Trying to start stream in a non-starting state");var n=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(t),this.stream.onOpen(function(){n(function(){return Hc(e.state===cd.Starting,"Expected stream to be in state Starting, but was "+e.state),e.state=cd.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.performBackoff=function(){var t=this;Hc(this.state===cd.Error,"Should only perform backoff when in Error state"),this.state=cd.Backoff,this.backoff.backoffAndRun(function(){return ze(t,void 0,void 0,function(){return Ye(this,function(t){return Hc(this.state===cd.Backoff,"Backoff elapsed but state is now: "+this.state),this.state=cd.Initial,this.start(),Hc(this.isStarted(),"PersistentStream should have started"),[2]})})})},t.prototype.handleStreamClose=function(t){return Hc(this.isStarted(),"Can't handle server close on non-started stream"),qc("PersistentStream","close with error: "+t),this.stream=null,this.close(cd.Error,t)},t.prototype.getCloseGuardedDispatcher=function(t){var e=this;return function(n){e.queue.enqueueAndForget(function(){return e.closeCount===t?n():(qc("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Dd=function(t){function e(e,n,r,i,o){var a=t.call(this,e,xf.ListenStreamConnectionBackoff,xf.ListenStreamIdle,n,r,o)||this;return a.serializer=i,a}return $e(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(Nd),Rd=function(t){function e(e,n,r,i,o){var a=t.call(this,e,xf.WriteStreamConnectionBackoff,xf.WriteStreamIdle,n,r,o)||this;return a.serializer=i,a.handshakeComplete_=!1,a}return $e(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.handshakeComplete_=!1,t.prototype.start.call(this)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(Hc(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return Hc(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){Hc(this.isOpen(),"Writing handshake requires an opened stream"),Hc(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;Hc(this.isOpen(),"Writing mutations requires an opened stream"),Hc(this.handshakeComplete_,"Handshake must be complete before writing mutations"),Hc(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(Nd),Pd=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(t){return new Rd(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.newPersistentWatchStream=function(t){return new Dd(this.queue,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults,t.commitTime)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=Ql();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);Hc(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeRPC(t,e,r)}).catch(function(t){throw t.code===Qc.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken().then(function(r){return n.connection.invokeStreamingRPC(t,e,r)}).catch(function(t){throw t.code===Qc.UNAUTHENTICATED&&n.credentials.invalidateToken(),t})},t}(),kd=function(){function t(t){this.datastore=t,this.readVersions=Zl(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e;if(t instanceof Uh)e=t.version;else{if(!(t instanceof Vh))throw Kc("Document in a transaction was a "+t.constructor.name);e=Cl.forDeletedDoc()}var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new zc(Qc.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){t instanceof Vh||t instanceof Uh?e.recordVersion(t):Kc("Document in a transaction was a "+t.constructor.name)}),t})},t.prototype.write=function(t){if(this.committed)throw new zc(Qc.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?Ol.updateTime(e):Ol.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(Cl.forDeletedDoc()))throw new zc(Qc.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?Ol.updateTime(e):Ol.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new Ul(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,Cl.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(Td||(Td={})),function(t){t[t.RemoteStore=0]="RemoteStore",t[t.SharedClientState=1]="SharedClientState"}(Sd||(Sd={}));var Od=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=Td.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(Td.Unknown),Hc(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(xf.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,Hc(t.state===Td.Unknown,"Timer should be canceled if we transitioned to a different state."),t.logClientOfflineWarningIfNecessary("Backend didn't respond within 10 seconds."),t.setAndBroadcast(Td.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(t){this.state===Td.Online?(this.setAndBroadcast(Td.Unknown),Hc(0===this.watchStreamFailures,"watchStreamFailures must be 0"),Hc(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=1&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary("Connection failed 1 times. Most recent error: "+t.toString()),this.setAndBroadcast(Td.Offline)))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===Td.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.shouldWarnClientIsOffline?(jc(e),this.shouldWarnClientIsOffline=!1):qc("OnlineStateTracker",e)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),Ld=function(){function t(t,e,n,r){this.localStore=t,this.datastore=e,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new Od(n,r),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return ze(this,void 0,void 0,function(){var t;return Ye(this,function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.canUseNetwork()?(t=this.writeStream,[4,this.localStore.getLastStreamToken()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(Td.Unknown),[4,this.fillWritePipeline()];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.disableNetwork=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Td.Offline),[2]}})})},t.prototype.disableNetworkInternal=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return[4,this.writeStream.stop()];case 1:return t.sent(),[4,this.watchStream.stop()];case 2:return t.sent(),this.writePipeline.length>0&&(qc("RemoteStore","Stopping write stream with "+this.writePipeline.length+" pending writes"),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2]}})})},t.prototype.shutdown=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return qc("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return t.sent(),this.onlineStateTracker.set(Td.Unknown),[2]}})})},t.prototype.listen=function(t){Hc(!Xc(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){Hc(Xc(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.watchStream.isOpen()&&this.sendUnwatchRequest(t),eh(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(Td.Unknown))},t.prototype.getQueryDataForTarget=function(t){return this.listenTargets[t]||null},t.prototype.getRemoteKeysForTarget=function(t){return this.syncEngine.getRemoteKeysForTarget(t)},t.prototype.sendWatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.watchChangeAggregator.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.startWatchStream=function(){Hc(this.shouldStartWatchStream(),"startWatchStream() called when shouldStartWatchStream() is false."),this.watchChangeAggregator=new gf(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!eh(this.listenTargets)},t.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},t.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},t.prototype.onWatchStreamOpen=function(){return ze(this,void 0,void 0,function(){var t=this;return Ye(this,function(e){return Zc(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){return void 0===t&&Hc(!this.shouldStartWatchStream(),"Watch stream was stopped gracefully while still needed."),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(t),this.startWatchStream()):this.onlineStateTracker.set(Td.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return ze(this,void 0,void 0,function(){var n;return Ye(this,function(r){switch(r.label){case 0:return this.onlineStateTracker.set(Td.Online),t instanceof yf&&t.state===uf.Removed&&t.cause?[2,this.handleTargetError(t)]:(t instanceof pf?this.watchChangeAggregator.handleDocumentChange(t):t instanceof df?this.watchChangeAggregator.handleExistenceFilter(t):(Hc(t instanceof yf,"Expected watchChange to be an instance of WatchTargetChange"),this.watchChangeAggregator.handleTargetChange(t)),e.isEqual(Cl.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return n=r.sent(),e.compareTo(n)>=0?[4,this.raiseWatchSnapshot(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.raiseWatchSnapshot=function(t){var e=this;Hc(!t.isEqual(Cl.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.watchChangeAggregator.createRemoteEvent(t);return Zc(n.targetChanges,function(n,r){if(r.resumeToken.length>0){var i=e.listenTargets[n];i&&(e.listenTargets[n]=i.copy({resumeToken:r.resumeToken,snapshotVersion:t}))}}),n.targetMismatches.forEach(function(t){var n=e.listenTargets[t];if(n){e.listenTargets[t]=n.copy({resumeToken:$c()}),e.sendUnwatchRequest(t);var r=new Al(n.query,t,pl.ExistenceFilterMismatch,n.sequenceNumber);e.sendWatchRequest(r)}}),this.syncEngine.applyRemoteEvent(n)},t.prototype.handleTargetError=function(t){var e=this;Hc(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return ze(e,void 0,void 0,function(){return Ye(this,function(e){return Xc(this.listenTargets,t)?(delete this.listenTargets[t],this.watchChangeAggregator.removeTarget(t),[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.fillWritePipeline=function(){return ze(this,void 0,void 0,function(){var t,e;return Ye(this,function(n){switch(n.label){case 0:return this.canAddToWritePipeline()?(t=this.writePipeline.length>0?this.writePipeline[this.writePipeline.length-1].batchId:-1,[4,this.localStore.nextMutationBatch(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(e),[4,this.fillWritePipeline()];case 3:n.sent(),n.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2]}})})},t.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},t.prototype.outstandingWrites=function(){return this.writePipeline.length},t.prototype.addToWritePipeline=function(t){Hc(this.canAddToWritePipeline(),"addToWritePipeline called when pipeline is full"),this.writePipeline.push(t),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&this.writePipeline.length>0},t.prototype.startWriteStream=function(){Hc(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start()},t.prototype.onWriteStreamOpen=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.writePipeline;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}}).catch(id)},t.prototype.onMutationResult=function(t,e){var n=this;Hc(this.writePipeline.length>0,"Got result for empty write pipeline");var r=this.writePipeline.shift(),i=Yf.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return ze(this,void 0,void 0,function(){var e=this;return Ye(this,function(n){return void 0===t&&Hc(!this.shouldStartWriteStream(),"Write stream was stopped gracefully while still needed."),t&&this.writePipeline.length>0?[2,(this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t)).then(function(){e.shouldStartWriteStream()&&e.startWriteStream()})]:[2]})})},t.prototype.handleHandshakeError=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){return Hl(t.code)?(qc("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=$c(),[2,this.localStore.setLastStreamToken($c()).catch(id)]):[2]})})},t.prototype.handleWriteError=function(t){return ze(this,void 0,void 0,function(){var e,n=this;return Ye(this,function(r){return Hl(i=t.code)&&i!==Qc.ABORTED?(e=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2];var i})})},t.prototype.createTransaction=function(){return new kd(this.datastore)},t.prototype.handleCredentialChange=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return this.canUseNetwork()?(qc("RemoteStore","RemoteStore restarting streams for new credential"),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return t.sent(),this.onlineStateTracker.set(Td.Unknown),[4,this.enableNetwork()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.applyPrimaryState=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.disableNetworkInternal()];case 3:e.sent(),this.onlineStateTracker.set(Td.Unknown),e.label=4;case 4:return[2]}})})},t}(),xd=function(){this.listeners=[]},Md=function(){function t(t){this.syncEngine=t,this.queries=new hp(function(t){return t.canonicalId()}),this.onlineState=Td.Unknown,this.syncEngine.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new xd,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i;return Ye(this,function(o){return e=t.query,n=!1,(r=this.queries.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onWatchChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},t.prototype.onWatchError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.queries.delete(t)},t.prototype.onOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++)i[r].applyOnlineStateChange(t)})},t}(),Fd=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=Td.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(Hc(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==of.Metadata&&e.push(i)}t=new hf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(Hc(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Td.Offline;return this.options.waitForSyncWhenOnline&&n?(Hc(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===Td.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(t){Hc(!this.raisedInitialEvent,"Trying to raise initial events for second time"),t=hf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(t)},t}(),Ud=function(){function t(t,e,n){this.targetId=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e,n){for(var r=ef(),i=ef(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case of.Added:r=r.add(s.doc.key);break;case of.Removed:i=i.add(s.doc.key)}}return new t(e,r,i)},t}(),Vd=function(t){this.key=t},Bd=function(t){this.key=t},qd=function(){function t(t,e){this.query=t,this._syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=ef(),this.mutatedKeys=ef(),this.documentSet=new sf(t.docComparator.bind(t))}return Object.defineProperty(t.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new cf,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var c=i.get(t),h=e instanceof Uh?e:null;h&&(Hc(t.isEqual(h.key),"Mismatching keys found in document changes: "+t+" != "+h.key),h=n.query.matches(h)?h:null);var l=!!c&&n.mutatedKeys.has(c.key),f=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;c&&h?c.data.isEqual(h.data)?l!==f&&(r.track({type:of.Metadata,doc:h}),p=!0):n.shouldWaitForSyncedDocument(c,h)||(r.track({type:of.Modified,doc:h}),p=!0,u&&n.query.docComparator(h,u)>0&&(s=!0)):!c&&h?(r.track({type:of.Added,doc:h}),p=!0):c&&!h&&(r.track({type:of.Removed,doc:c}),p=!0,u&&(s=!0)),p&&(h?(a=a.add(h),o=f?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))}),this.query.hasLimit())for(;a.size>this.query.limit;){var c=a.last();a=a.delete(c.key),o=o.delete(c.key),r.track({type:of.Removed,doc:c})}return Hc(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.shouldWaitForSyncedDocument=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this;Hc(!t.needsRefill,"Cannot apply changes that need a refill");var i=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var o=t.changeSet.getChanges();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case of.Added:return 1;case of.Modified:case of.Metadata:return 2;case of.Removed:return 0;default:return Kc("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(n);var a=e?this.updateLimboDocuments():[],s=0===this.limboDocuments.size&&this.current?af.Synced:af.Local,u=s!==this.syncState;return this.syncState=s,0!==o.length||u?{snapshot:new hf(this.query,t.documentSet,i,o,t.mutatedKeys,s===af.Local,u,!1),limboChanges:a}:{limboChanges:a}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===Td.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new cf,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this._syncedDocuments.has(t)&&!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations},t.prototype.applyTargetChange=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.add(t)}),t.modifiedDocuments.forEach(function(t){return Hc(e._syncedDocuments.has(t),"Modified document "+t+" not found in view.")}),t.removedDocuments.forEach(function(t){return e._syncedDocuments=e._syncedDocuments.delete(t)}),this.current=t.current)},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=ef(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new Bd(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new Vd(t))}),n},t.prototype.synchronizeWithPersistedState=function(t,e){this._syncedDocuments=e,this.limboDocuments=ef();var n=this.computeDocChanges(t);return this.applyChanges(n,!0)},t.prototype.computeInitialSnapshot=function(){return hf.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===af.Local)},t}(),jd=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Wd=function(t){this.key=t},Kd=function(){function t(t,e,n,r){this.localStore=t,this.remoteStore=e,this.sharedClientState=n,this.currentUser=r,this.syncEngineListener=null,this.queryViewsByQuery=new hp(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new qh(Mh.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ld,this.mutationUserCallbacks={},this.limboTargetIdGenerator=Jf.forSyncEngine(),this.isPrimary=void 0,this.onlineState=Td.Unknown}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){Hc(null!==t,"SyncEngine listener cannot be null"),Hc(null===this.syncEngineListener,"SyncEngine already has a subscriber."),this.syncEngineListener=t},t.prototype.listen=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i,o;return Ye(this,function(a){switch(a.label){case 0:return this.assertSubscribed("listen()"),(r=this.queryViewsByQuery.get(t))?(e=r.targetId,this.sharedClientState.addLocalQueryTarget(e),n=r.view.computeInitialSnapshot(),[3,4]):[3,1];case 1:return[4,this.localStore.allocateQuery(t)];case 2:return i=a.sent(),o=this.sharedClientState.addLocalQueryTarget(i.targetId),e=i.targetId,[4,this.initializeViewAndComputeSnapshot(i,"current"===o)];case 3:n=a.sent(),this.isPrimary&&this.remoteStore.listen(i),a.label=4;case 4:return this.syncEngineListener.onWatchChange([n]),[2,e]}})})},t.prototype.initializeViewAndComputeSnapshot=function(t,e){var n=this,r=t.query;return this.localStore.executeQuery(r).then(function(i){return n.localStore.remoteDocumentKeys(t.targetId).then(function(o){var a=new qd(r,o),s=a.computeDocChanges(i),u=ff.createSynthesizedTargetChangeForCurrentChange(t.targetId,e&&n.onlineState!==Td.Offline),c=a.applyChanges(s,!0===n.isPrimary,u);Hc(0===c.limboChanges.length,"View returned limbo docs before target ack from the server."),Hc(!!c.snapshot,"applyChanges for new view should always return a snapshot");var h=new jd(r,t.targetId,a);return n.queryViewsByQuery.set(r,h),n.queryViewsByTarget[t.targetId]=h,c.snapshot})})},t.prototype.synchronizeViewAndComputeSnapshot=function(t){var e=this;return this.localStore.executeQuery(t.query).then(function(n){return e.localStore.remoteDocumentKeys(t.targetId).then(function(r){return ze(e,void 0,void 0,function(){var e;return Ye(this,function(i){return e=t.view.synchronizeWithPersistedState(n,r),this.isPrimary&&this.updateTrackedLimbos(t.targetId,e.limboChanges),[2,e]})})})})},t.prototype.unlisten=function(t){return ze(this,void 0,void 0,function(){var e,n=this;return Ye(this,function(r){switch(r.label){case 0:return this.assertSubscribed("unlisten()"),Hc(!!(e=this.queryViewsByQuery.get(t)),"Trying to unlisten on query not found:"+t),this.isPrimary?(this.sharedClientState.removeLocalQueryTarget(e.targetId),this.sharedClientState.isActiveQueryTarget(e.targetId)?[3,2]:[4,this.localStore.releaseQuery(t,!1).then(function(){n.sharedClientState.clearQueryState(e.targetId),n.remoteStore.unlisten(e.targetId),n.removeAndCleanupQuery(e)}).catch(id)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(e),[4,this.localStore.releaseQuery(t,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.sharedClientState.addPendingMutation(t.batchId),n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),Hc(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!ll(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),this.localStore.applyRemoteEvent(t).then(function(n){return th(t.targetChanges,function(t,n){var r=e.limboResolutionsByTarget[t];r&&(Hc(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,"Limbo resolution for single document contains multiple changes."),n.addedDocuments.size>0?r.receivedDocument=!0:n.modifiedDocuments.size>0?Hc(r.receivedDocument,"Received change for limbo target document without add."):n.removedDocuments.size>0&&(Hc(r.receivedDocument,"Received remove for limbo target document without add."),r.receivedDocument=!1))}),e.emitNewSnapsAndNotifyLocalStore(n,t)}).catch(id)},t.prototype.applyOnlineStateChange=function(t,e){if(this.isPrimary&&e===Sd.RemoteStore||!this.isPrimary&&e===Sd.SharedClientState){var n=[];this.queryViewsByQuery.forEach(function(e,r){var i=r.view.applyOnlineStateChange(t);Hc(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)}),this.syncEngineListener.onOnlineStateChange(t),this.syncEngineListener.onWatchChange(n),this.onlineState=t,this.isPrimary&&this.sharedClientState.setOnlineState(t)}},t.prototype.rejectListen=function(t,e){return ze(this,void 0,void 0,function(){var n,r,i,o,a,s,u=this;return Ye(this,function(c){switch(c.label){case 0:return this.assertSubscribed("rejectListens()"),this.sharedClientState.updateQueryState(t,"rejected",e),n=this.limboResolutionsByTarget[t],(r=n&&n.key)?(this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboResolutionsByTarget[t],i=(i=new qh(Mh.comparator)).insert(r,new Vh(r,Cl.forDeletedDoc())),o=ef().add(r),a=new lf(Cl.MIN,{},new Nl(bh),i,o),[2,this.applyRemoteEvent(a)]):[3,1];case 1:return Hc(!!(s=this.queryViewsByTarget[t]),"Unknown targetId: "+t),[4,this.localStore.releaseQuery(s.query,!1).then(function(){return u.removeAndCleanupQuery(s)}).catch(id)];case 2:c.sent(),this.syncEngineListener.onWatchError(s.query,e),c.label=3;case 3:return[2]}})})},t.prototype.applyBatchState=function(t,e,n){return ze(this,void 0,void 0,function(){var r;return Ye(this,function(i){switch(i.label){case 0:return this.assertSubscribed("applyBatchState()"),[4,this.localStore.lookupMutationDocuments(t)];case 1:return null===(r=i.sent())?(qc("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.remoteStore.fillWritePipeline()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.processUserCallback(t,n||null),this.localStore.removeCachedMutationBatchMetadata(t)):Kc("Unknown batchState: "+e),i.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(r)];case 5:return i.sent(),[2]}})})},t.prototype.applySuccessfulWrite=function(t){var e=this;this.assertSubscribed("applySuccessfulWrite()");var n=t.batch.batchId;return this.processUserCallback(n,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.sharedClientState.updateMutationState(n,"acknowledged"),e.emitNewSnapsAndNotifyLocalStore(t)}).catch(id)},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(r){return n.sharedClientState.updateMutationState(t,"rejected",e),n.emitNewSnapsAndNotifyLocalStore(r)}).catch(id)},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new qh(bh)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(Hc(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){var e=this;if(this.sharedClientState.removeLocalQueryTarget(t.targetId),this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.isPrimary){var n=this.limboDocumentRefs.referencesForId(t.targetId);this.limboDocumentRefs.removeReferencesForId(t.targetId),n.forEach(function(t){e.limboDocumentRefs.containsKey(t)||e.removeLimboTarget(t)})}},t.prototype.removeLimboTarget=function(t){var e=this.limboTargetsByKey.get(t);null!==e&&(this.remoteStore.unlisten(e),this.limboTargetsByKey=this.limboTargetsByKey.remove(t),delete this.limboResolutionsByTarget[e])},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Vd?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof Bd?(qc("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t),this.limboDocumentRefs.containsKey(i.key)||this.removeLimboTarget(i.key)):Kc("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){qc("SyncEngine","New document in limbo: "+e);var n=this.limboTargetIdGenerator.next(),r=dl.atPath(e.path);this.limboResolutionsByTarget[n]=new Wd(e),this.remoteStore.listen(new Al(r,n,pl.LimboResolution,Mf.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){return ze(this,void 0,void 0,function(){var n,r,i,o=this;return Ye(this,function(a){switch(a.label){case 0:return n=[],r=[],i=[],this.queryViewsByQuery.forEach(function(a,s){i.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?o.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var i=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,!0===o.isPrimary,i);if(o.updateTrackedLimbos(s.targetId,a.limboChanges),a.snapshot){o.isPrimary&&o.sharedClientState.updateQueryState(s.targetId,a.snapshot.fromCache?"not-current":"current"),n.push(a.snapshot);var u=Ud.fromSnapshot(s.targetId,a.snapshot);r.push(u)}}))}),[4,Promise.all(i)];case 1:return a.sent(),this.syncEngineListener.onWatchChange(n),[4,this.localStore.notifyLocalViewChanges(r)];case 2:return a.sent(),[2]}})})},t.prototype.assertSubscribed=function(t){Hc(null!==this.syncEngineListener,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleCredentialChange=function(t){return ze(this,void 0,void 0,function(){var e,n;return Ye(this,function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?[4,this.localStore.handleUserChange(t)]:[3,3];case 1:return n=r.sent(),this.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(n.affectedDocuments)];case 2:r.sent(),r.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return r.sent(),[2]}})})},t.prototype.applyPrimaryState=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i,o,a,s,u=this;return Ye(this,function(c){switch(c.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return c.sent(),e=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e.toArray())];case 2:for(n=c.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.remoteStore.listen(o);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,a=[],s=Promise.resolve(),Zc(this.queryViewsByTarget,function(t,e){u.sharedClientState.isLocalQueryTarget(t)?a.push(t):s=s.then(function(){return u.unlisten(e.query)}),u.remoteStore.unlisten(e.targetId)}),[4,s]);case 4:return c.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(a)];case 5:return c.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:c.sent(),c.label=7;case 7:return[2]}})})},t.prototype.resetLimboDocuments=function(){var t=this;Zc(this.limboResolutionsByTarget,function(e){t.remoteStore.unlisten(e)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new qh(Mh.comparator)},t.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(t){for(var e=this,n=Promise.resolve(),r=[],i=[],o=function(t){n=n.then(function(){return ze(e,void 0,void 0,function(){var e,n,o,a;return Ye(this,function(s){switch(s.label){case 0:return(n=this.queryViewsByTarget[t])?[4,this.localStore.releaseQuery(n.query,!0)]:[3,4];case 1:return s.sent(),[4,this.localStore.allocateQuery(n.query)];case 2:return e=s.sent(),[4,this.synchronizeViewAndComputeSnapshot(n)];case 3:return(o=s.sent()).snapshot&&i.push(o.snapshot),[3,8];case 4:return Hc(!0===this.isPrimary,"A secondary tab should never have an active query without an active view."),[4,this.localStore.getQueryForTarget(t)];case 5:return Hc(!!(a=s.sent()),"Query data for target "+t+" not found"),[4,this.localStore.allocateQuery(a)];case 6:return e=s.sent(),[4,this.initializeViewAndComputeSnapshot(e,!1)];case 7:s.sent(),s.label=8;case 8:return r.push(e),[2]}})})})},a=0,s=t;a<s.length;a++)o(s[a]);return n.then(function(){return e.syncEngineListener.onWatchChange(i),r})},t.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},t.prototype.applyTargetState=function(t,e,n){return ze(this,void 0,void 0,function(){var r,i=this;return Ye(this,function(o){switch(o.label){case 0:if(this.isPrimary)return qc("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.queryViewsByTarget[t])return[3,5];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,2]}return[3,4];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(n){return ze(i,void 0,void 0,function(){var r;return Ye(this,function(i){switch(i.label){case 0:return r=lf.createSynthesizedRemoteEventForCurrentChange(t,"current"===e),[4,this.emitNewSnapsAndNotifyLocalStore(n,r)];case 1:return i.sent(),[2]}})})},function(t){return ze(i,void 0,void 0,function(){var e;return Ye(this,function(n){switch(n.label){case 0:return function(t){return t.code===Qc.DATA_LOSS&&t.message===fp}(t)?(e=[],Zc(this.queryViewsByTarget,function(t){return e.push(t)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(e)]):[3,2];case 1:return n.sent(),[3,3];case 2:throw t;case 3:return[2]}})})})];case 2:return r=this.queryViewsByTarget[t],this.removeAndCleanupQuery(r),[4,this.localStore.releaseQuery(r.query,!0)];case 3:return o.sent(),this.syncEngineListener.onWatchError(r.query,n),[3,5];case 4:Kc("Unexpected target state: "+e),o.label=5;case 5:return[2]}})})},t.prototype.applyActiveTargetsChange=function(t,e){return ze(this,void 0,void 0,function(){var n,r,i,o,a,s,u,c,h,l=this;return Ye(this,function(f){switch(f.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,f.label=1;case 1:return n<r.length?(h=r[n],Hc(!this.queryViewsByTarget[h],"Trying to add an already active target"),[4,this.localStore.getQueryForTarget(h)]):[3,6];case 2:return Hc(!!(i=f.sent()),"Query data for active target "+h+" not found"),[4,this.localStore.allocateQuery(i)];case 3:return o=f.sent(),[4,this.initializeViewAndComputeSnapshot(o,!1)];case 4:f.sent(),this.remoteStore.listen(o),f.label=5;case 5:return n++,[3,1];case 6:a=function(t){var e;return Ye(this,function(n){switch(n.label){case 0:return(e=s.queryViewsByTarget[t])?[4,s.localStore.releaseQuery(e.query,!1).then(function(){l.remoteStore.unlisten(t),l.removeAndCleanupQuery(e)}).catch(id)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})},s=this,u=0,c=e,f.label=7;case 7:return u<c.length?(h=c[u],[5,a(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},t.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},t.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},t.prototype.getRemoteKeysForTarget=function(t){var e=this.limboResolutionsByTarget[t];return e&&e.receivedDocument?ef().add(e.key):this.queryViewsByTarget[t]?this.queryViewsByTarget[t].view.syncedDocuments:ef()},t}(),Hd=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),Gd="SharedClientState",$d="firestore_clients",Qd="firestore_mutations",zd="firestore_targets",Yd="firestore_online_state",Xd="firestore_sequence_number",Jd=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,Hc(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new zc(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(jc(Gd,"Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Zd=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,Hc(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.fromWebStorageEntry=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new zc(r.error.code,r.error.message)),i?new t(e,r.state,o):(jc(Gd,"Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.toWebStorageJSON=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ty=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.fromWebStorageEntry=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=rf(),a=0;i&&a<r.activeTargetIds.length;++a)i=fl(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(jc(Gd,"Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ey=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.fromWebStorageEntry=function(e){var n=JSON.parse(e);return"object"==typeof n&&void 0!==Td[n.onlineState]&&"string"==typeof n.clientId?new t(n.clientId,Td[n.onlineState]):(jc(Gd,"Failed to parse online state: "+e),null)},t}(),ny=function(){function t(){this.activeTargetIds=rf()}return t.prototype.addQueryTarget=function(t){Hc(!this.activeTargetIds.has(t),"Target with ID '"+t+"' already active."),this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.removeQueryTarget=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.toWebStorageJSON=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ry=function(){function t(e,n,r,i,o){if(this.queue=e,this.platform=n,this.persistenceKey=r,this.localClientId=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!t.isAvailable(this.platform))throw new zc(Qc.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var a=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey=Xd+"_"+r,this.activeClients[this.localClientId]=new ny,this.clientStateKeyRe=new RegExp("^"+$d+"_"+a+"_([^_]*)$"),this.mutationBatchKeyRe=new RegExp("^"+Qd+"_"+a+"_(\\d+)(?:_(.*))?$"),this.queryTargetKeyRe=new RegExp("^"+zd+"_"+a+"_(\\d+)$"),this.onlineStateKey=Yd+"_"+r,this.platform.window.addEventListener("storage",this.storageListener)}return t.isAvailable=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return ze(this,void 0,void 0,function(){var t,e,n,r,i,o,a,s,u,c,h,l=this;return Ye(this,function(f){switch(f.label){case 0:return Hc(!this.started,"WebStorageSharedClientState already started"),Hc(null!==this.syncEngine,"syncEngine property must be set before calling start()"),Hc(null!==this.onlineStateHandler,"onlineStateHandler property must be set before calling start()"),[4,this.syncEngine.getActiveClients()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.localClientId&&(i=this.getItem(this.toWebStorageClientStateKey(r)))&&(o=ty.fromWebStorageEntry(r,i))&&(this.activeClients[o.clientId]=o);for(this.persistClientState(),(a=this.storage.getItem(this.onlineStateKey))&&(s=this.fromWebStorageOnlineState(a))&&this.handleOnlineStateEvent(s),u=0,c=this.earlyEvents;u<c.length;u++)h=c[u],this.handleWebStorageEvent(h);return this.earlyEvents=[],this.platform.window.addEventListener("unload",function(){return l.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(t){this.setItem(this.sequenceNumberKey,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){var t=rf();return th(this.activeClients,function(e,n){t=t.unionWith(n.activeTargetIds)}),t},t.prototype.isActiveQueryTarget=function(t){for(var e in this.activeClients)if(this.activeClients.hasOwnProperty(e)&&this.activeClients[e].activeTargetIds.has(t))return!0;return!1},t.prototype.addPendingMutation=function(t){this.persistMutationState(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.persistMutationState(t,e,n),this.removeMutationState(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(t));if(n){var r=Zd.fromWebStorageEntry(t,n);r&&(e=r.state)}}return this.localClientState.addQueryTarget(t),this.persistClientState(),e},t.prototype.removeLocalQueryTarget=function(t){this.localClientState.removeQueryTarget(t),this.persistClientState()},t.prototype.isLocalQueryTarget=function(t){return this.localClientState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(this.toWebStorageQueryTargetMetadataKey(t))},t.prototype.updateQueryState=function(t,e,n){this.persistQueryTargetState(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.removeMutationState(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},t.prototype.setOnlineState=function(t){this.persistOnlineState(t)},t.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener("storage",this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return qc(Gd,"READ",t,e),e},t.prototype.setItem=function(t,e){qc(Gd,"SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){qc(Gd,"REMOVE",t),this.storage.removeItem(t)},t.prototype.handleWebStorageEvent=function(t){var e=this;if(t.storageArea===this.storage){if(qc(Gd,"EVENT",t.key,t.newValue),t.key===this.localClientStorageKey)return void jc("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.queue.enqueueAndForget(function(){return ze(e,void 0,void 0,function(){var e,n,r,i,o,a;return Ye(this,function(s){if(!this.started)return this.earlyEvents.push(t),[2];if(null===t.key)return[2];if(this.clientStateKeyRe.test(t.key)){if(null==t.newValue)return n=this.fromWebStorageClientStateKey(t.key),[2,this.handleClientStateEvent(n,null)];if(e=this.fromWebStorageClientState(t.key,t.newValue))return[2,this.handleClientStateEvent(e.clientId,e)]}else if(this.mutationBatchKeyRe.test(t.key)){if(null!==t.newValue&&(r=this.fromWebStorageMutationMetadata(t.key,t.newValue)))return[2,this.handleMutationBatchEvent(r)]}else if(this.queryTargetKeyRe.test(t.key)){if(null!==t.newValue&&(i=this.fromWebStorageQueryTargetMetadata(t.key,t.newValue)))return[2,this.handleQueryTargetEvent(i)]}else if(t.key===this.onlineStateKey){if(null!==t.newValue&&(o=this.fromWebStorageOnlineState(t.newValue)))return[2,this.handleOnlineStateEvent(o)]}else t.key===this.sequenceNumberKey&&(Hc(!!this.sequenceNumberHandler,"Missing sequenceNumberHandler"),(a=function(t){var e=Mf.INVALID;if(null!=t)try{var n=JSON.parse(t);Hc("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){jc(Gd,"Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Mf.INVALID&&this.sequenceNumberHandler(a));return[2]})})})}},Object.defineProperty(t.prototype,"localClientState",{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),t.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},t.prototype.persistMutationState=function(t,e,n){var r=new Jd(this.currentUser,t,e,n),i=this.toWebStorageMutationBatchKey(t);this.setItem(i,r.toWebStorageJSON())},t.prototype.removeMutationState=function(t){var e=this.toWebStorageMutationBatchKey(t);this.removeItem(e)},t.prototype.persistOnlineState=function(t){var e={clientId:this.localClientId,onlineState:Td[t]};this.storage.setItem(this.onlineStateKey,JSON.stringify(e))},t.prototype.persistQueryTargetState=function(t,e,n){var r=this.toWebStorageQueryTargetMetadataKey(t),i=new Zd(t,e,n);this.setItem(r,i.toWebStorageJSON())},t.prototype.toWebStorageClientStateKey=function(t){return Hc(-1===t.indexOf("_"),"Client key cannot contain '_', but was '"+t+"'"),$d+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageQueryTargetMetadataKey=function(t){return zd+"_"+this.persistenceKey+"_"+t},t.prototype.toWebStorageMutationBatchKey=function(t){var e=Qd+"_"+this.persistenceKey+"_"+t;return this.currentUser.isAuthenticated()&&(e+="_"+this.currentUser.uid),e},t.prototype.fromWebStorageClientStateKey=function(t){var e=this.clientStateKeyRe.exec(t);return e?e[1]:null},t.prototype.fromWebStorageClientState=function(t,e){var n=this.fromWebStorageClientStateKey(t);return Hc(null!==n,"Cannot parse client state key '"+t+"'"),ty.fromWebStorageEntry(n,e)},t.prototype.fromWebStorageMutationMetadata=function(t,e){var n=this.mutationBatchKeyRe.exec(t);Hc(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Jd.fromWebStorageEntry(new Hd(i),r,e)},t.prototype.fromWebStorageQueryTargetMetadata=function(t,e){var n=this.queryTargetKeyRe.exec(t);Hc(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Zd.fromWebStorageEntry(r,e)},t.prototype.fromWebStorageOnlineState=function(t){return ey.fromWebStorageEntry(t)},t.prototype.handleMutationBatchEvent=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){return t.user.uid!==this.currentUser.uid?(qc(Gd,"Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.syncEngine.applyBatchState(t.batchId,t.state,t.error)]})})},t.prototype.handleQueryTargetEvent=function(t){return this.syncEngine.applyTargetState(t.targetId,t.state,t.error)},t.prototype.handleClientStateEvent=function(t,e){var n=this,r=this.getAllActiveQueryTargets();e?this.activeClients[t]=e:delete this.activeClients[t];var i=this.getAllActiveQueryTargets(),o=[],a=[];return i.forEach(function(t){return ze(n,void 0,void 0,function(){return Ye(this,function(e){return r.has(t)||o.push(t),[2]})})}),r.forEach(function(t){return ze(n,void 0,void 0,function(){return Ye(this,function(e){return i.has(t)||a.push(t),[2]})})}),this.syncEngine.applyActiveTargetsChange(o,a)},t.prototype.handleOnlineStateEvent=function(t){this.activeClients[t.clientId]&&this.onlineStateHandler(t.onlineState)},t}(),iy=function(){function t(){this.localState=new ny,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.localState.addQueryTarget(t),this.queryState[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.queryState[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.localState.removeQueryTarget(t)},t.prototype.isLocalQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.queryState[t]},t.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.localState.activeTargetIds.has(t)},t.prototype.start=function(){return this.localState=new ny,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t}(),oy=function(){function t(t,e){this.cacheSizeBytes=t,this.experimentalTabSynchronization=e}return t.prototype.lruParams=function(){return zp.withCacheSize(this.cacheSizeBytes)},t}(),ay=function(){},sy=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r,this.clientId=vh.newId()}return t.prototype.start=function(t){var e=this,n=new Ff,r=new Ff,i=!1;return this.credentials.setChangeListener(function(o){i?e.asyncQueue.enqueueAndForget(function(){return e.handleCredentialChange(o)}):(i=!0,e.initializePersistence(t,r,o).then(function(t){return e.initializeRest(o,t)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueueAndForget(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.syncEngine.enableNetwork()})},t.prototype.initializePersistence=function(t,e,n){var r=this;return t instanceof oy?this.startIndexedDbPersistence(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.canFallback(t))throw t;return console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),r.startMemoryPersistence()}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t instanceof zc?t.code===Qc.FAILED_PRECONDITION||t.code===Qc.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code},t.prototype.startIndexedDbPersistence=function(t,e){var n=this,r=rd.buildStoragePrefix(this.databaseInfo),i=new Af(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return ze(n,void 0,void 0,function(){var n,o;return Ye(this,function(a){switch(a.label){case 0:if(e.experimentalTabSynchronization&&!ry.isAvailable(this.platform))throw new zc(Qc.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return o=e.lruParams(),e.experimentalTabSynchronization?(this.sharedClientState=new ry(this.asyncQueue,this.platform,r,this.clientId,t),[4,rd.createMultiClientIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return n=a.sent(),[3,4];case 2:return this.sharedClientState=new iy,[4,rd.createIndexedDbPersistence(r,this.clientId,this.platform,this.asyncQueue,i,o)];case 3:n=a.sent(),a.label=4;case 4:return this.persistence=n,[2,n.referenceDelegate.garbageCollector]}})})})},t.prototype.startMemoryPersistence=function(){return this.persistence=vd.createEagerPersistence(this.clientId),this.sharedClientState=new iy,Promise.resolve(null)},t.prototype.initializeRest=function(t,e){var n=this;return qc("FirestoreClient","Initializing. user=",t.uid),this.platform.loadConnection(this.databaseInfo).then(function(r){return ze(n,void 0,void 0,function(){var n,i,o,a,s=this;return Ye(this,function(u){switch(u.label){case 0:return this.localStore=new pd(this.persistence,t),e&&(this.lruScheduler=new Yp(e,this.asyncQueue,this.localStore)),n=this.platform.newSerializer(this.databaseInfo.databaseId),i=new Pd(this.asyncQueue,r,this.credentials,n),o=function(t){return s.syncEngine.applyOnlineStateChange(t,Sd.RemoteStore)},a=function(t){return s.syncEngine.applyOnlineStateChange(t,Sd.SharedClientState)},this.remoteStore=new Ld(this.localStore,i,this.asyncQueue,o),this.syncEngine=new Kd(this.localStore,this.remoteStore,this.sharedClientState,t),this.sharedClientState.onlineStateHandler=a,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new Md(this.syncEngine),[4,this.sharedClientState.start()];case 1:return u.sent(),[4,this.remoteStore.start()];case 2:return u.sent(),[4,this.persistence.setPrimaryStateListener(function(t){return ze(s,void 0,void 0,function(){return Ye(this,function(e){switch(e.label){case 0:return[4,this.syncEngine.applyPrimaryState(t)];case 1:return e.sent(),this.lruScheduler&&(t&&!this.lruScheduler.started?this.lruScheduler.start():t||this.lruScheduler.stop()),[2]}})})})];case 3:return u.sent(),[2]}})})})},t.prototype.handleCredentialChange=function(t){return this.asyncQueue.verifyOperationInProgress(),qc("FirestoreClient","Credential Changed. Current user: "+t.uid),this.syncEngine.handleCredentialChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.syncEngine.disableNetwork()})},t.prototype.shutdown=function(t){var e=this;return this.asyncQueue.enqueue(function(){return ze(e,void 0,void 0,function(){return Ye(this,function(e){switch(e.label){case 0:return this.lruScheduler&&this.lruScheduler.stop(),[4,this.remoteStore.shutdown()];case 1:return e.sent(),[4,this.sharedClientState.shutdown()];case 2:return e.sent(),[4,this.persistence.shutdown(t&&t.purgePersistenceWithDataLoss)];case 3:return e.sent(),this.credentials.removeChangeListener(),[2]}})})})},t.prototype.listen=function(t,e,n){var r=this,i=new Fd(t,e,n);return this.asyncQueue.enqueueAndForget(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.enqueueAndForget(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof Uh)return t;if(t instanceof Vh)return null;throw new zc(Qc.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=ef(),r=new qd(t,n),i=r.computeDocChanges(e);return r.applyChanges(i,!1).snapshot})},t.prototype.write=function(t){var e=this,n=new Ff;return this.asyncQueue.enqueueAndForget(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.enqueue(function(){return ze(e,void 0,void 0,function(){return Ye(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),uy=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),cy=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new zc(Qc.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+gh(1,"element")+".")}(0,t);for(var n=0;n<t.length;++n)if(oh("FieldPath","string",n,t[n]),0===t[n].length)throw new zc(Qc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xh(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw yh("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(xh.keyField().canonicalString()),t}(),hy=new RegExp("[~\\*/\\[\\]]"),ly=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}},fy=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){Hc(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,t(Hd.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){Hc(null!==this.changeListener,"removeChangeListener() when no listener registered"),this.changeListener=null},t}(),py=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){e.tokenCounter++,e.currentUser=e.getUser(),e.changeListener&&e.changeListener(e.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(){var t=this;Hc(null!=this.tokenListener,"getToken cannot be called after listener removed.");var e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(n).then(function(n){if(t.tokenCounter!==e)throw new zc(Qc.ABORTED,"getToken aborted due to token change.");return n?(Hc("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new ly(n.accessToken,t.currentUser)):null})},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){Hc(!this.changeListener,"Can only call setChangeListener() once."),this.changeListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){Hc(null!=this.tokenListener,"removeChangeListener() called twice"),Hc(null!==this.changeListener,"removeChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},t.prototype.getUser=function(){var t=this.app.INTERNAL.getUid();return Hc(null===t||"string"==typeof t,"Received invalid UID: "+t),new Hd(t)},t}(),dy=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=Hd.FIRST_PARTY,Hc(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),yy=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,Hc(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(){return Promise.resolve(new dy(this.gapi,this.sessionIndex))},t.prototype.setChangeListener=function(t){t(Hd.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function my(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var gy,vy=function(){function t(t){this._methodName=t}return t.delete=function(){return by.instance},t.serverTimestamp=function(){return _y.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rh("FieldValue.arrayUnion",arguments,1),new wy(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return rh("FieldValue.arrayRemove",arguments,1),new Ey(t)},t.prototype.isEqual=function(t){return this===t},t}(),by=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return $e(e,t),e.instance=new e,e}(vy),_y=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return $e(e,t),e.instance=new e,e}(vy),wy=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n._elements=e,n}return $e(e,t),e}(vy),Ey=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n._elements=e,n}return $e(e,t),e}(vy),Ty=Yc(vy,"Use FieldValue.<field>() instead."),Sy=/^__.*__$/,Cy=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new Ml(t,this.data,this.fieldMask,e)):n.push(new xl(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Fl(t,this.fieldTransforms)),n},t}(),Iy=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new Ml(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new Fl(t,this.fieldTransforms)),n},t}();function Ay(t){switch(t){case gy.Set:case gy.MergeSet:case gy.Update:return!0;case gy.Argument:return!1;default:throw Kc("Unexpected case for UserDataSource: "+t)}}!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.Argument=3]="Argument"}(gy||(gy={}));var Ny=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new zc(Qc.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find(function(e){return t.isPrefixOf(e)})||void 0!==this.fieldTransforms.find(function(e){return t.isPrefixOf(e.field)})},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(Ay(this.dataSource)&&Sy.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),Dy=function(t,e){this.databaseId=t,this.key=e},Ry=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new Ny(gy.Set,t,xh.EMPTY_PATH);ky("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Cy(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e,n){var r=new Ny(gy.MergeSet,t,xh.EMPTY_PATH);ky("Data must be an object, but it was:",r,e);var i,o,a=this.parseData(e,r);if(n){for(var s=new Nl(xh.comparator),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof cy)l=h._internalPath;else{if("string"!=typeof h)throw Kc("Expected stringOrFieldPath to be a string or a FieldPath");l=Ly(t,h)}if(!r.contains(l))throw new zc(Qc.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");s=s.add(l)}i=Rl.fromSet(s),o=r.fieldTransforms.filter(function(t){return i.covers(t.field)})}else i=Rl.fromArray(r.fieldMask),o=r.fieldTransforms;return new Cy(a,i,o)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new Ny(gy.Update,t,xh.EMPTY_PATH);ky("Data must be an object, but it was:",r,e);var i=new Nl(xh.comparator),o=ol.EMPTY;th(e,function(e,a){var s=Ly(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof by)i=i.add(s);else{var c=n.parseData(a,u);null!=c&&(i=i.add(s),o=o.set(s,c))}});var a=Rl.fromSet(i);return new Iy(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Ny(gy.Update,t,xh.EMPTY_PATH),o=[Oy(t,e)],a=[n];if(r.length%2!=0)throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Oy(t,r[s])),a.push(r[s+1]);var u=new Nl(xh.comparator),c=ol.EMPTY;for(s=0;s<o.length;++s){var h=o[s],l=i.childContextForFieldPath(h),f=this.runPreConverter(a[s],l);if(f instanceof by)u=u.add(h);else{var p=this.parseData(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=Rl.fromSet(u);return new Iy(c,d,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new Ny(gy.Argument,t,xh.EMPTY_PATH),r=this.parseData(e,n);return Hc(null!=r,"Parsed data should not be null."),Hc(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=xy(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(Py(t=this.runPreConverter(t,e)))return ky("Unsupported field value:",e,t),this.parseObject(t,e);if(t instanceof vy)return this.parseSentinelFieldValue(t,e),null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new qh(bh);return eh(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):th(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new ol(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=$h.INSTANCE),n.push(s),r++}return new al(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Ay(e.dataSource))throw e.createError(t._methodName+"() can only be used with update() and set()");if(null===e.path)throw e.createError(t._methodName+"() is not currently supported inside arrays");if(t instanceof by){if(e.dataSource!==gy.MergeSet)throw e.dataSource===gy.Update?(Hc(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.fieldMask.push(e.path)}else if(t instanceof _y)e.fieldTransforms.push(new Pl(e.path,Vl.instance));else if(t instanceof wy){var n=this.parseArrayTransformElements(t._methodName,t._elements),r=new Bl(n);e.fieldTransforms.push(new Pl(e.path,r))}else if(t instanceof Ey){n=this.parseArrayTransformElements(t._methodName,t._elements);var i=new ql(n);e.fieldTransforms.push(new Pl(e.path,i))}else Kc("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return $h.INSTANCE;if("number"==typeof t)return fl(t)?new Xh(t):new Jh(t);if("boolean"==typeof t)return Qh.of(t);if("string"==typeof t)return new Zh(t);if(t instanceof Date)return new tl(Nh.fromDate(t));if(t instanceof Nh)return new tl(new Nh(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof Ah)return new il(t);if(t instanceof Ch)return new nl(t);if(t instanceof Dy)return new rl(t.databaseId,t.key);throw e.createError("Unsupported field value: "+fh(t))},t.prototype.parseArrayTransformElements=function(t,e){var n=this;return e.map(function(e,r){var i=new Ny(gy.Argument,t,xh.EMPTY_PATH);return n.parseData(e,i.childContextForArray(r))})},t}();function Py(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Nh||t instanceof Ah||t instanceof Ch||t instanceof Dy||t instanceof vy)}function ky(t,e,n){if(!Py(n)||!lh(n)){var r=fh(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Oy(t,e){if(e instanceof cy)return e._internalPath;if("string"==typeof e)return Ly(t,e);throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Ly(t,e){try{return function(t){if(t.search(hy)>=0)throw new zc(Qc.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(cy.bind.apply(cy,[void 0].concat(t.split("."))))}catch(e){throw new zc(Qc.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e)._internalPath}catch(e){var n=xy(e);throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function xy(t){return t instanceof Error?t.message:t.toString()}var My="firestore.googleapis.com",Fy=!0,Uy=!0,Vy=zp.COLLECTION_DISABLED,By=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new zc(Qc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=My,this.ssl=Fy}else sh("settings","non-empty string","host",t.host),this.host=t.host,uh("settings","boolean","ssl",t.ssl),this.ssl=Jc(t.ssl,Fy);if(dh("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes"]),uh("settings","object","credentials",t.credentials),this.credentials=t.credentials,uh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?jc("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&jc("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Jc(t.timestampsInSnapshots,Uy),uh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=zp.DEFAULT_CACHE_SIZE_BYTES;else{if(t.cacheSizeBytes!==Vy&&t.cacheSizeBytes<zp.MINIMUM_CACHE_SIZE_BYTES)throw new zc(Qc.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+zp.MINIMUM_CACHE_SIZE_BYTES);this.cacheSizeBytes=t.cacheSizeBytes}}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes},t}(),qy=function(){},jy=function(){function t(e){var n=this;this._queue=new Vf,this.INTERNAL={delete:function(t){return ze(n,void 0,void 0,function(){return Ye(this,function(e){return this._firestoreClient?[2,this._firestoreClient.shutdown(t)]:[2]})})}};var r=new qy;if("object"==typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new py(i)}else{var o=e;if(!o.projectId)throw new zc(Qc.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new Ph(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new fy}r.settings=new By({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(nh("Firestore.settings",arguments,1),oh("Firestore.settings","object",1,t),Xc(t,"persistence"))throw new zc(Qc.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new By(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new zc(Qc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=function(t){if(!t)return new fy;switch(t.type){case"gapi":return new yy(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new zc(Qc.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(t){if(this._firestoreClient)throw new zc(Qc.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(new oy(this._config.settings.cacheSizeBytes,void 0!==t&&Jc(t.experimentalTabSynchronization,!1)))},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new ay),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;Hc(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),Hc(!this._firestoreClient,"configureClient() called multiple times");var n=new Dh(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new Ry(function(t){if(t instanceof Hy){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new zc(Qc.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Dy(e._config.databaseId,t._key)}return t}),this._firestoreClient=new sy(Gc.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!Xc(e,"projectId"))throw new zc(Qc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new zc(Qc.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ph(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new zc(Qc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(nh("Firestore.collection",arguments,1),oh("Firestore.collection","non-empty string",1,t),!t)throw new zc(Qc.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new Xy(Oh.fromString(t),this)},t.prototype.doc=function(t){if(nh("Firestore.doc",arguments,1),oh("Firestore.doc","non-empty string",1,t),!t)throw new zc(Qc.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),Hy.forPath(Oh.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return nh("Firestore.runTransaction",arguments,1),oh("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Wy(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new Ky(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Vc()){case Dc.DEBUG:return"debug";case Dc.ERROR:return"error";case Dc.SILENT:return"silent";default:return Kc("Unknown log level: "+Vc())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(nh("Firestore.setLogLevel",arguments,1),oh("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Bc(Dc.DEBUG);break;case"error":Bc(Dc.ERROR);break;case"silent":Bc(Dc.SILENT);break;default:throw new zc(Qc.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Wy=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;nh("Transaction.get",arguments,1);var n=em("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Kc("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof Vh)return new $y(e._firestore,n._key,null,!1,!1);if(r instanceof Uh)return new $y(e._firestore,n._key,r,!1,!1);throw Kc("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)})},t.prototype.set=function(t,e,n){ih("Transaction.set",arguments,2,3);var r=em("Transaction.set",t,this._firestore),i=(n=Jy("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof e||e instanceof cy?(rh("Transaction.update",arguments,3),r=em("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,o)):(nh("Transaction.update",arguments,2),r=em("Transaction.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(r._key,i),this},t.prototype.delete=function(t){nh("Transaction.delete",arguments,1);var e=em("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),Ky=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){ih("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=em("WriteBatch.set",t,this._firestore),i=(n=Jy("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,Ol.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof e||e instanceof cy?(rh("WriteBatch.update",arguments,3),r=em("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,o)):(nh("WriteBatch.update",arguments,2),r=em("WriteBatch.update",t,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(i.toMutations(r._key,Ol.exists(!0))),this},t.prototype.delete=function(t){nh("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=em("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new Ul(e._key,Ol.NONE)),this},t.prototype.commit=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new zc(Qc.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Hy=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!=0)throw new zc(Qc.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new Mh(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Xy(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(nh("DocumentReference.collection",arguments,1),oh("DocumentReference.collection","non-empty string",1,t),!t)throw new zc(Qc.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Oh.fromString(t);return new Xy(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw yh("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){ih("DocumentReference.set",arguments,1,2);var n=(e=Jy("DocumentReference.set",e)).merge||e.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t,e.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,Ol.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof cy?(rh("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,r)):(nh("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(n.toMutations(this._key,Ol.exists(!0)))},t.prototype.delete=function(){return nh("DocumentReference.delete",arguments,0),this._firestoreClient.write([new Ul(this._key,Ol.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ih("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||my(t[i])||(dh("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),uh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return my(t[i])?n=t[i]:(oh("DocumentReference.onSnapshot","function",i,t[i]),ah("DocumentReference.onSnapshot","function",i+1,t[i+1]),ah("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new uy({next:function(t){if(e.next){Hc(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new $y(n.firestore,n._key,r,t.fromCache,t.hasPendingWrites))}},error:r}),o=this._firestoreClient.listen(dl.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return ih("DocumentReference.get",arguments,0,1),tm("DocumentReference.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new $y(e.firestore,e._key,t,!0,t instanceof Uh&&t.hasLocalMutations))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new zc(Qc.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new zc(Qc.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),Gy=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),$y=function(){function t(t,e,n,r,i){this._firestore=t,this._key=e,this._document=n,this._fromCache=r,this._hasPendingWrites=i}return t.prototype.data=function(t){return ih("DocumentSnapshot.data",arguments,0,1),t=Zy("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,Hh.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(ih("DocumentSnapshot.get",arguments,1,2),e=Zy("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Oy("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,Hh.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Hy(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Gy(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw yh("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof ol)return this.convertObject(t,e);if(t instanceof al)return this.convertArray(t,e);if(t instanceof rl){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||jc("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Hy(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Qy=function(t){function e(e,n,r,i,o){return t.call(this,e,n,r,i,o)||this}return $e(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return Hc("object"==typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}($y),zy=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){var i;nh("Query.where",arguments,3),oh("Query.where","non-empty string",2,n),ph("Query.where",3,r);var o=Oy("Query.where",e),a=ml.fromString(n);if(o.isKeyField()){if(a===ml.ARRAY_CONTAINS)throw new zc(Qc.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"==typeof r){if(-1!==r.indexOf("/"))throw new zc(Qc.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new zc(Qc.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var s=this._query.path.child(new Oh([r]));Hc(s.length%2==0,"Path should be a document key"),i=new rl(this.firestore._databaseId,new Mh(s))}else{if(!(r instanceof Hy))throw new zc(Qc.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+fh(r)+".");var u=r;i=new rl(this.firestore._databaseId,u._key)}}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var c=yl.create(o,a,i);return this.validateNewFilter(c),new t(this._query.addFilter(c),this.firestore)},t.prototype.orderBy=function(e,n){var r;if(ih("Query.orderBy",arguments,1,2),ah("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=_l.ASCENDING;else{if("desc"!==n)throw new zc(Qc.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=_l.DESCENDING}if(null!==this._query.startAt)throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Oy("Query.orderBy",e),o=new El(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(nh("Query.limit",arguments,1),oh("Query.limit","number",1,e),e<=0)throw new zc(Qc.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];rh("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];rh("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];rh("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];rh("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw yh("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(ph(t,1,e),e instanceof $y){if(n.length>0)throw new zc(Qc.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new zc(Qc.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new rl(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new wl(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new zc(Qc.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new Mh(this._query.path.child(a));i.push(new rl(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new wl(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ih("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||my(t[i])||(dh("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),uh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),my(t[i])?n=t[i]:(oh("Query.onSnapshot","function",i,t[i]),ah("Query.onSnapshot","function",i+1,t[i+1]),ah("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new uy({next:function(t){e.next&&e.next(new Yy(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return ih("Query.get",arguments,0,1),tm("Query.get",t),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Yy(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new zc(Qc.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof gl)if(t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}else if(t.op===ml.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. Queries only support a single array-contains filter.")},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new zc(Qc.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Yy=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new Gy(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;ih("QuerySnapshot.forEach",arguments,1,2),oh("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new zy(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(dh("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),uh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this._snapshot.excludesMetadataChanges)throw new zc(Qc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e,n){if(n.oldDocs.isEmpty()){var r,i=0;return n.docChanges.map(function(e){var o=new Qy(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key));return Hc(e.type===of.Added,"Invalid event type for first snapshot"),Hc(!r||n.query.docComparator(r,e.doc)<0,"Got added events in wrong order"),r=e.doc,{type:"added",doc:o,oldIndex:-1,newIndex:i++}})}var o=n.oldDocs;return n.docChanges.filter(function(t){return e||t.type!==of.Metadata}).map(function(e){var r=new Qy(t,e.doc.key,e.doc,n.fromCache,n.mutatedKeys.has(e.doc.key)),i=-1,a=-1;return e.type!==of.Added&&(Hc((i=o.indexOf(e.doc.key))>=0,"Index for document not found"),o=o.delete(e.doc.key)),e.type!==of.Removed&&(a=(o=o.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case of.Added:return"added";case of.Modified:case of.Metadata:return"modified";case of.Removed:return"removed";default:return Kc("Unknown change type: "+t)}}(e.type),doc:r,oldIndex:i,newIndex:a}})}(this._firestore,e,this._snapshot),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw yh("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Qy(this._firestore,t.key,t,this.metadata.fromCache,this._snapshot.mutatedKeys.has(t.key))},t}();["length","forEach","map"].concat("undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Yy.prototype.docChanges,t,{get:function(){return function(){throw new zc(Qc.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var Xy=function(t){function e(e,n){var r=t.call(this,dl.atPath(e),n)||this;if(e.length%2!=1)throw new zc(Qc.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return $e(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Hy(new Mh(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(ih("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=vh.newId()),oh("CollectionReference.doc","non-empty string",1,t),""===t)throw new zc(Qc.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Oh.fromString(t);return Hy.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){nh("CollectionReference.add",arguments,1),oh("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(zy);function Jy(t,e){if(void 0===e)return{merge:!1};if(dh(t,e,["merge","mergeFields"]),uh(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+fh(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new zc(Qc.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+fh(r[o]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof cy}),void 0!==e.mergeFields&&void 0!==e.merge)throw new zc(Qc.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zy(t,e){return void 0===e?{}:(dh(t,e,["serverTimestamps"]),ch(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function tm(t,e){ah(t,"object",1,e),e&&(dh(t,e,["source"]),ch(t,0,"source",e.source,["default","server","cache"]))}function em(t,e,n){if(e instanceof Hy){if(e.firestore!==n)throw new zc(Qc.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw yh(t,"DocumentReference",1,e)}var nm=Yc(jy,"Use firebase.firestore() instead."),rm=Yc(Wy,"Use firebase.firestore().runTransaction() instead."),im=Yc(Ky,"Use firebase.firestore().batch() instead."),om=Yc(Hy,"Use firebase.firestore().doc() instead."),am=Yc($y),sm=Yc(Qy),um=Yc(zy),cm=Yc(Yy),hm=Yc(Xy,"Use firebase.firestore().collection() instead."),lm={Firestore:nm,GeoPoint:Ah,Timestamp:Nh,Blob:Ih,Transaction:rm,WriteBatch:im,DocumentReference:om,DocumentSnapshot:am,Query:um,QueryDocumentSnapshot:sm,QuerySnapshot:cm,CollectionReference:hm,FieldPath:cy,FieldValue:Ty,setLogLevel:jy.setLogLevel,CACHE_SIZE_UNLIMITED:Vy};!function(t){t.INTERNAL.registerService("firestore",function(t){return new jy(t)},function(t){Hc(t&&"object"==typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}(lm))}(jn);var fm={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},pm=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return $e(e,t),e}(Error),dm=function(){function t(t){this.app=t}return t.prototype.getAuthToken=function(){return ze(this,void 0,void 0,function(){var t;return Ye(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getInstanceIdToken=function(){return ze(this,void 0,void 0,function(){var t;return Ye(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.app.messaging?[4,this.app.messaging().getToken()]:[2,void 0];case 1:return(t=e.sent())?[2,t]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},t.prototype.getContext=function(){return ze(this,void 0,void 0,function(){var t,e;return Ye(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}})})},t}();function ym(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var mm=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"==typeof t||"object"==typeof t)return ym(t,function(t){return e.encode(t)});throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null===t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=parseFloat(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"==typeof t||"object"==typeof t?ym(t,function(t){return e.decode(t)}):t},t}(),gm=function(){function t(t,e){void 0===e&&(e="us-central1"),this.app_=t,this.region_=e,this.serializer=new mm,this.emulatorOrigin=null,this.contextProvider=new dm(t)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+n+"/"+t:"https://"+n+"-"+e+".cloudfunctions.net/"+t},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t){var e=this;return function(n){return e.call(t,n)}},t.prototype.postJSON=function(t,e,n){return ze(this,void 0,void 0,function(){var r,i;return Ye(this,function(o){switch(o.label){case 0:n.append("Content-Type","application/json"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}})})},t.prototype.call=function(t,e){return ze(this,void 0,void 0,function(){var n,r,i,o,a,s,u;return Ye(this,function(c){switch(c.label){case 0:return n=this._url(t),e=this.serializer.encode(e),r={data:e},i=new Headers,[4,this.contextProvider.getContext()];case 1:return(o=c.sent()).authToken&&i.append("Authorization","Bearer "+o.authToken),o.instanceIdToken&&i.append("Firebase-Instance-ID-Token",o.instanceIdToken),[4,this.postJSON(n,r,i)];case 2:if(a=c.sent(),s=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e.error;if(a){var s=a.status;if("string"==typeof s){if(!fm[s])return new pm("internal","internal");r=fm[s]}i=s;var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new pm(r,i,o)}(a.status,a.json,this.serializer))throw s;if(!a.json)throw new pm("internal","Response is not valid JSON object.");if(void 0===(u=a.json.data)&&(u=a.json.result),void 0===u)throw new pm("internal","Response is missing data field.");return[2,{data:this.serializer.decode(u)}]}})})},t}();function vm(t,e,n){return new gm(t,n)}!function(t){var e={Functions:gm};jn.INTERNAL.registerService("functions",vm,e,void 0,!0)}();var bm,_m,wm,Em={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},Tm=((bm={})[Em.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",bm[Em.AVAILABLE_IN_SW]="This method is available in a service worker context.",bm[Em.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",bm[Em.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",bm[Em.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",bm[Em.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",bm[Em.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",bm[Em.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",bm[Em.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",bm[Em.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",bm[Em.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",bm[Em.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",bm[Em.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",bm[Em.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",bm[Em.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",bm[Em.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",bm[Em.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",bm[Em.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",bm[Em.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",bm[Em.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",bm[Em.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",bm[Em.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",bm[Em.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",bm[Em.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",bm[Em.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",bm[Em.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",bm[Em.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",bm[Em.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",bm[Em.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",bm[Em.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",bm[Em.BAD_SCOPE]="The service worker scope must be a string with at least one character.",bm[Em.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",bm[Em.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",bm[Em.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",bm[Em.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",bm[Em.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",bm[Em.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",bm[Em.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",bm),Sm=new pn("messaging","Messaging",Tm),Cm=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),Im="https://fcm.googleapis.com";function Am(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function Nm(t){return function(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(null,e))}(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}!function(t){t.TYPE_OF_MSG="firebase-messaging-msg-type",t.DATA="firebase-messaging-msg-data"}(_m||(_m={})),function(t){t.PUSH_MSG_RECEIVED="push-msg-received",t.NOTIFICATION_CLICKED="notification-clicked"}(wm||(wm={}));var Dm=function(){function t(){}return t.prototype.getToken=function(t,e,n){return ze(this,void 0,void 0,function(){var r,i,o,a,s,u,c,h;return Ye(this,function(l){switch(l.label){case 0:r=Nm(e.getKey("p256dh")),i=Nm(e.getKey("auth")),o="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+r+"&encryption_auth="+i,Am(n.buffer,Cm.buffer)||(a=Nm(n),o+="&application_pub_key="+a),(s=new Headers).append("Content-Type","application/x-www-form-urlencoded"),u={method:"POST",headers:s,body:o},l.label=1;case 1:return l.trys.push([1,4,,5]),[4,fetch(Im+"/fcm/connect/subscribe",u)];case 2:return[4,l.sent().json()];case 3:return c=l.sent(),[3,5];case 4:throw l.sent(),Sm.create(Em.TOKEN_SUBSCRIBE_FAILED);case 5:if(c.error)throw h=c.error.message,Sm.create(Em.TOKEN_SUBSCRIBE_FAILED,{message:h});if(!c.token)throw Sm.create(Em.TOKEN_SUBSCRIBE_NO_TOKEN);if(!c.pushSet)throw Sm.create(Em.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:c.token,pushSet:c.pushSet}]}})})},t.prototype.updateToken=function(t,e,n,r,i){return ze(this,void 0,void 0,function(){var o,a,s,u,c,h,l,f;return Ye(this,function(p){switch(p.label){case 0:o=Nm(r.getKey("p256dh")),a=Nm(r.getKey("auth")),s="push_set="+n+"&token="+e+"&authorized_entity="+t+"&endpoint="+r.endpoint+"&encryption_key="+o+"&encryption_auth="+a,Am(i.buffer,Cm.buffer)||(u=Nm(i),s+="&application_pub_key="+u),(c=new Headers).append("Content-Type","application/x-www-form-urlencoded"),h={method:"POST",headers:c,body:s},p.label=1;case 1:return p.trys.push([1,4,,5]),[4,fetch(Im+"/fcm/connect/subscribe",h)];case 2:return[4,p.sent().json()];case 3:return l=p.sent(),[3,5];case 4:throw p.sent(),Sm.create(Em.TOKEN_UPDATE_FAILED);case 5:if(l.error)throw f=l.error.message,Sm.create(Em.TOKEN_UPDATE_FAILED,{message:f});if(!l.token)throw Sm.create(Em.TOKEN_UPDATE_NO_TOKEN);return[2,l.token]}})})},t.prototype.deleteToken=function(t,e,n){return ze(this,void 0,void 0,function(){var r,i,o,a,s;return Ye(this,function(u){switch(u.label){case 0:r="authorized_entity="+t+"&token="+e+"&pushSet="+n,(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},u.label=1;case 1:return u.trys.push([1,4,,5]),[4,fetch(Im+"/fcm/connect/unsubscribe",o)];case 2:return[4,u.sent().json()];case 3:if((a=u.sent()).error)throw s=a.error.message,Sm.create(Em.TOKEN_UNSUBSCRIBE_FAILED,{message:s});return[3,5];case 4:throw u.sent(),Sm.create(Em.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})},t}();function Rm(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var Pm="undefined",km="fcm_token_object_Store";var Om=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},t.prototype.getIndex=function(t,e){return this.createTransaction(function(n){return n.index(t).get(e)})},t.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},t.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},t.prototype.closeDatabase=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t.sent().close(),this.dbPromise=null,t.label=2;case 2:return[2]}})})},t.prototype.createTransaction=function(t,e){return void 0===e&&(e="readonly"),ze(this,void 0,void 0,function(){var n,r,i,o;return Ye(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,function(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}(t(i))];case 2:return o=a.sent(),[2,new Promise(function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}})]}})})},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}})),this.dbPromise},t}(),Lm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}return $e(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:(r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:!function(){var t=indexedDB.open(Pm);t.onerror=function(t){},t.onsuccess=function(e){!function(t){if(t.objectStoreNames.contains(km)){var e=t.transaction(km).objectStore(km),n=new Dm,r=e.openCursor();r.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},r.onsuccess=function(){var e=r.result;if(e){var i=e.value;n.deleteToken(i.fcmSenderId,i.fcmToken,i.fcmPushSet),e.continue()}else t.close(),indexedDB.deleteDatabase(Pm)}}}(t.result)}}();case 2:var r,i=(r=t.transaction.objectStore(this.objectStoreName)).openCursor();i.onsuccess=function(){var t=i.result;if(t){var e=t.value,n=Qe({},e);e.createTime||(n.createTime=Date.now()),"string"==typeof e.vapidKey&&(n.vapidKey=Rm(e.vapidKey)),"string"==typeof e.auth&&(n.auth=Rm(e.auth).buffer),"string"==typeof e.auth&&(n.p256dh=Rm(e.p256dh).buffer),t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){if(!t)throw Sm.create(Em.BAD_TOKEN);return xm({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},e.prototype.getTokenDetailsFromSWScope=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){if(!t)throw Sm.create(Em.BAD_SCOPE);return xm({swScope:t}),[2,this.get(t)]})})},e.prototype.saveTokenDetails=function(t){return ze(this,void 0,void 0,function(){return Ye(this,function(e){if(!t.swScope)throw Sm.create(Em.BAD_SCOPE);if(!t.vapidKey)throw Sm.create(Em.BAD_VAPID_KEY);if(!t.endpoint||!t.auth||!t.p256dh)throw Sm.create(Em.BAD_SUBSCRIPTION);if(!t.fcmSenderId)throw Sm.create(Em.BAD_SENDER_ID);if(!t.fcmToken)throw Sm.create(Em.BAD_TOKEN);if(!t.fcmPushSet)throw Sm.create(Em.BAD_PUSH_SET);return xm(t),[2,this.put(t)]})})},e.prototype.deleteToken=function(t){return ze(this,void 0,void 0,function(){var e;return Ye(this,function(n){switch(n.label){case 0:return"string"!=typeof t||0===t.length?[2,Promise.reject(Sm.create(Em.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(!(e=n.sent()))throw Sm.create(Em.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}})})},e}(Om);function xm(t){if(t.fcmToken&&("string"!=typeof t.fcmToken||0===t.fcmToken.length))throw Sm.create(Em.BAD_TOKEN);if(t.swScope&&("string"!=typeof t.swScope||0===t.swScope.length))throw Sm.create(Em.BAD_SCOPE);if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw Sm.create(Em.BAD_VAPID_KEY);if(t.endpoint&&("string"!=typeof t.endpoint||0===t.endpoint.length))throw Sm.create(Em.BAD_SUBSCRIPTION);if(t.auth&&!(t.auth instanceof ArrayBuffer))throw Sm.create(Em.BAD_SUBSCRIPTION);if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw Sm.create(Em.BAD_SUBSCRIPTION);if(t.fcmSenderId&&("string"!=typeof t.fcmSenderId||0===t.fcmSenderId.length))throw Sm.create(Em.BAD_SENDER_ID);if(t.fcmPushSet&&("string"!=typeof t.fcmPushSet||0===t.fcmPushSet.length))throw Sm.create(Em.BAD_PUSH_SET)}var Mm=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return $e(e,t),e.prototype.onDbUpgrade=function(t){t.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return ze(this,void 0,void 0,function(){var e;return Ye(this,function(n){switch(n.label){case 0:if("string"!=typeof t||0===t.length)throw Sm.create(Em.BAD_SCOPE);return[4,this.get(t)];case 1:return[2,(e=n.sent())?e.vapidKey:void 0]}})})},e.prototype.saveVapidDetails=function(t,e){return ze(this,void 0,void 0,function(){var n;return Ye(this,function(r){if("string"!=typeof t||0===t.length)throw Sm.create(Em.BAD_SCOPE);if(null===e||65!==e.length)throw Sm.create(Em.BAD_VAPID_KEY);return n={swScope:t,vapidKey:e},[2,this.put(n)]})})},e.prototype.deleteVapidDetails=function(t){return ze(this,void 0,void 0,function(){var e;return Ye(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(!(e=n.sent()))throw Sm.create(Em.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(t)];case 2:return n.sent(),[2,e]}})})},e}(Om),Fm="messagingSenderId",Um=function(){function t(t){var e=this;if(!t.options[Fm]||"string"!=typeof t.options[Fm])throw Sm.create(Em.BAD_SENDER_ID);this.messagingSenderId=t.options[Fm],this.tokenDetailsModel=new Lm,this.vapidDetailsModel=new Mm,this.iidModel=new Dm,this.app=t,this.INTERNAL={delete:function(){return e.delete()}}}return t.prototype.getToken=function(){return ze(this,void 0,void 0,function(){var t,e,n,r,i;return Ye(this,function(o){switch(o.label){case 0:if("denied"===(t=this.getNotificationPermission_()))throw Sm.create(Em.NOTIFICATIONS_BLOCKED);return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return e=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 4:return(i=o.sent())?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}})})},t.prototype.manageExistingToken=function(t,e,n,r){return ze(this,void 0,void 0,function(){return Ye(this,function(i){switch(i.label){case 0:return function(t,e,n){if(!n.vapidKey||!Am(e.buffer,n.vapidKey.buffer))return!1;var r=t.endpoint===n.endpoint,i=Am(t.getKey("auth"),n.auth),o=Am(t.getKey("p256dh"),n.p256dh);return r&&i&&o}(e,n,r)?Date.now()<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]:[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return i.sent(),[2,this.getNewToken(t,e,n)]}})})},t.prototype.updateToken=function(t,e,n,r){return ze(this,void 0,void 0,function(){var i,o,a;return Ye(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},t.prototype.getNewToken=function(t,e,n){return ze(this,void 0,void 0,function(){var r,i;return Ye(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r.token]}})})},t.prototype.deleteToken=function(t){return ze(this,void 0,void 0,function(){var e,n;return Ye(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return(e=r.sent())?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},t.prototype.deleteTokenFromDB=function(t){return ze(this,void 0,void 0,function(){var e;return Ye(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:return e=n.sent(),[4,this.iidModel.deleteToken(e.fcmSenderId,e.fcmToken,e.fcmPushSet)];case 2:return n.sent(),[2]}})})},t.prototype.getPushSubscription=function(t,e){return t.pushManager.getSubscription().then(function(n){return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})})},t.prototype.requestPermission=function(){throw Sm.create(Em.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw Sm.create(Em.AVAILABLE_IN_WINDOW)},t.prototype.usePublicVapidKey=function(t){throw Sm.create(Em.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw Sm.create(Em.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw Sm.create(Em.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw Sm.create(Em.AVAILABLE_IN_SW)},t.prototype.delete=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}})})},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getIidModel=function(){return this.iidModel},t}(),Vm=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(t){n.onPush(t)}),self.addEventListener("pushsubscriptionchange",function(t){n.onSubChange(t)}),self.addEventListener("notificationclick",function(t){n.onNotificationClick(t)}),n}return $e(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i,o,a;return Ye(this,function(s){switch(s.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(t){return[2]}return[4,this.hasVisibleClients_()];case 1:return s.sent()?[2,this.sendMessageToWindowClients_(e)]:(n=this.getNotificationData_(e))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=s.sent(),o=n.actions,a=Notification.maxActions,o&&a&&o.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return s.sent(),[2];case 5:return[2]}})})},e.prototype.onSubChange_=function(t){return ze(this,void 0,void 0,function(){var t,e,n,r;return Ye(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=i.sent(),[3,3];case 2:throw e=i.sent(),Sm.create(Em.UNABLE_TO_RESUBSCRIBE,{message:e});case 3:return i.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return i.sent(),[3,8];case 5:return n=i.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(r=i.sent()))throw n;return[4,this.deleteToken(r.fcmToken)];case 7:throw i.sent(),n;case 8:return[2]}})})},e.prototype.onNotificationClick_=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i;return Ye(this,function(o){switch(o.label){case 0:return t.notification&&t.notification.data&&t.notification.data.FCM_MSG?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(e=t.notification.data.FCM_MSG).notification&&(n=e.fcmOptions&&e.fcmOptions.link||e.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(r=o.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete e.notification,delete e.fcmOptions,i=qm(wm.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},e.prototype.getNotificationData_=function(t){if(t&&"object"==typeof t.notification){var e,n=Qe({},t.notification);return n.data=Qe({},t.notification.data,((e={}).FCM_MSG=t,e)),n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!=typeof t)throw Sm.create(Em.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return ze(this,void 0,void 0,function(){var e,n,r,i;return Ye(this,function(o){switch(o.label){case 0:return e=new URL(t,self.location.href).href,[4,Bm()];case 1:for(n=o.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===e){r=n[i];break}return[2,r]}})})},e.prototype.attemptToMessageClient_=function(t,e){return ze(this,void 0,void 0,function(){return Ye(this,function(n){if(!t)throw Sm.create(Em.NO_WINDOW_CLIENT_TO_MSG);return t.postMessage(e),[2]})})},e.prototype.hasVisibleClients_=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){switch(t.label){case 0:return[4,Bm()];case 1:return[2,t.sent().some(function(t){return"visible"===t.visibilityState})]}})})},e.prototype.sendMessageToWindowClients_=function(t){return ze(this,void 0,void 0,function(){var e,n,r=this;return Ye(this,function(i){switch(i.label){case 0:return[4,Bm()];case 1:return e=i.sent(),n=qm(wm.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map(function(t){return r.attemptToMessageClient_(t,n)}))];case 2:return i.sent(),[2]}})})},e.prototype.getSWRegistration_=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return[2,self.registration]})})},e.prototype.getPublicVapidKey_=function(){return ze(this,void 0,void 0,function(){var t,e;return Ye(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=n.sent()))throw Sm.create(Em.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(e=n.sent())?[2,Cm]:[2,e]}})})},e}(Um);function Bm(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function qm(t,e){return(n={})[_m.TYPE_OF_MSG]=t,n[_m.DATA]=e,n;var n}var jm=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=An(function(t){n.messageObserver=t}),n.onTokenRefreshInternal=An(function(t){n.tokenRefreshObserver=t}),n.setupSWMessageListener_(),n}return $e(e,t),e.prototype.getToken=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=function(){return ze(this,void 0,void 0,function(){var t,e;return Ye(this,function(n){switch(n.label){case 0:if(!(t=document.querySelector('link[rel="manifest"]')))return[2];n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return[4,n.sent().json()];case 3:return e=n.sent(),[3,5];case 4:return n.sent(),[2];case 5:if(!e||!e.gcm_sender_id)return[2];if("103953800507"!==e.gcm_sender_id)throw Sm.create(Em.INCORRECT_GCM_SENDER_ID);return[2]}})})}()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,t.prototype.getToken.call(this)]}})})},e.prototype.requestPermission=function(){return ze(this,void 0,void 0,function(){var t;return Ye(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?Sm.create(Em.PERMISSION_BLOCKED):Sm.create(Em.PERMISSION_DEFAULT)}})})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Sm.create(Em.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw Sm.create(Em.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!=typeof t)throw Sm.create(Em.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw Sm.create(Em.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var e=Rm(t);if(65!==e.length)throw Sm.create(Em.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"==typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"==typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise(function(n,r){if(e)if("activated"!==e.state)if("redundant"!==e.state){var i=function(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(Sm.create(Em.SW_REG_REDUNDANT))}e.removeEventListener("statechange",i)};e.addEventListener("statechange",i)}else r(Sm.create(Em.SW_REG_REDUNDANT));else n(t);else r(Sm.create(Em.NO_SW_IN_REG))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(t){throw Sm.create(Em.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse=e,e.update(),e})}))},e.prototype.getPublicVapidKey_=function(){return ze(this,void 0,void 0,function(){return Ye(this,function(t){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,Cm]})})},e.prototype.setupSWMessageListener_=function(){var t=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[_m.TYPE_OF_MSG]){var n=e.data;switch(n[_m.TYPE_OF_MSG]){case wm.PUSH_MSG_RECEIVED:case wm.NOTIFICATION_CLICKED:var r=n[_m.DATA];t.messageObserver&&t.messageObserver.next(r)}}},!1)},e}(Um);function Wm(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}!function(t){var e={isSupported:Wm};jn.INTERNAL.registerService("messaging",function(t){if(!Wm())throw Sm.create(Em.UNSUPPORTED_BROWSER);return self&&"ServiceWorkerGlobalScope"in self?new Vm(t):new jm(t)},e)}();var Km="https://firebasestorage.googleapis.com",Hm="https://firebasestorage.googleapis.com",Gm="/v0",$m="/v0",Qm=12e4,zm=6e4,Ym=-9007199254740991,Xm=function(){function t(t,e){this.code_=Zm(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return Zm(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),Jm={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function Zm(t){return"storage/"+t}function tg(){return new Xm(Jm.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function eg(){return new Xm(Jm.CANCELED,"User canceled the upload/download.")}function ng(){return new Xm(Jm.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function rg(t,e,n){return new Xm(Jm.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function ig(){return new Xm(Jm.APP_DELETED,"The Firebase app was deleted.")}function og(t,e){return new Xm(Jm.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ag(t){throw new Xm(Jm.INTERNAL_ERROR,"Internal error: "+t)}var sg={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function ug(t){switch(t){case sg.RAW:case sg.BASE64:case sg.BASE64URL:case sg.DATA_URL:return;default:throw"Expected one of the event types: ["+sg.RAW+", "+sg.BASE64+", "+sg.BASE64URL+", "+sg.DATA_URL+"]."}}var cg=function(t,e){this.data=t,this.contentType=e||null};function hg(t,e){switch(t){case sg.RAW:return new cg(lg(e));case sg.BASE64:case sg.BASE64URL:return new cg(fg(t,e));case sg.DATA_URL:return new cg(function(t){var e=new dg(t);return e.base64?fg(sg.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw og(sg.DATA_URL,"Malformed data URL.")}return lg(e)}(e.rest)}(e),new dg(e).contentType)}throw tg()}function lg(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function fg(t,e){switch(t){case sg.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw og(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case sg.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw og(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw og(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var pg,dg=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw og(sg.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},yg={STATE_CHANGED:"state_changed"},mg={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},gg={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function vg(t){switch(t){case mg.RUNNING:case mg.PAUSING:case mg.CANCELING:return gg.RUNNING;case mg.PAUSED:return gg.PAUSED;case mg.SUCCESS:return gg.SUCCESS;case mg.CANCELED:return gg.CANCELED;case mg.ERROR:default:return gg.ERROR}}function bg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _g(t,e){for(var n in t)bg(t,n)&&e(n,t[n])}function wg(t){if(null==t)return{};var e={};return _g(t,function(t,n){e[t]=n}),e}function Eg(t){return new Promise(t)}function Tg(t){return Promise.resolve(t)}function Sg(t){return null!=t}function Cg(t){return void 0!==t}function Ig(t){return"function"==typeof t}function Ag(t){return"object"==typeof t}function Ng(t){return Ag(t)&&null!==t}function Dg(t){return"string"==typeof t||t instanceof String}function Rg(t){return Pg()&&t instanceof Blob}function Pg(){return"undefined"!=typeof Blob}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(pg||(pg={}));var kg=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=pg.NO_ERROR,this.sendPromise_=Eg(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=pg.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=pg.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var i=this;if(this.sent_)throw ag("cannot .send() more than once");return this.sent_=!0,this.xhr_.open(e,t,!0),Sg(r)&&_g(r,function(t,e){i.xhr_.setRequestHeader(t,e.toString())}),Sg(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw ag("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw ag("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw ag("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){Sg(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){Sg(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),Og=function(){function t(){}return t.prototype.createXhrIo=function(){return new kg},t}();function Lg(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return Ag(n=e)&&!Array.isArray(n)?e:null}var xg=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n,r;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw r=e,new Xm(Jm.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")},t.makeFromUrl=function(e){for(var n=null,r=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],i=0;i<r.length;i++){var o=r[i],a=o.regex.exec(e);if(a){var s=a[o.indices.bucket],u=a[o.indices.path];u||(u=""),n=new t(s,u),o.postModify(n);break}}if(null==n)throw function(t){return new Xm(Jm.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return n},t}();function Mg(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Fg(t){return Km+Gm+t}function Ug(t){return Km+$m+t}function Vg(t){var e=encodeURIComponent,n="?";return _g(t,function(t,r){var i=e(t)+"="+e(r);n=n+i+"&"}),n=n.slice(0,-1)}function Bg(t,e){return e}var qg=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Bg},jg=null;function Wg(t,e,n){var r=Lg(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new xg(n,r);return e.makeStorageReference(i)}})}(r,t),r}(t,r,n)}function Kg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function Hg(t){if(!t||!Ag(t))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!Ag(n))throw"Expected object for 'customMetadata' mapping."}else if(Ng(n))throw"Mapping for '"+e+"' cannot be an object."}}function Gg(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}var a,s,u,c,h,l;if(!(r<=n.length&&n.length<=i))throw a=r,s=i,u=t,c=n.length,a===s?(h=a,l=1===a?"argument":"arguments"):(h="between "+a+" and "+s,l="arguments"),new Xm(Jm.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+u+"`: Expected "+h+" "+l+", received "+c+".");for(o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(e){throw e instanceof Error?rg(o,t,e.message):rg(o,t,e)}}var $g=function(t,e){var n=this;this.validator=function(e){n.optional&&!Cg(e)||t(e)},this.optional=!!e};function Qg(t,e){function n(t){if(!Dg(t))throw"Expected string."}var r,i,o;return t?(i=n,o=t,r=function(t){i(t),o(t)}):r=n,new $g(r,e)}function zg(t){return new $g(Hg,t)}function Yg(){return new $g(function(t){if(!(function(t){return"number"==typeof t||t instanceof Number}(t)&&t>=0))throw"Expected a number 0 or greater."})}function Xg(t,e){return new $g(function(e){if(!(null===e||Sg(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)},e)}function Jg(t){return new $g(function(t){if(null!==t&&!Ig(t))throw"Expected a Function."},t)}var Zg=function(){function t(t,e){var n=0,r="";Rg(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Rg(this.data_)){var r=(o=e,a=n,(i=this.data_).webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Pg()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Pg())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}.apply(null,r))}var i=e.map(function(t){return Dg(t)?hg(sg.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function tv(t,e){return-1!==t.indexOf(e)}var ev=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function nv(t){if(!t)throw tg()}function rv(t,e){return function(n,r){var i=Wg(t,r,e);return nv(null!==i),i}}function iv(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new Xm(Jm.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Xm(Jm.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Xm(Jm.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.setServerResponseProp(n.serverResponseProp()),r}}function ov(t){var e=iv(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Xm(Jm.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),o.setServerResponseProp(r.serverResponseProp()),o}}function av(t,e,n){var r=Fg(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new ev(r,"GET",rv(t,n),i);return o.errorHandler=ov(e),o}function sv(t,e,n){var r=Fg(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new ev(r,"GET",function(t,e){return function(n,r){var i=Wg(t,r,e);return nv(null!==i),function(t,e){var n=Lg(e);if(null===n)return null;if(!Dg(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map(function(e){var n=t.bucket,r=t.fullPath;return function(t){return Hm+Gm+t}("/b/"+i(n)+"/o/"+i(r))+Vg({alt:"media",token:e})})[0]}(i,r)}}(t,n),i);return o.errorHandler=ov(e),o}function uv(t,e,n){var r=wg(n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var cv=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function hv(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){nv(!1)}return nv(tv(e||["active"],n)),n}var lv=function(t,e,n){if(Ig(t)||Sg(e)||Sg(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},fv=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function pv(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Tg(!0).then(function(){t.apply(null,e)})}}var dv=function(){function t(t,e,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=mg.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(Jm.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(mg.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(Jm.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(mg.ERROR))},this.promise_=Eg(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,r){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===mg.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case mg.RUNNING:t(n);break;case mg.CANCELING:e.transition_(mg.CANCELED);break;case mg.PAUSING:e.transition_(mg.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=uv(e,r,i),s={name:a.fullPath},u=Ug(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=Kg(a,n),l=t.maxUploadRetryTime(),f=new ev(u,"POST",function(t,e){var n;hv(t);try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){nv(!1)}return nv(Dg(n)),n},l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=iv(e),f}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime(),o=new ev(n,"POST",function(t,e){var n,i=hv(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){nv(!1)}var o=parseInt(n,10);return nv(!isNaN(o)),new cv(o,r.size(),"final"===i)},i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=iv(e),o}(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new cv(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=function(t,e,n,r,i,o,a,s){var u=new cv(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Xm(Jm.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,p={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(l,f);if(null===d)throw ng();var y=e.maxUploadRetryTime(),m=new ev(n,"POST",function(t,n){var i,a=hv(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?rv(e,o)(t,n):null,new cv(s,c,"final"===a,i)},y);return m.headers=p,m.body=d.uploadData(),m.progressCallback=s||null,m.errorHandler=iv(t),m}(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(e){return t.error_=e,void t.transition_(mg.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(mg.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=av(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(mg.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=uv(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Kg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",l=Zg.getBlob(c,r,h);if(null===l)throw ng();var f={name:u.fullPath},p=Ug(o),d=t.maxUploadRetryTime(),y=new ev(p,"POST",rv(t,n),d);return y.urlParams=f,y.headers=a,y.body=l.uploadData(),y.errorHandler=iv(e),y}(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(mg.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case mg.CANCELING:case mg.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case mg.RUNNING:var e=this.state_===mg.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case mg.PAUSED:this.state_=t,this.notifyObservers_();break;case mg.CANCELED:this.error_=eg(),this.state_=t,this.notifyObservers_();break;case mg.ERROR:case mg.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case mg.PAUSING:this.transition_(mg.PAUSED);break;case mg.CANCELING:this.transition_(mg.CANCELED);break;case mg.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=vg(this.state_);return new fv(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var i="Expected a function or an Object with one of `next`, `error`, `complete` properties.",o=Jg(!0).validator,a=Xg(null,!0).validator;function s(t){try{return void o(t)}catch(t){}try{if(a(t),!(Cg(t.next)||Cg(t.error)||Cg(t.complete)))throw"";return}catch(t){throw i}}Gg("on",[Qg(function(e){if(t!==yg.STATE_CHANGED)throw"Expected one of the event types: ["+yg.STATE_CHANGED+"]."}),Xg(s,!0),Jg(!0),Jg(!0)],arguments);var u=this;function c(t){return function(e,n,i){null!==t&&Gg("on",t,arguments);var o=new lv(e,n,r);return u.addObserver_(o),function(){u.removeObserver_(o)}}}var h=[Xg(function(t){if(null===t)throw i;s(t)}),Jg(!0),Jg(!0)];return Cg(e)||Cg(n)||Cg(r)?c(null)(e,n,r):c(h)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){var e,n,r;n=t,-1!==(r=(e=this.observers_).indexOf(n))&&e.splice(r,1)},t.prototype.notifyObservers_=function(){var t,e=this;this.finishPromise_(),(t=this.observers_,Array.prototype.slice.call(t)).forEach(function(t){e.notifyObserver_(t)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(vg(this.state_)){case gg.SUCCESS:pv(this.resolve_.bind(null,this.snapshot))();break;case gg.CANCELED:case gg.ERROR:pv(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(vg(this.state_)){case gg.RUNNING:case gg.PAUSED:null!==t.next&&pv(t.next.bind(t,this.snapshot))();break;case gg.SUCCESS:null!==t.complete&&pv(t.complete.bind(t))();break;case gg.CANCELED:case gg.ERROR:null!==t.error&&pv(t.error.bind(t,this.error_))();break;default:null!==t.error&&pv(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){Gg("resume",[],arguments);var t=this.state_===mg.PAUSED||this.state_===mg.PAUSING;return t&&this.transition_(mg.RUNNING),t},t.prototype.pause=function(){Gg("pause",[],arguments);var t=this.state_===mg.RUNNING;return t&&this.transition_(mg.PAUSING),t},t.prototype.cancel=function(){Gg("cancel",[],arguments);var t=this.state_===mg.RUNNING||this.state_===mg.PAUSING;return t&&this.transition_(mg.CANCELING),t},t}(),yv=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof xg?e:xg.makeFromUrl(e)}return t.prototype.toString=function(){return Gg("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return function(){if(jg)return jg;var t=[];t.push(new qg("bucket")),t.push(new qg("generation")),t.push(new qg("metageneration")),t.push(new qg("name","fullPath",!0));var e=new qg("name");e.xform=function(t,e){return function(t){return!Dg(t)||t.length<2?t:Mg(t=t)}(e)},t.push(e);var n=new qg("size");return n.xform=function(t,e){return Sg(e)?+e:e},t.push(n),t.push(new qg("timeCreated")),t.push(new qg("updated")),t.push(new qg("md5Hash",null,!0)),t.push(new qg("cacheControl",null,!0)),t.push(new qg("contentDisposition",null,!0)),t.push(new qg("contentEncoding",null,!0)),t.push(new qg("contentLanguage",null,!0)),t.push(new qg("contentType",null,!0)),t.push(new qg("metadata","customMetadata",!0)),jg=t}()},t.prototype.child=function(t){Gg("child",[Qg()],arguments);var e=function(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new xg(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=function(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new xg(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new xg(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Mg(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),Gg("put",[new $g(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Pg()&&t instanceof Blob))throw"Expected Blob or File."}),zg(!0)],arguments),this.throwIfRoot_("put"),new dv(this,this.authWrapper,this.location,this.mappings(),new Zg(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=sg.RAW),Gg("putString",[Qg(),Qg(ug,!0),zg(!0)],arguments),this.throwIfRoot_("putString");var r=hg(e,t),i=wg(n);return!Sg(i.contentType)&&Sg(r.contentType)&&(i.contentType=r.contentType),new dv(this,this.authWrapper,this.location,this.mappings(),new Zg(r.data,!0),i)},t.prototype.delete=function(){Gg("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=function(t,e){var n=Fg(e.fullServerUrl()),r=t.maxOperationRetryTime(),i=new ev(n,"DELETE",function(t,e){},r);return i.successCodes=[200,204],i.errorHandler=ov(e),i}(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){Gg("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=av(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){Gg("updateMetadata",[zg()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=function(t,e,n,r){var i=Fg(e.fullServerUrl()),o=Kg(n,r),a=t.maxOperationRetryTime(),s=new ev(i,"PATCH",rv(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=ov(e),s}(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){Gg("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=sv(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then(function(t){if(null===t)throw new Xm(Jm.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t})})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new Xm(Jm.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},t}(),mv=function(){function t(t){this.promise_=function(t){return Promise.reject(t)}(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),gv=function(){function t(){this.map_={},this.id_=Ym}return t.prototype.addRequest=function(t){var e=this.id_;this.id_++,this.map_[e]=t;var n=this;function r(){delete n.map_[e]}t.getPromise().then(r,r)},t.prototype.clear=function(){_g(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}(),vv=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;Sg(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=Qm,this.maxUploadRetryTime_=zm,this.requestMap_=new gv}return t.extractBucket_=function(t){var e=t.storageBucket||null;return null==e?null:xg.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&Sg(this.app_.INTERNAL)&&Sg(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):Tg(null)},t.prototype.bucket=function(){if(this.deleted_)throw ig();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new mv(ig());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}(),bv=function(){function t(t,e,n,r,i,o,a,s,u,c,h){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h;var l=this;this.promise_=Eg(function(t,e){l.resolve_=t,l.reject_=e,l.start_()})}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());Cg(s)?i(s):i()}catch(t){o(t)}else null!==a?((r=tg()).setServerResponseProp(a.getResponseText()),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?ig():eg()):o(r=new Xm(Jm.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new _v(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){u||(u=!0,e.apply(null,arguments))}function h(e){i=setTimeout(function(){i=null,t(l,s())},e)}function l(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];u||(t?c.apply(null,arguments):s()||o?c.apply(null,arguments):(r<64&&(r*=2),1===a?(a=2,e=0):e=1e3*(r+Math.random()),h(e)))}var f=!1;function p(t){f||(f=!0,u||(null!==i?(t||(a=2),clearTimeout(i),h(0)):t||(a=1)))}return h(0),setTimeout(function(){o=!0,p(!0)},n),p}(function(e,n){if(n)e(!1,new _v(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then(function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===pg.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=tv(t.successCodes_,o);e(!0,new _v(a,n))}else{var s=n.getErrorCode()===pg.ABORT;e(!1,new _v(!1,null,s))}})}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}},e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=tv([408,429],t),r=tv(this.additionalRetryCodes_,t);return e||n||r},t}(),_v=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function wv(t,e,n){var r=Vg(t.urlParams),i=t.url+r,o=wg(t.headers);return function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(o,e),function(t){var e=void 0!==jn?jn.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new bv(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var Ev=function(){function t(t,e,n){if(this.bucket_=null,this.authWrapper_=new vv(t,function(t,e){return new yv(t,e)},wv,this,e),this.app_=t,null!=n)this.bucket_=xg.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new xg(r,""))}this.internals_=new Tv(this)}return t.prototype.ref=function(t){if(Gg("ref",[Qg(function(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new yv(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},t.prototype.refFromURL=function(t){return Gg("refFromURL",[Qg(function(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{xg.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new yv(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){Gg("setMaxUploadRetryTime",[Yg()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){Gg("setMaxOperationRetryTime",[Yg()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),Tv=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Tg(void 0)},t}();function Sv(t,e,n){return new Ev(t,new Og,n)}return function(t){var e={TaskState:gg,TaskEvent:yg,StringFormat:sg,Storage:Ev,Reference:yv};jn.INTERNAL.registerService("storage",Sv,e,void 0,!0)}(),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),jn}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Vue=e()}(this,function(){"use strict";var t=Object.freeze({});function e(t){return null==t}function n(t){return null!=t}function r(t){return!0===t}function i(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function o(t){return null!==t&&"object"==typeof t}var a=Object.prototype.toString;function s(t){return"[object Object]"===a.call(t)}function u(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function c(t){return n(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function h(t){return null==t?"":Array.isArray(t)||s(t)&&t.toString===a?JSON.stringify(t,null,2):String(t)}function l(t){var e=parseFloat(t);return isNaN(e)?t:e}function f(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}var p=f("slot,component",!0),d=f("key,ref,slot,slot-scope,is");function y(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var m=Object.prototype.hasOwnProperty;function g(t,e){return m.call(t,e)}function v(t){var e=Object.create(null);return function(n){return e[n]||(e[n]=t(n))}}var b=/-(\w)/g,_=v(function(t){return t.replace(b,function(t,e){return e?e.toUpperCase():""})}),w=v(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),E=/\B([A-Z])/g,T=v(function(t){return t.replace(E,"-$1").toLowerCase()}),S=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n};function C(t,e){e=e||0;for(var n=t.length-e,r=new Array(n);n--;)r[n]=t[n+e];return r}function I(t,e){for(var n in e)t[n]=e[n];return t}function A(t){for(var e={},n=0;n<t.length;n++)t[n]&&I(e,t[n]);return e}function N(t,e,n){}var D=function(t,e,n){return!1},R=function(t){return t};function P(t,e){if(t===e)return!0;var n=o(t),r=o(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var i=Array.isArray(t),a=Array.isArray(e);if(i&&a)return t.length===e.length&&t.every(function(t,n){return P(t,e[n])});if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(i||a)return!1;var s=Object.keys(t),u=Object.keys(e);return s.length===u.length&&s.every(function(n){return P(t[n],e[n])})}catch(t){return!1}}function k(t,e){for(var n=0;n<t.length;n++)if(P(t[n],e))return n;return-1}function O(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var L="data-server-rendered",x=["component","directive","filter"],M=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],F={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:D,isReservedAttr:D,isUnknownElement:D,getTagNamespace:N,parsePlatformTagName:R,mustUseProp:D,async:!0,_lifecycleHooks:M},U=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function V(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var B,q=new RegExp("[^"+U.source+".$_\\d]"),j="__proto__"in{},W="undefined"!=typeof window,K="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,H=K&&WXEnvironment.platform.toLowerCase(),G=W&&window.navigator.userAgent.toLowerCase(),$=G&&/msie|trident/.test(G),Q=G&&G.indexOf("msie 9.0")>0,z=G&&G.indexOf("edge/")>0,Y=(G&&G.indexOf("android"),G&&/iphone|ipad|ipod|ios/.test(G)||"ios"===H),X=(G&&/chrome\/\d+/.test(G),G&&/phantomjs/.test(G),G&&G.match(/firefox\/(\d+)/)),J={}.watch,Z=!1;if(W)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Z=!0}}),window.addEventListener("test-passive",null,tt)}catch(t){}var et=function(){return void 0===B&&(B=!W&&!K&&"undefined"!=typeof global&&global.process&&"server"===global.process.env.VUE_ENV),B},nt=W&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function rt(t){return"function"==typeof t&&/native code/.test(t.toString())}var it,ot="undefined"!=typeof Symbol&&rt(Symbol)&&"undefined"!=typeof Reflect&&rt(Reflect.ownKeys);it="undefined"!=typeof Set&&rt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var at=N,st=0,ut=function(){this.id=st++,this.subs=[]};ut.prototype.addSub=function(t){this.subs.push(t)},ut.prototype.removeSub=function(t){y(this.subs,t)},ut.prototype.depend=function(){ut.target&&ut.target.addDep(this)},ut.prototype.notify=function(){for(var t=this.subs.slice(),e=0,n=t.length;e<n;e++)t[e].update()},ut.target=null;var ct=[];function ht(t){ct.push(t),ut.target=t}function lt(){ct.pop(),ut.target=ct[ct.length-1]}var ft=function(t,e,n,r,i,o,a,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=i,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},pt={child:{configurable:!0}};pt.child.get=function(){return this.componentInstance},Object.defineProperties(ft.prototype,pt);var dt=function(t){void 0===t&&(t="");var e=new ft;return e.text=t,e.isComment=!0,e};function yt(t){return new ft(void 0,void 0,void 0,String(t))}function mt(t){var e=new ft(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var gt=Array.prototype,vt=Object.create(gt);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){var e=gt[t];V(vt,t,function(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];var i,o=e.apply(this,n),a=this.__ob__;switch(t){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2)}return i&&a.observeArray(i),a.dep.notify(),o})});var bt=Object.getOwnPropertyNames(vt),_t=!0;function wt(t){_t=t}var Et=function(t){var e;this.value=t,this.dep=new ut,this.vmCount=0,V(t,"__ob__",this),Array.isArray(t)?(j?(e=vt,t.__proto__=e):function(t,e,n){for(var r=0,i=n.length;r<i;r++){var o=n[r];V(t,o,e[o])}}(t,vt,bt),this.observeArray(t)):this.walk(t)};function Tt(t,e){var n;if(o(t)&&!(t instanceof ft))return g(t,"__ob__")&&t.__ob__ instanceof Et?n=t.__ob__:_t&&!et()&&(Array.isArray(t)||s(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Et(t)),e&&n&&n.vmCount++,n}function St(t,e,n,r,i){var o=new ut,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var s=a&&a.get,u=a&&a.set;s&&!u||2!==arguments.length||(n=t[e]);var c=!i&&Tt(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):n;return ut.target&&(o.depend(),c&&(c.dep.depend(),Array.isArray(e)&&function t(e){for(var n=void 0,r=0,i=e.length;r<i;r++)(n=e[r])&&n.__ob__&&n.__ob__.dep.depend(),Array.isArray(n)&&t(n)}(e))),e},set:function(e){var r=s?s.call(t):n;e===r||e!=e&&r!=r||s&&!u||(u?u.call(t,e):n=e,c=!i&&Tt(e),o.notify())}})}}function Ct(t,e,n){if(Array.isArray(t)&&u(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n,n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(St(r.value,e,n),r.dep.notify(),n):(t[e]=n,n)}function It(t,e){if(Array.isArray(t)&&u(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||g(t,e)&&(delete t[e],n&&n.dep.notify())}}Et.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)St(t,e[n])},Et.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Tt(t[e])};var At=F.optionMergeStrategies;function Nt(t,e){if(!e)return t;for(var n,r,i,o=ot?Reflect.ownKeys(e):Object.keys(e),a=0;a<o.length;a++)"__ob__"!==(n=o[a])&&(r=t[n],i=e[n],g(t,n)?r!==i&&s(r)&&s(i)&&Nt(r,i):Ct(t,n,i));return t}function Dt(t,e,n){return n?function(){var r="function"==typeof e?e.call(n,n):e,i="function"==typeof t?t.call(n,n):t;return r?Nt(r,i):i}:e?t?function(){return Nt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Rt(t,e){var n=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return n?function(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}(n):n}function Pt(t,e,n,r){var i=Object.create(t||null);return e?I(i,e):i}At.data=function(t,e,n){return n?Dt(t,e,n):e&&"function"!=typeof e?t:Dt(t,e)},M.forEach(function(t){At[t]=Rt}),x.forEach(function(t){At[t+"s"]=Pt}),At.watch=function(t,e,n,r){if(t===J&&(t=void 0),e===J&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var i={};for(var o in I(i,t),e){var a=i[o],s=e[o];a&&!Array.isArray(a)&&(a=[a]),i[o]=a?a.concat(s):Array.isArray(s)?s:[s]}return i},At.props=At.methods=At.inject=At.computed=function(t,e,n,r){if(!t)return e;var i=Object.create(null);return I(i,t),e&&I(i,e),i},At.provide=Dt;var kt=function(t,e){return void 0===e?t:e};function Ot(t,e,n){if("function"==typeof e&&(e=e.options),function(t,e){var n=t.props;if(n){var r,i,o={};if(Array.isArray(n))for(r=n.length;r--;)"string"==typeof(i=n[r])&&(o[_(i)]={type:null});else if(s(n))for(var a in n)i=n[a],o[_(a)]=s(i)?i:{type:i};t.props=o}}(e),function(t,e){var n=t.inject;if(n){var r=t.inject={};if(Array.isArray(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(s(n))for(var o in n){var a=n[o];r[o]=s(a)?I({from:o},a):{from:a}}}}(e),function(t){var e=t.directives;if(e)for(var n in e){var r=e[n];"function"==typeof r&&(e[n]={bind:r,update:r})}}(e),!e._base&&(e.extends&&(t=Ot(t,e.extends,n)),e.mixins))for(var r=0,i=e.mixins.length;r<i;r++)t=Ot(t,e.mixins[r],n);var o,a={};for(o in t)u(o);for(o in e)g(t,o)||u(o);function u(r){var i=At[r]||kt;a[r]=i(t[r],e[r],n,r)}return a}function Lt(t,e,n,r){if("string"==typeof n){var i=t[e];if(g(i,n))return i[n];var o=_(n);if(g(i,o))return i[o];var a=w(o);return g(i,a)?i[a]:i[n]||i[o]||i[a]}}function xt(t,e,n,r){var i=e[t],o=!g(n,t),a=n[t],s=Ut(Boolean,i.type);if(s>-1)if(o&&!g(i,"default"))a=!1;else if(""===a||a===T(t)){var u=Ut(String,i.type);(u<0||s<u)&&(a=!0)}if(void 0===a){a=function(t,e,n){if(g(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:"function"==typeof r&&"Function"!==Mt(e.type)?r.call(t):r}}(r,i,t);var c=_t;wt(!0),Tt(a),wt(c)}return a}function Mt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Ft(t,e){return Mt(t)===Mt(e)}function Ut(t,e){if(!Array.isArray(e))return Ft(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(Ft(e[n],t))return n;return-1}function Vt(t,e,n){ht();try{if(e)for(var r=e;r=r.$parent;){var i=r.$options.errorCaptured;if(i)for(var o=0;o<i.length;o++)try{if(!1===i[o].call(r,t,e,n))return}catch(t){qt(t,r,"errorCaptured hook")}}qt(t,e,n)}finally{lt()}}function Bt(t,e,n,r,i){var o;try{(o=n?t.apply(e,n):t.call(e))&&!o._isVue&&c(o)&&!o._handled&&(o.catch(function(t){return Vt(t,r,i+" (Promise/async)")}),o._handled=!0)}catch(t){Vt(t,r,i)}return o}function qt(t,e,n){if(F.errorHandler)try{return F.errorHandler.call(null,t,e,n)}catch(e){e!==t&&jt(e,null,"config.errorHandler")}jt(t,e,n)}function jt(t,e,n){if(!W&&!K||"undefined"==typeof console)throw t;console.error(t)}var Wt,Kt=!1,Ht=[],Gt=!1;function $t(){Gt=!1;var t=Ht.slice(0);Ht.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&rt(Promise)){var Qt=Promise.resolve();Wt=function(){Qt.then($t),Y&&setTimeout(N)},Kt=!0}else if($||"undefined"==typeof MutationObserver||!rt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Wt="undefined"!=typeof setImmediate&&rt(setImmediate)?function(){setImmediate($t)}:function(){setTimeout($t,0)};else{var zt=1,Yt=new MutationObserver($t),Xt=document.createTextNode(String(zt));Yt.observe(Xt,{characterData:!0}),Wt=function(){zt=(zt+1)%2,Xt.data=String(zt)},Kt=!0}function Jt(t,e){var n;if(Ht.push(function(){if(t)try{t.call(e)}catch(t){Vt(t,e,"nextTick")}else n&&n(e)}),Gt||(Gt=!0,Wt()),!t&&"undefined"!=typeof Promise)return new Promise(function(t){n=t})}var Zt=new it;function te(t){!function t(e,n){var r,i,a=Array.isArray(e);if(!(!a&&!o(e)||Object.isFrozen(e)||e instanceof ft)){if(e.__ob__){var s=e.__ob__.dep.id;if(n.has(s))return;n.add(s)}if(a)for(r=e.length;r--;)t(e[r],n);else for(r=(i=Object.keys(e)).length;r--;)t(e[i[r]],n)}}(t,Zt),Zt.clear()}var ee=v(function(t){var e="&"===t.charAt(0),n="~"===(t=e?t.slice(1):t).charAt(0),r="!"===(t=n?t.slice(1):t).charAt(0);return{name:t=r?t.slice(1):t,once:n,capture:r,passive:e}});function ne(t,e){function n(){var t=arguments,r=n.fns;if(!Array.isArray(r))return Bt(r,null,arguments,e,"v-on handler");for(var i=r.slice(),o=0;o<i.length;o++)Bt(i[o],null,t,e,"v-on handler")}return n.fns=t,n}function re(t,n,i,o,a,s){var u,c,h,l;for(u in t)c=t[u],h=n[u],l=ee(u),e(c)||(e(h)?(e(c.fns)&&(c=t[u]=ne(c,s)),r(l.once)&&(c=t[u]=a(l.name,c,l.capture)),i(l.name,c,l.capture,l.passive,l.params)):c!==h&&(h.fns=c,t[u]=h));for(u in n)e(t[u])&&o((l=ee(u)).name,n[u],l.capture)}function ie(t,i,o){var a;t instanceof ft&&(t=t.data.hook||(t.data.hook={}));var s=t[i];function u(){o.apply(this,arguments),y(a.fns,u)}e(s)?a=ne([u]):n(s.fns)&&r(s.merged)?(a=s).fns.push(u):a=ne([s,u]),a.merged=!0,t[i]=a}function oe(t,e,r,i,o){if(n(e)){if(g(e,r))return t[r]=e[r],o||delete e[r],!0;if(g(e,i))return t[r]=e[i],o||delete e[i],!0}return!1}function ae(t){return i(t)?[yt(t)]:Array.isArray(t)?function t(o,a){var s,u,c,h,l=[];for(s=0;s<o.length;s++)e(u=o[s])||"boolean"==typeof u||(h=l[c=l.length-1],Array.isArray(u)?u.length>0&&(se((u=t(u,(a||"")+"_"+s))[0])&&se(h)&&(l[c]=yt(h.text+u[0].text),u.shift()),l.push.apply(l,u)):i(u)?se(h)?l[c]=yt(h.text+u):""!==u&&l.push(yt(u)):se(u)&&se(h)?l[c]=yt(h.text+u.text):(r(o._isVList)&&n(u.tag)&&e(u.key)&&n(a)&&(u.key="__vlist"+a+"_"+s+"__"),l.push(u)));return l}(t):void 0}function se(t){return n(t)&&n(t.text)&&!1===t.isComment}function ue(t,e){if(t){for(var n=Object.create(null),r=ot?Reflect.ownKeys(t):Object.keys(t),i=0;i<r.length;i++){var o=r[i];if("__ob__"!==o){for(var a=t[o].from,s=e;s;){if(s._provided&&g(s._provided,a)){n[o]=s._provided[a];break}s=s.$parent}if(!s&&"default"in t[o]){var u=t[o].default;n[o]="function"==typeof u?u.call(e):u}}}return n}}function ce(t,e){if(!t||!t.length)return{};for(var n={},r=0,i=t.length;r<i;r++){var o=t[r],a=o.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,o.context!==e&&o.fnContext!==e||!a||null==a.slot)(n.default||(n.default=[])).push(o);else{var s=a.slot,u=n[s]||(n[s]=[]);"template"===o.tag?u.push.apply(u,o.children||[]):u.push(o)}}for(var c in n)n[c].every(he)&&delete n[c];return n}function he(t){return t.isComment&&!t.asyncFactory||" "===t.text}function le(e,n,r){var i,o=Object.keys(n).length>0,a=e?!!e.$stable:!o,s=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(a&&r&&r!==t&&s===r.$key&&!o&&!r.$hasNormal)return r;for(var u in i={},e)e[u]&&"$"!==u[0]&&(i[u]=fe(n,u,e[u]))}else i={};for(var c in n)c in i||(i[c]=pe(n,c));return e&&Object.isExtensible(e)&&(e._normalized=i),V(i,"$stable",a),V(i,"$key",s),V(i,"$hasNormal",o),i}function fe(t,e,n){var r=function(){var t=arguments.length?n.apply(null,arguments):n({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:ae(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return n.proxy&&Object.defineProperty(t,e,{get:r,enumerable:!0,configurable:!0}),r}function pe(t,e){return function(){return t[e]}}function de(t,e){var r,i,a,s,u;if(Array.isArray(t)||"string"==typeof t)for(r=new Array(t.length),i=0,a=t.length;i<a;i++)r[i]=e(t[i],i);else if("number"==typeof t)for(r=new Array(t),i=0;i<t;i++)r[i]=e(i+1,i);else if(o(t))if(ot&&t[Symbol.iterator]){r=[];for(var c=t[Symbol.iterator](),h=c.next();!h.done;)r.push(e(h.value,r.length)),h=c.next()}else for(s=Object.keys(t),r=new Array(s.length),i=0,a=s.length;i<a;i++)u=s[i],r[i]=e(t[u],u,i);return n(r)||(r=[]),r._isVList=!0,r}function ye(t,e,n,r){var i,o=this.$scopedSlots[t];o?(n=n||{},r&&(n=I(I({},r),n)),i=o(n)||e):i=this.$slots[t]||e;var a=n&&n.slot;return a?this.$createElement("template",{slot:a},i):i}function me(t){return Lt(this.$options,"filters",t)||R}function ge(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function ve(t,e,n,r,i){var o=F.keyCodes[e]||n;return i&&r&&!F.keyCodes[e]?ge(i,r):o?ge(o,t):r?T(r)!==e:void 0}function be(t,e,n,r,i){if(n&&o(n)){var a;Array.isArray(n)&&(n=A(n));var s=function(o){if("class"===o||"style"===o||d(o))a=t;else{var s=t.attrs&&t.attrs.type;a=r||F.mustUseProp(e,s,o)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var u=_(o),c=T(o);u in a||c in a||(a[o]=n[o],i&&((t.on||(t.on={}))["update:"+o]=function(t){n[o]=t}))};for(var u in n)s(u)}return t}function _e(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e?r:(Ee(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),r)}function we(t,e,n){return Ee(t,"__once__"+e+(n?"_"+n:""),!0),t}function Ee(t,e,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&"string"!=typeof t[r]&&Te(t[r],e+"_"+r,n);else Te(t,e,n)}function Te(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function Se(t,e){if(e&&s(e)){var n=t.on=t.on?I({},t.on):{};for(var r in e){var i=n[r],o=e[r];n[r]=i?[].concat(i,o):o}}return t}function Ce(t,e,n,r){e=e||{$stable:!n};for(var i=0;i<t.length;i++){var o=t[i];Array.isArray(o)?Ce(o,e,n):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return r&&(e.$key=r),e}function Ie(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"==typeof r&&r&&(t[e[n]]=e[n+1])}return t}function Ae(t,e){return"string"==typeof t?e+t:t}function Ne(t){t._o=we,t._n=l,t._s=h,t._l=de,t._t=ye,t._q=P,t._i=k,t._m=_e,t._f=me,t._k=ve,t._b=be,t._v=yt,t._e=dt,t._u=Ce,t._g=Se,t._d=Ie,t._p=Ae}function De(e,n,i,o,a){var s,u=this,c=a.options;g(o,"_uid")?(s=Object.create(o))._original=o:(s=o,o=o._original);var h=r(c._compiled),l=!h;this.data=e,this.props=n,this.children=i,this.parent=o,this.listeners=e.on||t,this.injections=ue(c.inject,o),this.slots=function(){return u.$slots||le(e.scopedSlots,u.$slots=ce(i,o)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return le(e.scopedSlots,this.slots())}}),h&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=le(e.scopedSlots,this.$slots)),c._scopeId?this._c=function(t,e,n,r){var i=Ue(s,t,e,n,r,l);return i&&!Array.isArray(i)&&(i.fnScopeId=c._scopeId,i.fnContext=o),i}:this._c=function(t,e,n,r){return Ue(s,t,e,n,r,l)}}function Re(t,e,n,r,i){var o=mt(t);return o.fnContext=n,o.fnOptions=r,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function Pe(t,e){for(var n in e)t[_(n)]=e[n]}Ne(De.prototype);var ke={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var r=t;ke.prepatch(r,r)}else(t.componentInstance=function(t,e){var r={_isComponent:!0,_parentVnode:t,parent:Qe},i=t.data.inlineTemplate;return n(i)&&(r.render=i.render,r.staticRenderFns=i.staticRenderFns),new t.componentOptions.Ctor(r)}(t)).$mount(e?t.elm:void 0,e)},prepatch:function(e,n){var r=n.componentOptions;!function(e,n,r,i,o){var a=i.data.scopedSlots,s=e.$scopedSlots,u=!!(a&&!a.$stable||s!==t&&!s.$stable||a&&e.$scopedSlots.$key!==a.$key),c=!!(o||e.$options._renderChildren||u);if(e.$options._parentVnode=i,e.$vnode=i,e._vnode&&(e._vnode.parent=i),e.$options._renderChildren=o,e.$attrs=i.data.attrs||t,e.$listeners=r||t,n&&e.$options.props){wt(!1);for(var h=e._props,l=e.$options._propKeys||[],f=0;f<l.length;f++){var p=l[f],d=e.$options.props;h[p]=xt(p,d,n,e)}wt(!0),e.$options.propsData=n}r=r||t;var y=e.$options._parentListeners;e.$options._parentListeners=r,$e(e,r,y),c&&(e.$slots=ce(o,i.context),e.$forceUpdate())}(n.componentInstance=e.componentInstance,r.propsData,r.listeners,n,r.children)},insert:function(t){var e,n=t.context,r=t.componentInstance;r._isMounted||(r._isMounted=!0,Je(r,"mounted")),t.data.keepAlive&&(n._isMounted?((e=r)._inactive=!1,tn.push(e)):Xe(r,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?function t(e,n){if(!(n&&(e._directInactive=!0,Ye(e))||e._inactive)){e._inactive=!0;for(var r=0;r<e.$children.length;r++)t(e.$children[r]);Je(e,"deactivated")}}(e,!0):e.$destroy())}},Oe=Object.keys(ke);function Le(i,a,s,u,h){if(!e(i)){var l=s.$options._base;if(o(i)&&(i=l.extend(i)),"function"==typeof i){var f;if(e(i.cid)&&void 0===(i=function(t,i){if(r(t.error)&&n(t.errorComp))return t.errorComp;if(n(t.resolved))return t.resolved;var a=Be;if(a&&n(t.owners)&&-1===t.owners.indexOf(a)&&t.owners.push(a),r(t.loading)&&n(t.loadingComp))return t.loadingComp;if(a&&!n(t.owners)){var s=t.owners=[a],u=!0,h=null,l=null;a.$on("hook:destroyed",function(){return y(s,a)});var f=function(t){for(var e=0,n=s.length;e<n;e++)s[e].$forceUpdate();t&&(s.length=0,null!==h&&(clearTimeout(h),h=null),null!==l&&(clearTimeout(l),l=null))},p=O(function(e){t.resolved=qe(e,i),u?s.length=0:f(!0)}),d=O(function(e){n(t.errorComp)&&(t.error=!0,f(!0))}),m=t(p,d);return o(m)&&(c(m)?e(t.resolved)&&m.then(p,d):c(m.component)&&(m.component.then(p,d),n(m.error)&&(t.errorComp=qe(m.error,i)),n(m.loading)&&(t.loadingComp=qe(m.loading,i),0===m.delay?t.loading=!0:h=setTimeout(function(){h=null,e(t.resolved)&&e(t.error)&&(t.loading=!0,f(!1))},m.delay||200)),n(m.timeout)&&(l=setTimeout(function(){l=null,e(t.resolved)&&d(null)},m.timeout)))),u=!1,t.loading?t.loadingComp:t.resolved}}(f=i,l)))return function(t,e,n,r,i){var o=dt();return o.asyncFactory=t,o.asyncMeta={data:e,context:n,children:r,tag:i},o}(f,a,s,u,h);a=a||{},_n(i),n(a.model)&&function(t,e){var r=t.model&&t.model.prop||"value",i=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[r]=e.model.value;var o=e.on||(e.on={}),a=o[i],s=e.model.callback;n(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(o[i]=[s].concat(a)):o[i]=s}(i.options,a);var p=function(t,r,i){var o=r.options.props;if(!e(o)){var a={},s=t.attrs,u=t.props;if(n(s)||n(u))for(var c in o){var h=T(c);oe(a,u,c,h,!0)||oe(a,s,c,h,!1)}return a}}(a,i);if(r(i.options.functional))return function(e,r,i,o,a){var s=e.options,u={},c=s.props;if(n(c))for(var h in c)u[h]=xt(h,c,r||t);else n(i.attrs)&&Pe(u,i.attrs),n(i.props)&&Pe(u,i.props);var l=new De(i,u,a,o,e),f=s.render.call(null,l._c,l);if(f instanceof ft)return Re(f,i,l.parent,s);if(Array.isArray(f)){for(var p=ae(f)||[],d=new Array(p.length),y=0;y<p.length;y++)d[y]=Re(p[y],i,l.parent,s);return d}}(i,p,a,s,u);var d=a.on;if(a.on=a.nativeOn,r(i.options.abstract)){var m=a.slot;a={},m&&(a.slot=m)}!function(t){for(var e=t.hook||(t.hook={}),n=0;n<Oe.length;n++){var r=Oe[n],i=e[r],o=ke[r];i===o||i&&i._merged||(e[r]=i?xe(o,i):o)}}(a);var g=i.options.name||h;return new ft("vue-component-"+i.cid+(g?"-"+g:""),a,void 0,void 0,void 0,s,{Ctor:i,propsData:p,listeners:d,tag:h,children:u},f)}}}function xe(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}var Me=1,Fe=2;function Ue(t,a,s,u,c,h){return(Array.isArray(s)||i(s))&&(c=u,u=s,s=void 0),r(h)&&(c=Fe),function(t,i,a,s,u){if(n(a)&&n(a.__ob__))return dt();if(n(a)&&n(a.is)&&(i=a.is),!i)return dt();var c,h,l;(Array.isArray(s)&&"function"==typeof s[0]&&((a=a||{}).scopedSlots={default:s[0]},s.length=0),u===Fe?s=ae(s):u===Me&&(s=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(s)),"string"==typeof i)?(h=t.$vnode&&t.$vnode.ns||F.getTagNamespace(i),c=F.isReservedTag(i)?new ft(F.parsePlatformTagName(i),a,s,void 0,void 0,t):a&&a.pre||!n(l=Lt(t.$options,"components",i))?new ft(i,a,s,void 0,void 0,t):Le(l,a,t,s,i)):c=Le(i,a,t,s);return Array.isArray(c)?c:n(c)?(n(h)&&function t(i,o,a){if(i.ns=o,"foreignObject"===i.tag&&(o=void 0,a=!0),n(i.children))for(var s=0,u=i.children.length;s<u;s++){var c=i.children[s];n(c.tag)&&(e(c.ns)||r(a)&&"svg"!==c.tag)&&t(c,o,a)}}(c,h),n(a)&&function(t){o(t.style)&&te(t.style),o(t.class)&&te(t.class)}(a),c):dt()}(t,a,s,u,c)}var Ve,Be=null;function qe(t,e){return(t.__esModule||ot&&"Module"===t[Symbol.toStringTag])&&(t=t.default),o(t)?e.extend(t):t}function je(t){return t.isComment&&t.asyncFactory}function We(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var r=t[e];if(n(r)&&(n(r.componentOptions)||je(r)))return r}}function Ke(t,e){Ve.$on(t,e)}function He(t,e){Ve.$off(t,e)}function Ge(t,e){var n=Ve;return function r(){null!==e.apply(null,arguments)&&n.$off(t,r)}}function $e(t,e,n){Ve=t,re(e,n||{},Ke,He,Ge,t),Ve=void 0}var Qe=null;function ze(t){var e=Qe;return Qe=t,function(){Qe=e}}function Ye(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function Xe(t,e){if(e){if(t._directInactive=!1,Ye(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)Xe(t.$children[n]);Je(t,"activated")}}function Je(t,e){ht();var n=t.$options[e],r=e+" hook";if(n)for(var i=0,o=n.length;i<o;i++)Bt(n[i],t,null,t,r);t._hasHookEvent&&t.$emit("hook:"+e),lt()}var Ze=[],tn=[],en={},nn=!1,rn=!1,on=0,an=0,sn=Date.now;if(W&&!$){var un=window.performance;un&&"function"==typeof un.now&&sn()>document.createEvent("Event").timeStamp&&(sn=function(){return un.now()})}function cn(){var t,e;for(an=sn(),rn=!0,Ze.sort(function(t,e){return t.id-e.id}),on=0;on<Ze.length;on++)(t=Ze[on]).before&&t.before(),e=t.id,en[e]=null,t.run();var n=tn.slice(),r=Ze.slice();on=Ze.length=tn.length=0,en={},nn=rn=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Xe(t[e],!0)}(n),function(t){for(var e=t.length;e--;){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&Je(r,"updated")}}(r),nt&&F.devtools&&nt.emit("flush")}var hn=0,ln=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++hn,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new it,this.newDepIds=new it,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!q.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}(e),this.getter||(this.getter=N)),this.value=this.lazy?void 0:this.get()};ln.prototype.get=function(){var t;ht(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Vt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&te(t),lt(),this.cleanupDeps()}return t},ln.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},ln.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},ln.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==en[e]){if(en[e]=!0,rn){for(var n=Ze.length-1;n>on&&Ze[n].id>t.id;)n--;Ze.splice(n+1,0,t)}else Ze.push(t);nn||(nn=!0,Jt(cn))}}(this)},ln.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||o(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){Vt(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},ln.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},ln.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},ln.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var fn={enumerable:!0,configurable:!0,get:N,set:N};function pn(t,e,n){fn.get=function(){return this[e][n]},fn.set=function(t){this[e][n]=t},Object.defineProperty(t,n,fn)}var dn={lazy:!0};function yn(t,e,n){var r=!et();"function"==typeof n?(fn.get=r?mn(e):gn(n),fn.set=N):(fn.get=n.get?r&&!1!==n.cache?mn(e):gn(n.get):N,fn.set=n.set||N),Object.defineProperty(t,e,fn)}function mn(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ut.target&&e.depend(),e.value}}function gn(t){return function(){return t.call(this,this)}}function vn(t,e,n,r){return s(n)&&(r=n,n=n.handler),"string"==typeof n&&(n=t[n]),t.$watch(e,n,r)}var bn=0;function _n(t){var e=t.options;if(t.super){var n=_n(t.super);if(n!==t.superOptions){t.superOptions=n;var r=function(t){var e,n=t.options,r=t.sealedOptions;for(var i in n)n[i]!==r[i]&&(e||(e={}),e[i]=n[i]);return e}(t);r&&I(t.extendOptions,r),(e=t.options=Ot(n,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function wn(t){this._init(t)}function En(t){return t&&(t.Ctor.options.name||t.tag)}function Tn(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:(n=t,"[object RegExp]"===a.call(n)&&t.test(e));var n}function Sn(t,e){var n=t.cache,r=t.keys,i=t._vnode;for(var o in n){var a=n[o];if(a){var s=En(a.componentOptions);s&&!e(s)&&Cn(n,o,r,i)}}}function Cn(t,e,n,r){var i=t[e];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),t[e]=null,y(n,e)}wn.prototype._init=function(e){var n=this;n._uid=bn++,n._isVue=!0,e&&e._isComponent?function(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var i=r.componentOptions;n.propsData=i.propsData,n._parentListeners=i.listeners,n._renderChildren=i.children,n._componentTag=i.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}(n,e):n.$options=Ot(_n(n.constructor),e||{},n),n._renderProxy=n,n._self=n,function(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(n),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&$e(t,e)}(n),function(e){e._vnode=null,e._staticTrees=null;var n=e.$options,r=e.$vnode=n._parentVnode,i=r&&r.context;e.$slots=ce(n._renderChildren,i),e.$scopedSlots=t,e._c=function(t,n,r,i){return Ue(e,t,n,r,i,!1)},e.$createElement=function(t,n,r,i){return Ue(e,t,n,r,i,!0)};var o=r&&r.data;St(e,"$attrs",o&&o.attrs||t,null,!0),St(e,"$listeners",n._parentListeners||t,null,!0)}(n),Je(n,"beforeCreate"),function(t){var e=ue(t.$options.inject,t);e&&(wt(!1),Object.keys(e).forEach(function(n){St(t,n,e[n])}),wt(!0))}(n),function(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var n=t.$options.propsData||{},r=t._props={},i=t.$options._propKeys=[];t.$parent&&wt(!1);var o=function(o){i.push(o);var a=xt(o,e,n,t);St(r,o,a),o in t||pn(t,"_props",o)};for(var a in e)o(a);wt(!0)}(t,e.props),e.methods&&function(t,e){for(var n in t.$options.props,e)t[n]="function"!=typeof e[n]?N:S(e[n],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;s(e=t._data="function"==typeof e?function(t,e){ht();try{return t.call(e,e)}catch(t){return Vt(t,e,"data()"),{}}finally{lt()}}(e,t):e||{})||(e={});for(var n,r=Object.keys(e),i=t.$options.props,o=(t.$options.methods,r.length);o--;){var a=r[o];i&&g(i,a)||36!==(n=(a+"").charCodeAt(0))&&95!==n&&pn(t,"_data",a)}Tt(e,!0)}(t):Tt(t._data={},!0),e.computed&&function(t,e){var n=t._computedWatchers=Object.create(null),r=et();for(var i in e){var o=e[i],a="function"==typeof o?o:o.get;r||(n[i]=new ln(t,a||N,N,dn)),i in t||yn(t,i,o)}}(t,e.computed),e.watch&&e.watch!==J&&function(t,e){for(var n in e){var r=e[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)vn(t,n,r[i]);else vn(t,n,r)}}(t,e.watch)}(n),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(n),Je(n,"created"),n.$options.el&&n.$mount(n.$options.el)},function(t){Object.defineProperty(t.prototype,"$data",{get:function(){return this._data}}),Object.defineProperty(t.prototype,"$props",{get:function(){return this._props}}),t.prototype.$set=Ct,t.prototype.$delete=It,t.prototype.$watch=function(t,e,n){if(s(e))return vn(this,t,e,n);(n=n||{}).user=!0;var r=new ln(this,t,e,n);if(n.immediate)try{e.call(this,r.value)}catch(t){Vt(t,this,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}(wn),function(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(Array.isArray(t))for(var i=0,o=t.length;i<o;i++)r.$on(t[i],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(t)){for(var r=0,i=t.length;r<i;r++)n.$off(t[r],e);return n}var o,a=n._events[t];if(!a)return n;if(!e)return n._events[t]=null,n;for(var s=a.length;s--;)if((o=a[s])===e||o.fn===e){a.splice(s,1);break}return n},t.prototype.$emit=function(t){var e=this._events[t];if(e){e=e.length>1?C(e):e;for(var n=C(arguments,1),r='event handler for "'+t+'"',i=0,o=e.length;i<o;i++)Bt(e[i],this,n,this,r)}return this}}(wn),function(t){t.prototype._update=function(t,e){var n=this,r=n.$el,i=n._vnode,o=ze(n);n._vnode=t,n.$el=i?n.__patch__(i,t):n.__patch__(n.$el,t,e,!1),o(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Je(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||y(e.$children,t),t._watcher&&t._watcher.teardown();for(var n=t._watchers.length;n--;)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Je(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(wn),function(t){Ne(t.prototype),t.prototype.$nextTick=function(t){return Jt(t,this)},t.prototype._render=function(){var t,e=this,n=e.$options,r=n.render,i=n._parentVnode;i&&(e.$scopedSlots=le(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{Be=e,t=r.call(e._renderProxy,e.$createElement)}catch(n){Vt(n,e,"render"),t=e._vnode}finally{Be=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof ft||(t=dt()),t.parent=i,t}}(wn);var In=[String,RegExp,Array],An={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:In,exclude:In,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Cn(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",function(e){Sn(t,function(t){return Tn(e,t)})}),this.$watch("exclude",function(e){Sn(t,function(t){return!Tn(e,t)})})},render:function(){var t=this.$slots.default,e=We(t),n=e&&e.componentOptions;if(n){var r=En(n),i=this.include,o=this.exclude;if(i&&(!r||!Tn(i,r))||o&&r&&Tn(o,r))return e;var a=this.cache,s=this.keys,u=null==e.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):e.key;a[u]?(e.componentInstance=a[u].componentInstance,y(s,u),s.push(u)):(a[u]=e,s.push(u),this.max&&s.length>parseInt(this.max)&&Cn(a,s[0],s,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e={get:function(){return F}};Object.defineProperty(t,"config",e),t.util={warn:at,extend:I,mergeOptions:Ot,defineReactive:St},t.set=Ct,t.delete=It,t.nextTick=Jt,t.observable=function(t){return Tt(t),t},t.options=Object.create(null),x.forEach(function(e){t.options[e+"s"]=Object.create(null)}),t.options._base=t,I(t.options.components,An),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=C(arguments,1);return n.unshift(this),"function"==typeof t.install?t.install.apply(t,n):"function"==typeof t&&t.apply(null,n),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Ot(this.options,t),this}}(t),function(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,i=t._Ctor||(t._Ctor={});if(i[r])return i[r];var o=t.name||n.options.name,a=function(t){this._init(t)};return(a.prototype=Object.create(n.prototype)).constructor=a,a.cid=e++,a.options=Ot(n.options,t),a.super=n,a.options.props&&function(t){var e=t.options.props;for(var n in e)pn(t.prototype,"_props",n)}(a),a.options.computed&&function(t){var e=t.options.computed;for(var n in e)yn(t.prototype,n,e[n])}(a),a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,x.forEach(function(t){a[t]=n[t]}),o&&(a.options.components[o]=a),a.superOptions=n.options,a.extendOptions=t,a.sealedOptions=I({},a.options),i[r]=a,a}}(t),function(t){x.forEach(function(e){t[e]=function(t,n){return n?("component"===e&&s(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"==typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}})}(t)}(wn),Object.defineProperty(wn.prototype,"$isServer",{get:et}),Object.defineProperty(wn.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(wn,"FunctionalRenderContext",{value:De}),wn.version="2.6.10";var Nn=f("style,class"),Dn=f("input,textarea,option,select,progress"),Rn=function(t,e,n){return"value"===n&&Dn(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},Pn=f("contenteditable,draggable,spellcheck"),kn=f("events,caret,typing,plaintext-only"),On=function(t,e){return Un(e)||"false"===e?"false":"contenteditable"===t&&kn(e)?e:"true"},Ln=f("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),xn="http://www.w3.org/1999/xlink",Mn=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Fn=function(t){return Mn(t)?t.slice(6,t.length):""},Un=function(t){return null==t||!1===t};function Vn(t,e){return{staticClass:Bn(t.staticClass,e.staticClass),class:n(t.class)?[t.class,e.class]:e.class}}function Bn(t,e){return t?e?t+" "+e:t:e||""}function qn(t){return Array.isArray(t)?function(t){for(var e,r="",i=0,o=t.length;i<o;i++)n(e=qn(t[i]))&&""!==e&&(r&&(r+=" "),r+=e);return r}(t):o(t)?function(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}(t):"string"==typeof t?t:""}var jn={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Wn=f("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Kn=f("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Hn=function(t){return Wn(t)||Kn(t)};function Gn(t){return Kn(t)?"svg":"math"===t?"math":void 0}var $n=Object.create(null),Qn=f("text,number,password,search,email,tel,url");function zn(t){return"string"==typeof t?document.querySelector(t)||document.createElement("div"):t}var Yn=Object.freeze({createElement:function(t,e){var n=document.createElement(t);return"select"!==t?n:(e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n)},createElementNS:function(t,e){return document.createElementNS(jn[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),Xn={create:function(t,e){Jn(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Jn(t,!0),Jn(e))},destroy:function(t){Jn(t,!0)}};function Jn(t,e){var r=t.data.ref;if(n(r)){var i=t.context,o=t.componentInstance||t.elm,a=i.$refs;e?Array.isArray(a[r])?y(a[r],o):a[r]===o&&(a[r]=void 0):t.data.refInFor?Array.isArray(a[r])?a[r].indexOf(o)<0&&a[r].push(o):a[r]=[o]:a[r]=o}}var Zn=new ft("",{},[]),tr=["create","activate","update","remove","destroy"];function er(t,i){return t.key===i.key&&(t.tag===i.tag&&t.isComment===i.isComment&&n(t.data)===n(i.data)&&function(t,e){if("input"!==t.tag)return!0;var r,i=n(r=t.data)&&n(r=r.attrs)&&r.type,o=n(r=e.data)&&n(r=r.attrs)&&r.type;return i===o||Qn(i)&&Qn(o)}(t,i)||r(t.isAsyncPlaceholder)&&t.asyncFactory===i.asyncFactory&&e(i.asyncFactory.error))}function nr(t,e,r){var i,o,a={};for(i=e;i<=r;++i)n(o=t[i].key)&&(a[o]=i);return a}var rr={create:ir,update:ir,destroy:function(t){ir(t,Zn)}};function ir(t,e){(t.data.directives||e.data.directives)&&function(t,e){var n,r,i,o=t===Zn,a=e===Zn,s=ar(t.data.directives,t.context),u=ar(e.data.directives,e.context),c=[],h=[];for(n in u)r=s[n],i=u[n],r?(i.oldValue=r.value,i.oldArg=r.arg,ur(i,"update",e,t),i.def&&i.def.componentUpdated&&h.push(i)):(ur(i,"bind",e,t),i.def&&i.def.inserted&&c.push(i));if(c.length){var l=function(){for(var n=0;n<c.length;n++)ur(c[n],"inserted",e,t)};o?ie(e,"insert",l):l()}if(h.length&&ie(e,"postpatch",function(){for(var n=0;n<h.length;n++)ur(h[n],"componentUpdated",e,t)}),!o)for(n in s)u[n]||ur(s[n],"unbind",t,t,a)}(t,e)}var or=Object.create(null);function ar(t,e){var n,r,i=Object.create(null);if(!t)return i;for(n=0;n<t.length;n++)(r=t[n]).modifiers||(r.modifiers=or),i[sr(r)]=r,r.def=Lt(e.$options,"directives",r.name);return i}function sr(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function ur(t,e,n,r,i){var o=t.def&&t.def[e];if(o)try{o(n.elm,t,n,r,i)}catch(r){Vt(r,n.context,"directive "+t.name+" "+e+" hook")}}var cr=[Xn,rr];function hr(t,r){var i=r.componentOptions;if(!(n(i)&&!1===i.Ctor.options.inheritAttrs||e(t.data.attrs)&&e(r.data.attrs))){var o,a,s=r.elm,u=t.data.attrs||{},c=r.data.attrs||{};for(o in n(c.__ob__)&&(c=r.data.attrs=I({},c)),c)a=c[o],u[o]!==a&&lr(s,o,a);for(o in($||z)&&c.value!==u.value&&lr(s,"value",c.value),u)e(c[o])&&(Mn(o)?s.removeAttributeNS(xn,Fn(o)):Pn(o)||s.removeAttribute(o))}}function lr(t,e,n){t.tagName.indexOf("-")>-1?fr(t,e,n):Ln(e)?Un(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):Pn(e)?t.setAttribute(e,On(e,n)):Mn(e)?Un(n)?t.removeAttributeNS(xn,Fn(e)):t.setAttributeNS(xn,e,n):fr(t,e,n)}function fr(t,e,n){if(Un(n))t.removeAttribute(e);else{if($&&!Q&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var pr={create:hr,update:hr};function dr(t,r){var i=r.elm,o=r.data,a=t.data;if(!(e(o.staticClass)&&e(o.class)&&(e(a)||e(a.staticClass)&&e(a.class)))){var s=function(t){for(var e=t.data,r=t,i=t;n(i.componentInstance);)(i=i.componentInstance._vnode)&&i.data&&(e=Vn(i.data,e));for(;n(r=r.parent);)r&&r.data&&(e=Vn(e,r.data));return function(t,e){return n(t)||n(e)?Bn(t,qn(e)):""}(e.staticClass,e.class)}(r),u=i._transitionClasses;n(u)&&(s=Bn(s,qn(u))),s!==i._prevClass&&(i.setAttribute("class",s),i._prevClass=s)}}var yr,mr,gr,vr,br,_r,wr={create:dr,update:dr},Er=/[\w).+\-_$\]]/;function Tr(t){var e,n,r,i,o,a=!1,s=!1,u=!1,c=!1,h=0,l=0,f=0,p=0;for(r=0;r<t.length;r++)if(n=e,e=t.charCodeAt(r),a)39===e&&92!==n&&(a=!1);else if(s)34===e&&92!==n&&(s=!1);else if(u)96===e&&92!==n&&(u=!1);else if(c)47===e&&92!==n&&(c=!1);else if(124!==e||124===t.charCodeAt(r+1)||124===t.charCodeAt(r-1)||h||l||f){switch(e){case 34:s=!0;break;case 39:a=!0;break;case 96:u=!0;break;case 40:f++;break;case 41:f--;break;case 91:l++;break;case 93:l--;break;case 123:h++;break;case 125:h--}if(47===e){for(var d=r-1,y=void 0;d>=0&&" "===(y=t.charAt(d));d--);y&&Er.test(y)||(c=!0)}}else void 0===i?(p=r+1,i=t.slice(0,r).trim()):m();function m(){(o||(o=[])).push(t.slice(p,r).trim()),p=r+1}if(void 0===i?i=t.slice(0,r).trim():0!==p&&m(),o)for(r=0;r<o.length;r++)i=Sr(i,o[r]);return i}function Sr(t,e){var n=e.indexOf("(");if(n<0)return'_f("'+e+'")('+t+")";var r=e.slice(0,n),i=e.slice(n+1);return'_f("'+r+'")('+t+(")"!==i?","+i:i)}function Cr(t,e){console.error("[Vue compiler]: "+t)}function Ir(t,e){return t?t.map(function(t){return t[e]}).filter(function(t){return t}):[]}function Ar(t,e,n,r,i){(t.props||(t.props=[])).push(Mr({name:e,value:n,dynamic:i},r)),t.plain=!1}function Nr(t,e,n,r,i){(i?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Mr({name:e,value:n,dynamic:i},r)),t.plain=!1}function Dr(t,e,n,r){t.attrsMap[e]=n,t.attrsList.push(Mr({name:e,value:n},r))}function Rr(t,e,n,r,i,o,a,s){(t.directives||(t.directives=[])).push(Mr({name:e,rawName:n,value:r,arg:i,isDynamicArg:o,modifiers:a},s)),t.plain=!1}function Pr(t,e,n){return n?"_p("+e+',"'+t+'")':t+e}function kr(e,n,r,i,o,a,s,u){var c;(i=i||t).right?u?n="("+n+")==='click'?'contextmenu':("+n+")":"click"===n&&(n="contextmenu",delete i.right):i.middle&&(u?n="("+n+")==='click'?'mouseup':("+n+")":"click"===n&&(n="mouseup")),i.capture&&(delete i.capture,n=Pr("!",n,u)),i.once&&(delete i.once,n=Pr("~",n,u)),i.passive&&(delete i.passive,n=Pr("&",n,u)),i.native?(delete i.native,c=e.nativeEvents||(e.nativeEvents={})):c=e.events||(e.events={});var h=Mr({value:r.trim(),dynamic:u},s);i!==t&&(h.modifiers=i);var l=c[n];Array.isArray(l)?o?l.unshift(h):l.push(h):c[n]=l?o?[h,l]:[l,h]:h,e.plain=!1}function Or(t,e,n){var r=Lr(t,":"+e)||Lr(t,"v-bind:"+e);if(null!=r)return Tr(r);if(!1!==n){var i=Lr(t,e);if(null!=i)return JSON.stringify(i)}}function Lr(t,e,n){var r;if(null!=(r=t.attrsMap[e]))for(var i=t.attrsList,o=0,a=i.length;o<a;o++)if(i[o].name===e){i.splice(o,1);break}return n&&delete t.attrsMap[e],r}function xr(t,e){for(var n=t.attrsList,r=0,i=n.length;r<i;r++){var o=n[r];if(e.test(o.name))return n.splice(r,1),o}}function Mr(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function Fr(t,e,n){var r=n||{},i=r.number,o="$$v";r.trim&&(o="(typeof $$v === 'string'? $$v.trim(): $$v)"),i&&(o="_n("+o+")");var a=Ur(e,o);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+a+"}"}}function Ur(t,e){var n=function(t){if(t=t.trim(),yr=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<yr-1)return(vr=t.lastIndexOf("."))>-1?{exp:t.slice(0,vr),key:'"'+t.slice(vr+1)+'"'}:{exp:t,key:null};for(mr=t,vr=br=_r=0;!Br();)qr(gr=Vr())?Wr(gr):91===gr&&jr(gr);return{exp:t.slice(0,br),key:t.slice(br+1,_r)}}(t);return null===n.key?t+"="+e:"$set("+n.exp+", "+n.key+", "+e+")"}function Vr(){return mr.charCodeAt(++vr)}function Br(){return vr>=yr}function qr(t){return 34===t||39===t}function jr(t){var e=1;for(br=vr;!Br();)if(qr(t=Vr()))Wr(t);else if(91===t&&e++,93===t&&e--,0===e){_r=vr;break}}function Wr(t){for(var e=t;!Br()&&(t=Vr())!==e;);}var Kr,Hr="__r",Gr="__c";function $r(t,e,n){var r=Kr;return function i(){null!==e.apply(null,arguments)&&Yr(t,i,n,r)}}var Qr=Kt&&!(X&&Number(X[1])<=53);function zr(t,e,n,r){if(Qr){var i=an,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=i||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}Kr.addEventListener(t,e,Z?{capture:n,passive:r}:n)}function Yr(t,e,n,r){(r||Kr).removeEventListener(t,e._wrapper||e,n)}function Xr(t,r){if(!e(t.data.on)||!e(r.data.on)){var i=r.data.on||{},o=t.data.on||{};Kr=r.elm,function(t){if(n(t[Hr])){var e=$?"change":"input";t[e]=[].concat(t[Hr],t[e]||[]),delete t[Hr]}n(t[Gr])&&(t.change=[].concat(t[Gr],t.change||[]),delete t[Gr])}(i),re(i,o,zr,Yr,$r,r.context),Kr=void 0}}var Jr,Zr={create:Xr,update:Xr};function ti(t,r){if(!e(t.data.domProps)||!e(r.data.domProps)){var i,o,a=r.elm,s=t.data.domProps||{},u=r.data.domProps||{};for(i in n(u.__ob__)&&(u=r.data.domProps=I({},u)),s)i in u||(a[i]="");for(i in u){if(o=u[i],"textContent"===i||"innerHTML"===i){if(r.children&&(r.children.length=0),o===s[i])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===i&&"PROGRESS"!==a.tagName){a._value=o;var c=e(o)?"":String(o);ei(a,c)&&(a.value=c)}else if("innerHTML"===i&&Kn(a.tagName)&&e(a.innerHTML)){(Jr=Jr||document.createElement("div")).innerHTML="<svg>"+o+"</svg>";for(var h=Jr.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;h.firstChild;)a.appendChild(h.firstChild)}else if(o!==s[i])try{a[i]=o}catch(t){}}}}function ei(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var n=!0;try{n=document.activeElement!==t}catch(t){}return n&&t.value!==e}(t,e)||function(t,e){var r=t.value,i=t._vModifiers;if(n(i)){if(i.number)return l(r)!==l(e);if(i.trim)return r.trim()!==e.trim()}return r!==e}(t,e))}var ni={create:ti,update:ti},ri=v(function(t){var e={},n=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach(function(t){if(t){var r=t.split(n);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e});function ii(t){var e=oi(t.style);return t.staticStyle?I(t.staticStyle,e):e}function oi(t){return Array.isArray(t)?A(t):"string"==typeof t?ri(t):t}var ai,si=/^--/,ui=/\s*!important$/,ci=function(t,e,n){if(si.test(e))t.style.setProperty(e,n);else if(ui.test(n))t.style.setProperty(T(e),n.replace(ui,""),"important");else{var r=li(e);if(Array.isArray(n))for(var i=0,o=n.length;i<o;i++)t.style[r]=n[i];else t.style[r]=n}},hi=["Webkit","Moz","ms"],li=v(function(t){if(ai=ai||document.createElement("div").style,"filter"!==(t=_(t))&&t in ai)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<hi.length;n++){var r=hi[n]+e;if(r in ai)return r}});function fi(t,r){var i=r.data,o=t.data;if(!(e(i.staticStyle)&&e(i.style)&&e(o.staticStyle)&&e(o.style))){var a,s,u=r.elm,c=o.staticStyle,h=o.normalizedStyle||o.style||{},l=c||h,f=oi(r.data.style)||{};r.data.normalizedStyle=n(f.__ob__)?I({},f):f;var p=function(t,e){for(var n,r={},i=t;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(n=ii(i.data))&&I(r,n);(n=ii(t.data))&&I(r,n);for(var o=t;o=o.parent;)o.data&&(n=ii(o.data))&&I(r,n);return r}(r);for(s in l)e(p[s])&&ci(u,s,"");for(s in p)(a=p[s])!==l[s]&&ci(u,s,null==a?"":a)}}var pi={create:fi,update:fi},di=/\s+/;function yi(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(di).forEach(function(e){return t.classList.add(e)}):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function mi(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(di).forEach(function(e){return t.classList.remove(e)}):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";n.indexOf(r)>=0;)n=n.replace(r," ");(n=n.trim())?t.setAttribute("class",n):t.removeAttribute("class")}}function gi(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&I(e,vi(t.name||"v")),I(e,t),e}return"string"==typeof t?vi(t):void 0}}var vi=v(function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}}),bi=W&&!Q,_i="transition",wi="animation",Ei="transition",Ti="transitionend",Si="animation",Ci="animationend";bi&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Ei="WebkitTransition",Ti="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Si="WebkitAnimation",Ci="webkitAnimationEnd"));var Ii=W?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Ai(t){Ii(function(){Ii(t)})}function Ni(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),yi(t,e))}function Di(t,e){t._transitionClasses&&y(t._transitionClasses,e),mi(t,e)}function Ri(t,e,n){var r=ki(t,e),i=r.type,o=r.timeout,a=r.propCount;if(!i)return n();var s=i===_i?Ti:Ci,u=0,c=function(){t.removeEventListener(s,h),n()},h=function(e){e.target===t&&++u>=a&&c()};setTimeout(function(){u<a&&c()},o+1),t.addEventListener(s,h)}var Pi=/\b(transform|all)(,|$)/;function ki(t,e){var n,r=window.getComputedStyle(t),i=(r[Ei+"Delay"]||"").split(", "),o=(r[Ei+"Duration"]||"").split(", "),a=Oi(i,o),s=(r[Si+"Delay"]||"").split(", "),u=(r[Si+"Duration"]||"").split(", "),c=Oi(s,u),h=0,l=0;return e===_i?a>0&&(n=_i,h=a,l=o.length):e===wi?c>0&&(n=wi,h=c,l=u.length):l=(n=(h=Math.max(a,c))>0?a>c?_i:wi:null)?n===_i?o.length:u.length:0,{type:n,timeout:h,propCount:l,hasTransform:n===_i&&Pi.test(r[Ei+"Property"])}}function Oi(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,n){return Li(e)+Li(t[n])}))}function Li(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function xi(t,r){var i=t.elm;n(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var a=gi(t.data.transition);if(!e(a)&&!n(i._enterCb)&&1===i.nodeType){for(var s=a.css,u=a.type,c=a.enterClass,h=a.enterToClass,f=a.enterActiveClass,p=a.appearClass,d=a.appearToClass,y=a.appearActiveClass,m=a.beforeEnter,g=a.enter,v=a.afterEnter,b=a.enterCancelled,_=a.beforeAppear,w=a.appear,E=a.afterAppear,T=a.appearCancelled,S=a.duration,C=Qe,I=Qe.$vnode;I&&I.parent;)C=I.context,I=I.parent;var A=!C._isMounted||!t.isRootInsert;if(!A||w||""===w){var N=A&&p?p:c,D=A&&y?y:f,R=A&&d?d:h,P=A&&_||m,k=A&&"function"==typeof w?w:g,L=A&&E||v,x=A&&T||b,M=l(o(S)?S.enter:S),F=!1!==s&&!Q,U=Ui(k),V=i._enterCb=O(function(){F&&(Di(i,R),Di(i,D)),V.cancelled?(F&&Di(i,N),x&&x(i)):L&&L(i),i._enterCb=null});t.data.show||ie(t,"insert",function(){var e=i.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),k&&k(i,V)}),P&&P(i),F&&(Ni(i,N),Ni(i,D),Ai(function(){Di(i,N),V.cancelled||(Ni(i,R),U||(Fi(M)?setTimeout(V,M):Ri(i,u,V)))})),t.data.show&&(r&&r(),k&&k(i,V)),F||U||V()}}}function Mi(t,r){var i=t.elm;n(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var a=gi(t.data.transition);if(e(a)||1!==i.nodeType)return r();if(!n(i._leaveCb)){var s=a.css,u=a.type,c=a.leaveClass,h=a.leaveToClass,f=a.leaveActiveClass,p=a.beforeLeave,d=a.leave,y=a.afterLeave,m=a.leaveCancelled,g=a.delayLeave,v=a.duration,b=!1!==s&&!Q,_=Ui(d),w=l(o(v)?v.leave:v),E=i._leaveCb=O(function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),b&&(Di(i,h),Di(i,f)),E.cancelled?(b&&Di(i,c),m&&m(i)):(r(),y&&y(i)),i._leaveCb=null});g?g(T):T()}function T(){E.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),p&&p(i),b&&(Ni(i,c),Ni(i,f),Ai(function(){Di(i,c),E.cancelled||(Ni(i,h),_||(Fi(w)?setTimeout(E,w):Ri(i,u,E)))})),d&&d(i,E),b||_||E())}}function Fi(t){return"number"==typeof t&&!isNaN(t)}function Ui(t){if(e(t))return!1;var r=t.fns;return n(r)?Ui(Array.isArray(r)?r[0]:r):(t._length||t.length)>1}function Vi(t,e){!0!==e.data.show&&xi(e)}var Bi=function(t){var o,a,s={},u=t.modules,c=t.nodeOps;for(o=0;o<tr.length;++o)for(s[tr[o]]=[],a=0;a<u.length;++a)n(u[a][tr[o]])&&s[tr[o]].push(u[a][tr[o]]);function h(t){var e=c.parentNode(t);n(e)&&c.removeChild(e,t)}function l(t,e,i,o,a,u,h){if(n(t.elm)&&n(u)&&(t=u[h]=mt(t)),t.isRootInsert=!a,!function(t,e,i,o){var a=t.data;if(n(a)){var u=n(t.componentInstance)&&a.keepAlive;if(n(a=a.hook)&&n(a=a.init)&&a(t,!1),n(t.componentInstance))return p(t,e),d(i,t.elm,o),r(u)&&function(t,e,r,i){for(var o,a=t;a.componentInstance;)if(n(o=(a=a.componentInstance._vnode).data)&&n(o=o.transition)){for(o=0;o<s.activate.length;++o)s.activate[o](Zn,a);e.push(a);break}d(r,t.elm,i)}(t,e,i,o),!0}}(t,e,i,o)){var l=t.data,f=t.children,m=t.tag;n(m)?(t.elm=t.ns?c.createElementNS(t.ns,m):c.createElement(m,t),v(t),y(t,f,e),n(l)&&g(t,e),d(i,t.elm,o)):r(t.isComment)?(t.elm=c.createComment(t.text),d(i,t.elm,o)):(t.elm=c.createTextNode(t.text),d(i,t.elm,o))}}function p(t,e){n(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,m(t)?(g(t,e),v(t)):(Jn(t),e.push(t))}function d(t,e,r){n(t)&&(n(r)?c.parentNode(r)===t&&c.insertBefore(t,e,r):c.appendChild(t,e))}function y(t,e,n){if(Array.isArray(e))for(var r=0;r<e.length;++r)l(e[r],n,t.elm,null,!0,e,r);else i(t.text)&&c.appendChild(t.elm,c.createTextNode(String(t.text)))}function m(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return n(t.tag)}function g(t,e){for(var r=0;r<s.create.length;++r)s.create[r](Zn,t);n(o=t.data.hook)&&(n(o.create)&&o.create(Zn,t),n(o.insert)&&e.push(t))}function v(t){var e;if(n(e=t.fnScopeId))c.setStyleScope(t.elm,e);else for(var r=t;r;)n(e=r.context)&&n(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e),r=r.parent;n(e=Qe)&&e!==t.context&&e!==t.fnContext&&n(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e)}function b(t,e,n,r,i,o){for(;r<=i;++r)l(n[r],o,t,e,!1,n,r)}function _(t){var e,r,i=t.data;if(n(i))for(n(e=i.hook)&&n(e=e.destroy)&&e(t),e=0;e<s.destroy.length;++e)s.destroy[e](t);if(n(e=t.children))for(r=0;r<t.children.length;++r)_(t.children[r])}function w(t,e,r,i){for(;r<=i;++r){var o=e[r];n(o)&&(n(o.tag)?(E(o),_(o)):h(o.elm))}}function E(t,e){if(n(e)||n(t.data)){var r,i=s.remove.length+1;for(n(e)?e.listeners+=i:e=function(t,e){function n(){0==--n.listeners&&h(t)}return n.listeners=e,n}(t.elm,i),n(r=t.componentInstance)&&n(r=r._vnode)&&n(r.data)&&E(r,e),r=0;r<s.remove.length;++r)s.remove[r](t,e);n(r=t.data.hook)&&n(r=r.remove)?r(t,e):e()}else h(t.elm)}function T(t,e,r,i){for(var o=r;o<i;o++){var a=e[o];if(n(a)&&er(t,a))return o}}function S(t,i,o,a,u,h){if(t!==i){n(i.elm)&&n(a)&&(i=a[u]=mt(i));var f=i.elm=t.elm;if(r(t.isAsyncPlaceholder))n(i.asyncFactory.resolved)?A(t.elm,i,o):i.isAsyncPlaceholder=!0;else if(r(i.isStatic)&&r(t.isStatic)&&i.key===t.key&&(r(i.isCloned)||r(i.isOnce)))i.componentInstance=t.componentInstance;else{var p,d=i.data;n(d)&&n(p=d.hook)&&n(p=p.prepatch)&&p(t,i);var y=t.children,g=i.children;if(n(d)&&m(i)){for(p=0;p<s.update.length;++p)s.update[p](t,i);n(p=d.hook)&&n(p=p.update)&&p(t,i)}e(i.text)?n(y)&&n(g)?y!==g&&function(t,r,i,o,a){for(var s,u,h,f=0,p=0,d=r.length-1,y=r[0],m=r[d],g=i.length-1,v=i[0],_=i[g],E=!a;f<=d&&p<=g;)e(y)?y=r[++f]:e(m)?m=r[--d]:er(y,v)?(S(y,v,o,i,p),y=r[++f],v=i[++p]):er(m,_)?(S(m,_,o,i,g),m=r[--d],_=i[--g]):er(y,_)?(S(y,_,o,i,g),E&&c.insertBefore(t,y.elm,c.nextSibling(m.elm)),y=r[++f],_=i[--g]):er(m,v)?(S(m,v,o,i,p),E&&c.insertBefore(t,m.elm,y.elm),m=r[--d],v=i[++p]):(e(s)&&(s=nr(r,f,d)),e(u=n(v.key)?s[v.key]:T(v,r,f,d))?l(v,o,t,y.elm,!1,i,p):er(h=r[u],v)?(S(h,v,o,i,p),r[u]=void 0,E&&c.insertBefore(t,h.elm,y.elm)):l(v,o,t,y.elm,!1,i,p),v=i[++p]);f>d?b(t,e(i[g+1])?null:i[g+1].elm,i,p,g,o):p>g&&w(0,r,f,d)}(f,y,g,o,h):n(g)?(n(t.text)&&c.setTextContent(f,""),b(f,null,g,0,g.length-1,o)):n(y)?w(0,y,0,y.length-1):n(t.text)&&c.setTextContent(f,""):t.text!==i.text&&c.setTextContent(f,i.text),n(d)&&n(p=d.hook)&&n(p=p.postpatch)&&p(t,i)}}}function C(t,e,i){if(r(i)&&n(t.parent))t.parent.data.pendingInsert=e;else for(var o=0;o<e.length;++o)e[o].data.hook.insert(e[o])}var I=f("attrs,class,staticClass,staticStyle,key");function A(t,e,i,o){var a,s=e.tag,u=e.data,c=e.children;if(o=o||u&&u.pre,e.elm=t,r(e.isComment)&&n(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(n(u)&&(n(a=u.hook)&&n(a=a.init)&&a(e,!0),n(a=e.componentInstance)))return p(e,i),!0;if(n(s)){if(n(c))if(t.hasChildNodes())if(n(a=u)&&n(a=a.domProps)&&n(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var h=!0,l=t.firstChild,f=0;f<c.length;f++){if(!l||!A(l,c[f],i,o)){h=!1;break}l=l.nextSibling}if(!h||l)return!1}else y(e,c,i);if(n(u)){var d=!1;for(var m in u)if(!I(m)){d=!0,g(e,i);break}!d&&u.class&&te(u.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,i,o,a){if(!e(i)){var u,h=!1,f=[];if(e(t))h=!0,l(i,f);else{var p=n(t.nodeType);if(!p&&er(t,i))S(t,i,f,null,null,a);else{if(p){if(1===t.nodeType&&t.hasAttribute(L)&&(t.removeAttribute(L),o=!0),r(o)&&A(t,i,f))return C(i,f,!0),t;u=t,t=new ft(c.tagName(u).toLowerCase(),{},[],void 0,u)}var d=t.elm,y=c.parentNode(d);if(l(i,f,d._leaveCb?null:y,c.nextSibling(d)),n(i.parent))for(var g=i.parent,v=m(i);g;){for(var b=0;b<s.destroy.length;++b)s.destroy[b](g);if(g.elm=i.elm,v){for(var E=0;E<s.create.length;++E)s.create[E](Zn,g);var T=g.data.hook.insert;if(T.merged)for(var I=1;I<T.fns.length;I++)T.fns[I]()}else Jn(g);g=g.parent}n(y)?w(0,[t],0,0):n(t.tag)&&_(t)}}return C(i,f,h),i.elm}n(t)&&_(t)}}({nodeOps:Yn,modules:[pr,wr,Zr,ni,pi,W?{create:Vi,activate:Vi,remove:function(t,e){!0!==t.data.show?Mi(t,e):e()}}:{}].concat(cr)});Q&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&Qi(t,"input")});var qi={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?ie(n,"postpatch",function(){qi.componentUpdated(t,e,n)}):ji(t,e,n.context),t._vOptions=[].map.call(t.options,Hi)):("textarea"===n.tag||Qn(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Gi),t.addEventListener("compositionend",$i),t.addEventListener("change",$i),Q&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){ji(t,e,n.context);var r=t._vOptions,i=t._vOptions=[].map.call(t.options,Hi);i.some(function(t,e){return!P(t,r[e])})&&(t.multiple?e.value.some(function(t){return Ki(t,i)}):e.value!==e.oldValue&&Ki(e.value,i))&&Qi(t,"change")}}};function ji(t,e,n){Wi(t,e,n),($||z)&&setTimeout(function(){Wi(t,e,n)},0)}function Wi(t,e,n){var r=e.value,i=t.multiple;if(!i||Array.isArray(r)){for(var o,a,s=0,u=t.options.length;s<u;s++)if(a=t.options[s],i)o=k(r,Hi(a))>-1,a.selected!==o&&(a.selected=o);else if(P(Hi(a),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));i||(t.selectedIndex=-1)}}function Ki(t,e){return e.every(function(e){return!P(e,t)})}function Hi(t){return"_value"in t?t._value:t.value}function Gi(t){t.target.composing=!0}function $i(t){t.target.composing&&(t.target.composing=!1,Qi(t.target,"input"))}function Qi(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function zi(t){return!t.componentInstance||t.data&&t.data.transition?t:zi(t.componentInstance._vnode)}var Yi={model:qi,show:{bind:function(t,e,n){var r=e.value,i=(n=zi(n)).data&&n.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&i?(n.data.show=!0,xi(n,function(){t.style.display=o})):t.style.display=r?o:"none"},update:function(t,e,n){var r=e.value;!r!=!e.oldValue&&((n=zi(n)).data&&n.data.transition?(n.data.show=!0,r?xi(n,function(){t.style.display=t.__vOriginalDisplay}):Mi(n,function(){t.style.display="none"})):t.style.display=r?t.__vOriginalDisplay:"none")},unbind:function(t,e,n,r,i){i||(t.style.display=t.__vOriginalDisplay)}}},Xi={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Ji(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Ji(We(e.children)):t}function Zi(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var i=n._parentListeners;for(var o in i)e[_(o)]=i[o];return e}function to(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var eo=function(t){return t.tag||je(t)},no=function(t){return"show"===t.name},ro={name:"transition",props:Xi,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(eo)).length){var r=this.mode,o=n[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return o;var a=Ji(o);if(!a)return o;if(this._leaving)return to(t,o);var s="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?s+"comment":s+a.tag:i(a.key)?0===String(a.key).indexOf(s)?a.key:s+a.key:a.key;var u=(a.data||(a.data={})).transition=Zi(this),c=this._vnode,h=Ji(c);if(a.data.directives&&a.data.directives.some(no)&&(a.data.show=!0),h&&h.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(a,h)&&!je(h)&&(!h.componentInstance||!h.componentInstance._vnode.isComment)){var l=h.data.transition=I({},u);if("out-in"===r)return this._leaving=!0,ie(l,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()}),to(t,o);if("in-out"===r){if(je(a))return c;var f,p=function(){f()};ie(u,"afterEnter",p),ie(u,"enterCancelled",p),ie(l,"delayLeave",function(t){f=t})}}return o}}},io=I({tag:String,moveClass:String},Xi);function oo(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function ao(t){t.data.newPos=t.elm.getBoundingClientRect()}function so(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,i=e.top-n.top;if(r||i){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+r+"px,"+i+"px)",o.transitionDuration="0s"}}delete io.mode;var uo={Transition:ro,TransitionGroup:{props:io,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var i=ze(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,i(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],o=this.children=[],a=Zi(this),s=0;s<i.length;s++){var u=i[s];u.tag&&null!=u.key&&0!==String(u.key).indexOf("__vlist")&&(o.push(u),n[u.key]=u,(u.data||(u.data={})).transition=a)}if(r){for(var c=[],h=[],l=0;l<r.length;l++){var f=r[l];f.data.transition=a,f.data.pos=f.elm.getBoundingClientRect(),n[f.key]?c.push(f):h.push(f)}this.kept=t(e,null,c),this.removed=h}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(oo),t.forEach(ao),t.forEach(so),this._reflow=document.body.offsetHeight,t.forEach(function(t){if(t.data.moved){var n=t.elm,r=n.style;Ni(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(Ti,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(Ti,t),n._moveCb=null,Di(n,e))})}}))},methods:{hasMove:function(t,e){if(!bi)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach(function(t){mi(n,t)}),yi(n,e),n.style.display="none",this.$el.appendChild(n);var r=ki(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}}};wn.config.mustUseProp=Rn,wn.config.isReservedTag=Hn,wn.config.isReservedAttr=Nn,wn.config.getTagNamespace=Gn,wn.config.isUnknownElement=function(t){if(!W)return!0;if(Hn(t))return!1;if(t=t.toLowerCase(),null!=$n[t])return $n[t];var e=document.createElement(t);return t.indexOf("-")>-1?$n[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:$n[t]=/HTMLUnknownElement/.test(e.toString())},I(wn.options.directives,Yi),I(wn.options.components,uo),wn.prototype.__patch__=W?Bi:N,wn.prototype.$mount=function(t,e){return function(t,e,n){var r;return t.$el=e,t.$options.render||(t.$options.render=dt),Je(t,"beforeMount"),r=function(){t._update(t._render(),n)},new ln(t,r,N,{before:function(){t._isMounted&&!t._isDestroyed&&Je(t,"beforeUpdate")}},!0),n=!1,null==t.$vnode&&(t._isMounted=!0,Je(t,"mounted")),t}(this,t=t&&W?zn(t):void 0,e)},W&&setTimeout(function(){F.devtools&&nt&&nt.emit("init",wn)},0);var co,ho=/\{\{((?:.|\r?\n)+?)\}\}/g,lo=/[-.*+?^${}()|[\]\/\\]/g,fo=v(function(t){var e=t[0].replace(lo,"\\$&"),n=t[1].replace(lo,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+n,"g")}),po={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var n=Lr(t,"class");n&&(t.staticClass=JSON.stringify(n));var r=Or(t,"class",!1);r&&(t.classBinding=r)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}},yo={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var n=Lr(t,"style");n&&(t.staticStyle=JSON.stringify(ri(n)));var r=Or(t,"style",!1);r&&(t.styleBinding=r)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},mo=f("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),go=f("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),vo=f("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),bo=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,_o=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,wo="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+U.source+"]*",Eo="((?:"+wo+"\\:)?"+wo+")",To=new RegExp("^<"+Eo),So=/^\s*(\/?)>/,Co=new RegExp("^<\\/"+Eo+"[^>]*>"),Io=/^<!DOCTYPE [^>]+>/i,Ao=/^<!\--/,No=/^<!\[/,Do=f("script,style,textarea",!0),Ro={},Po={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},ko=/&(?:lt|gt|quot|amp|#39);/g,Oo=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,Lo=f("pre,textarea",!0),xo=function(t,e){return t&&Lo(t)&&"\n"===e[0]};function Mo(t,e){var n=e?Oo:ko;return t.replace(n,function(t){return Po[t]})}var Fo,Uo,Vo,Bo,qo,jo,Wo,Ko,Ho=/^@|^v-on:/,Go=/^v-|^@|^:/,$o=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Qo=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,zo=/^\(|\)$/g,Yo=/^\[.*\]$/,Xo=/:(.*)$/,Jo=/^:|^\.|^v-bind:/,Zo=/\.[^.\]]+(?=[^\]]*$)/g,ta=/^v-slot(:|$)|^#/,ea=/[\r\n]/,na=/\s+/g,ra=v(function(t){return(co=co||document.createElement("div")).innerHTML=t,co.textContent}),ia="_empty_";function oa(t,e,n){return{type:1,tag:t,attrsList:e,attrsMap:la(e),rawAttrsMap:{},parent:n,children:[]}}function aa(t,e){var n,r;(r=Or(n=t,"key"))&&(n.key=r),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=Or(t,"ref");e&&(t.ref=e,t.refInFor=function(t){for(var e=t;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=Lr(t,"scope"),t.slotScope=e||Lr(t,"slot-scope")):(e=Lr(t,"slot-scope"))&&(t.slotScope=e);var n=Or(t,"slot");if(n&&(t.slotTarget='""'===n?'"default"':n,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||Nr(t,"slot",n,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot"))),"template"===t.tag){var r=xr(t,ta);if(r){var i=ca(r),o=i.name,a=i.dynamic;t.slotTarget=o,t.slotTargetDynamic=a,t.slotScope=r.value||ia}}else{var s=xr(t,ta);if(s){var u=t.scopedSlots||(t.scopedSlots={}),c=ca(s),h=c.name,l=c.dynamic,f=u[h]=oa("template",[],t);f.slotTarget=h,f.slotTargetDynamic=l,f.children=t.children.filter(function(t){if(!t.slotScope)return t.parent=f,!0}),f.slotScope=s.value||ia,t.children=[],t.plain=!1}}}(t),function(t){"slot"===t.tag&&(t.slotName=Or(t,"name"))}(t),function(t){var e;(e=Or(t,"is"))&&(t.component=e),null!=Lr(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var i=0;i<Vo.length;i++)t=Vo[i](t,e)||t;return function(t){var e,n,r,i,o,a,s,u,c=t.attrsList;for(e=0,n=c.length;e<n;e++)if(r=i=c[e].name,o=c[e].value,Go.test(r))if(t.hasBindings=!0,(a=ha(r.replace(Go,"")))&&(r=r.replace(Zo,"")),Jo.test(r))r=r.replace(Jo,""),o=Tr(o),(u=Yo.test(r))&&(r=r.slice(1,-1)),a&&(a.prop&&!u&&"innerHtml"===(r=_(r))&&(r="innerHTML"),a.camel&&!u&&(r=_(r)),a.sync&&(s=Ur(o,"$event"),u?kr(t,'"update:"+('+r+")",s,null,!1,0,c[e],!0):(kr(t,"update:"+_(r),s,null,!1,0,c[e]),T(r)!==_(r)&&kr(t,"update:"+T(r),s,null,!1,0,c[e])))),a&&a.prop||!t.component&&Wo(t.tag,t.attrsMap.type,r)?Ar(t,r,o,c[e],u):Nr(t,r,o,c[e],u);else if(Ho.test(r))r=r.replace(Ho,""),(u=Yo.test(r))&&(r=r.slice(1,-1)),kr(t,r,o,a,!1,0,c[e],u);else{var h=(r=r.replace(Go,"")).match(Xo),l=h&&h[1];u=!1,l&&(r=r.slice(0,-(l.length+1)),Yo.test(l)&&(l=l.slice(1,-1),u=!0)),Rr(t,r,i,o,l,u,a,c[e])}else Nr(t,r,JSON.stringify(o),c[e]),!t.component&&"muted"===r&&Wo(t.tag,t.attrsMap.type,r)&&Ar(t,r,"true",c[e])}(t),t}function sa(t){var e;if(e=Lr(t,"v-for")){var n=function(t){var e=t.match($o);if(e){var n={};n.for=e[2].trim();var r=e[1].trim().replace(zo,""),i=r.match(Qo);return i?(n.alias=r.replace(Qo,"").trim(),n.iterator1=i[1].trim(),i[2]&&(n.iterator2=i[2].trim())):n.alias=r,n}}(e);n&&I(t,n)}}function ua(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function ca(t){var e=t.name.replace(ta,"");return e||"#"!==t.name[0]&&(e="default"),Yo.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function ha(t){var e=t.match(Zo);if(e){var n={};return e.forEach(function(t){n[t.slice(1)]=!0}),n}}function la(t){for(var e={},n=0,r=t.length;n<r;n++)e[t[n].name]=t[n].value;return e}var fa=/^xmlns:NS\d+/,pa=/^NS\d+:/;function da(t){return oa(t.tag,t.attrsList.slice(),t.parent)}var ya,ma,ga=[po,yo,{preTransformNode:function(t,e){if("input"===t.tag){var n,r=t.attrsMap;if(!r["v-model"])return;if((r[":type"]||r["v-bind:type"])&&(n=Or(t,"type")),r.type||n||!r["v-bind"]||(n="("+r["v-bind"]+").type"),n){var i=Lr(t,"v-if",!0),o=i?"&&("+i+")":"",a=null!=Lr(t,"v-else",!0),s=Lr(t,"v-else-if",!0),u=da(t);sa(u),Dr(u,"type","checkbox"),aa(u,e),u.processed=!0,u.if="("+n+")==='checkbox'"+o,ua(u,{exp:u.if,block:u});var c=da(t);Lr(c,"v-for",!0),Dr(c,"type","radio"),aa(c,e),ua(u,{exp:"("+n+")==='radio'"+o,block:c});var h=da(t);return Lr(h,"v-for",!0),Dr(h,":type",n),aa(h,e),ua(u,{exp:i,block:h}),a?u.else=!0:s&&(u.elseif=s),u}}}}],va={expectHTML:!0,modules:ga,directives:{model:function(t,e,n){var r=e.value,i=e.modifiers,o=t.tag,a=t.attrsMap.type;if(t.component)return Fr(t,r,i),!1;if("select"===o)!function(t,e,n){var r='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i&&i.number?"_n(val)":"val")+"});";kr(t,"change",r=r+" "+Ur(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),null,!0)}(t,r);else if("input"===o&&"checkbox"===a)!function(t,e,n){var r=n&&n.number,i=Or(t,"value")||"null",o=Or(t,"true-value")||"true",a=Or(t,"false-value")||"false";Ar(t,"checked","Array.isArray("+e+")?_i("+e+","+i+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),kr(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+a+");if(Array.isArray($$a)){var $$v="+(r?"_n("+i+")":i)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Ur(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Ur(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Ur(e,"$$c")+"}",null,!0)}(t,r,i);else if("input"===o&&"radio"===a)!function(t,e,n){var r=n&&n.number,i=Or(t,"value")||"null";Ar(t,"checked","_q("+e+","+(i=r?"_n("+i+")":i)+")"),kr(t,"change",Ur(e,i),null,!0)}(t,r,i);else if("input"===o||"textarea"===o)!function(t,e,n){var r=t.attrsMap.type,i=n||{},o=i.lazy,a=i.number,s=i.trim,u=!o&&"range"!==r,c=o?"change":"range"===r?Hr:"input",h="$event.target.value";s&&(h="$event.target.value.trim()"),a&&(h="_n("+h+")");var l=Ur(e,h);u&&(l="if($event.target.composing)return;"+l),Ar(t,"value","("+e+")"),kr(t,c,l,null,!0),(s||a)&&kr(t,"blur","$forceUpdate()")}(t,r,i);else if(!F.isReservedTag(o))return Fr(t,r,i),!1;return!0},text:function(t,e){e.value&&Ar(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&Ar(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:mo,mustUseProp:Rn,canBeLeftOpenTag:go,isReservedTag:Hn,getTagNamespace:Gn,staticKeys:ga.reduce(function(t,e){return t.concat(e.staticKeys||[])},[]).join(",")},ba=v(function(t){return f("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))});var _a=/^([\w$_]+|\([^)]*?\))\s*=>|^function\s*(?:[\w$]+)?\s*\(/,wa=/\([^)]*?\);*$/,Ea=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Ta={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Sa={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Ca=function(t){return"if("+t+")return null;"},Ia={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Ca("$event.target !== $event.currentTarget"),ctrl:Ca("!$event.ctrlKey"),shift:Ca("!$event.shiftKey"),alt:Ca("!$event.altKey"),meta:Ca("!$event.metaKey"),left:Ca("'button' in $event && $event.button !== 0"),middle:Ca("'button' in $event && $event.button !== 1"),right:Ca("'button' in $event && $event.button !== 2")};function Aa(t,e){var n=e?"nativeOn:":"on:",r="",i="";for(var o in t){var a=Na(t[o]);t[o]&&t[o].dynamic?i+=o+","+a+",":r+='"'+o+'":'+a+","}return r="{"+r.slice(0,-1)+"}",i?n+"_d("+r+",["+i.slice(0,-1)+"])":n+r}function Na(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map(function(t){return Na(t)}).join(",")+"]";var e=Ea.test(t.value),n=_a.test(t.value),r=Ea.test(t.value.replace(wa,""));if(t.modifiers){var i="",o="",a=[];for(var s in t.modifiers)if(Ia[s])o+=Ia[s],Ta[s]&&a.push(s);else if("exact"===s){var u=t.modifiers;o+=Ca(["ctrl","shift","alt","meta"].filter(function(t){return!u[t]}).map(function(t){return"$event."+t+"Key"}).join("||"))}else a.push(s);return a.length&&(i+="if(!$event.type.indexOf('key')&&"+a.map(Da).join("&&")+")return null;"),o&&(i+=o),"function($event){"+i+(e?"return "+t.value+"($event)":n?"return ("+t.value+")($event)":r?"return "+t.value:t.value)+"}"}return e||n?t.value:"function($event){"+(r?"return "+t.value:t.value)+"}"}function Da(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var n=Ta[t],r=Sa[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(n)+",$event.key,"+JSON.stringify(r)+")"}var Ra={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(n){return"_b("+n+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:N},Pa=function(t){this.options=t,this.warn=t.warn||Cr,this.transforms=Ir(t.modules,"transformCode"),this.dataGenFns=Ir(t.modules,"genData"),this.directives=I(I({},Ra),t.directives);var e=t.isReservedTag||D;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function ka(t,e){var n=new Pa(e);return{render:"with(this){return "+(t?Oa(t,n):'_c("div")')+"}",staticRenderFns:n.staticRenderFns}}function Oa(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return La(t,e);if(t.once&&!t.onceProcessed)return xa(t,e);if(t.for&&!t.forProcessed)return Fa(t,e);if(t.if&&!t.ifProcessed)return Ma(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var n=t.slotName||'"default"',r=qa(t,e),i="_t("+n+(r?","+r:""),o=t.attrs||t.dynamicAttrs?Ka((t.attrs||[]).concat(t.dynamicAttrs||[]).map(function(t){return{name:_(t.name),value:t.value,dynamic:t.dynamic}})):null,a=t.attrsMap["v-bind"];return!o&&!a||r||(i+=",null"),o&&(i+=","+o),a&&(i+=(o?"":",null")+","+a),i+")"}(t,e);var n;if(t.component)n=function(t,e,n){var r=e.inlineTemplate?null:qa(e,n,!0);return"_c("+t+","+Ua(e,n)+(r?","+r:"")+")"}(t.component,t,e);else{var r;(!t.plain||t.pre&&e.maybeComponent(t))&&(r=Ua(t,e));var i=t.inlineTemplate?null:qa(t,e,!0);n="_c('"+t.tag+"'"+(r?","+r:"")+(i?","+i:"")+")"}for(var o=0;o<e.transforms.length;o++)n=e.transforms[o](t,n);return n}return qa(t,e)||"void 0"}function La(t,e){t.staticProcessed=!0;var n=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Oa(t,e)+"}"),e.pre=n,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function xa(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return Ma(t,e);if(t.staticInFor){for(var n="",r=t.parent;r;){if(r.for){n=r.key;break}r=r.parent}return n?"_o("+Oa(t,e)+","+e.onceId+++","+n+")":Oa(t,e)}return La(t,e)}function Ma(t,e,n,r){return t.ifProcessed=!0,function t(e,n,r,i){if(!e.length)return i||"_e()";var o=e.shift();return o.exp?"("+o.exp+")?"+a(o.block)+":"+t(e,n,r,i):""+a(o.block);function a(t){return r?r(t,n):t.once?xa(t,n):Oa(t,n)}}(t.ifConditions.slice(),e,n,r)}function Fa(t,e,n,r){var i=t.for,o=t.alias,a=t.iterator1?","+t.iterator1:"",s=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(r||"_l")+"(("+i+"),function("+o+a+s+"){return "+(n||Oa)(t,e)+"})"}function Ua(t,e){var n="{",r=function(t,e){var n=t.directives;if(n){var r,i,o,a,s="directives:[",u=!1;for(r=0,i=n.length;r<i;r++){o=n[r],a=!0;var c=e.directives[o.name];c&&(a=!!c(t,o,e.warn)),a&&(u=!0,s+='{name:"'+o.name+'",rawName:"'+o.rawName+'"'+(o.value?",value:("+o.value+"),expression:"+JSON.stringify(o.value):"")+(o.arg?",arg:"+(o.isDynamicArg?o.arg:'"'+o.arg+'"'):"")+(o.modifiers?",modifiers:"+JSON.stringify(o.modifiers):"")+"},")}return u?s.slice(0,-1)+"]":void 0}}(t,e);r&&(n+=r+","),t.key&&(n+="key:"+t.key+","),t.ref&&(n+="ref:"+t.ref+","),t.refInFor&&(n+="refInFor:true,"),t.pre&&(n+="pre:true,"),t.component&&(n+='tag:"'+t.tag+'",');for(var i=0;i<e.dataGenFns.length;i++)n+=e.dataGenFns[i](t);if(t.attrs&&(n+="attrs:"+Ka(t.attrs)+","),t.props&&(n+="domProps:"+Ka(t.props)+","),t.events&&(n+=Aa(t.events,!1)+","),t.nativeEvents&&(n+=Aa(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(n+="slot:"+t.slotTarget+","),t.scopedSlots&&(n+=function(t,e,n){var r=t.for||Object.keys(e).some(function(t){var n=e[t];return n.slotTargetDynamic||n.if||n.for||Va(n)}),i=!!t.if;if(!r)for(var o=t.parent;o;){if(o.slotScope&&o.slotScope!==ia||o.for){r=!0;break}o.if&&(i=!0),o=o.parent}var a=Object.keys(e).map(function(t){return Ba(e[t],n)}).join(",");return"scopedSlots:_u(["+a+"]"+(r?",null,true":"")+(!r&&i?",null,false,"+function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0}(a):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(n+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var o=function(t,e){var n=t.children[0];if(n&&1===n.type){var r=ka(n,e.options);return"inlineTemplate:{render:function(){"+r.render+"},staticRenderFns:["+r.staticRenderFns.map(function(t){return"function(){"+t+"}"}).join(",")+"]}"}}(t,e);o&&(n+=o+",")}return n=n.replace(/,$/,"")+"}",t.dynamicAttrs&&(n="_b("+n+',"'+t.tag+'",'+Ka(t.dynamicAttrs)+")"),t.wrapData&&(n=t.wrapData(n)),t.wrapListeners&&(n=t.wrapListeners(n)),n}function Va(t){return 1===t.type&&("slot"===t.tag||t.children.some(Va))}function Ba(t,e){var n=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!n)return Ma(t,e,Ba,"null");if(t.for&&!t.forProcessed)return Fa(t,e,Ba);var r=t.slotScope===ia?"":String(t.slotScope),i="function("+r+"){return "+("template"===t.tag?t.if&&n?"("+t.if+")?"+(qa(t,e)||"undefined")+":undefined":qa(t,e)||"undefined":Oa(t,e))+"}",o=r?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+i+o+"}"}function qa(t,e,n,r,i){var o=t.children;if(o.length){var a=o[0];if(1===o.length&&a.for&&"template"!==a.tag&&"slot"!==a.tag){var s=n?e.maybeComponent(a)?",1":",0":"";return""+(r||Oa)(a,e)+s}var u=n?function(t,e){for(var n=0,r=0;r<t.length;r++){var i=t[r];if(1===i.type){if(ja(i)||i.ifConditions&&i.ifConditions.some(function(t){return ja(t.block)})){n=2;break}(e(i)||i.ifConditions&&i.ifConditions.some(function(t){return e(t.block)}))&&(n=1)}}return n}(o,e.maybeComponent):0,c=i||Wa;return"["+o.map(function(t){return c(t,e)}).join(",")+"]"+(u?","+u:"")}}function ja(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function Wa(t,e){return 1===t.type?Oa(t,e):3===t.type&&t.isComment?(r=t,"_e("+JSON.stringify(r.text)+")"):"_v("+(2===(n=t).type?n.expression:Ha(JSON.stringify(n.text)))+")";var n,r}function Ka(t){for(var e="",n="",r=0;r<t.length;r++){var i=t[r],o=Ha(i.value);i.dynamic?n+=i.name+","+o+",":e+='"'+i.name+'":'+o+","}return e="{"+e.slice(0,-1)+"}",n?"_d("+e+",["+n.slice(0,-1)+"])":e}function Ha(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function Ga(t,e){try{return new Function(t)}catch(n){return e.push({err:n,code:t}),N}}function $a(t){var e=Object.create(null);return function(n,r,i){(r=I({},r)).warn,delete r.warn;var o=r.delimiters?String(r.delimiters)+n:n;if(e[o])return e[o];var a=t(n,r),s={},u=[];return s.render=Ga(a.render,u),s.staticRenderFns=a.staticRenderFns.map(function(t){return Ga(t,u)}),e[o]=s}}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b");var Qa,za,Ya=(Qa=function(t,e){var n=function(t,e){Fo=e.warn||Cr,jo=e.isPreTag||D,Wo=e.mustUseProp||D,Ko=e.getTagNamespace||D,e.isReservedTag,Vo=Ir(e.modules,"transformNode"),Bo=Ir(e.modules,"preTransformNode"),qo=Ir(e.modules,"postTransformNode"),Uo=e.delimiters;var n,r,i=[],o=!1!==e.preserveWhitespace,a=e.whitespace,s=!1,u=!1;function c(t){if(h(t),s||t.processed||(t=aa(t,e)),i.length||t===n||n.if&&(t.elseif||t.else)&&ua(n,{exp:t.elseif,block:t}),r&&!t.forbidden)if(t.elseif||t.else)a=t,(c=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(r.children))&&c.if&&ua(c,{exp:a.elseif,block:a});else{if(t.slotScope){var o=t.slotTarget||'"default"';(r.scopedSlots||(r.scopedSlots={}))[o]=t}r.children.push(t),t.parent=r}var a,c;t.children=t.children.filter(function(t){return!t.slotScope}),h(t),t.pre&&(s=!1),jo(t.tag)&&(u=!1);for(var l=0;l<qo.length;l++)qo[l](t,e)}function h(t){if(!u)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var n,r,i=[],o=e.expectHTML,a=e.isUnaryTag||D,s=e.canBeLeftOpenTag||D,u=0;t;){if(n=t,r&&Do(r)){var c=0,h=r.toLowerCase(),l=Ro[h]||(Ro[h]=new RegExp("([\\s\\S]*?)(</"+h+"[^>]*>)","i")),f=t.replace(l,function(t,n,r){return c=r.length,Do(h)||"noscript"===h||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),xo(h,n)&&(n=n.slice(1)),e.chars&&e.chars(n),""});u+=t.length-f.length,t=f,I(h,u-c,u)}else{var p=t.indexOf("<");if(0===p){if(Ao.test(t)){var d=t.indexOf("--\x3e");if(d>=0){e.shouldKeepComment&&e.comment(t.substring(4,d),u,u+d+3),T(d+3);continue}}if(No.test(t)){var y=t.indexOf("]>");if(y>=0){T(y+2);continue}}var m=t.match(Io);if(m){T(m[0].length);continue}var g=t.match(Co);if(g){var v=u;T(g[0].length),I(g[1],v,u);continue}var b=S();if(b){C(b),xo(b.tagName,t)&&T(1);continue}}var _=void 0,w=void 0,E=void 0;if(p>=0){for(w=t.slice(p);!(Co.test(w)||To.test(w)||Ao.test(w)||No.test(w)||(E=w.indexOf("<",1))<0);)p+=E,w=t.slice(p);_=t.substring(0,p)}p<0&&(_=t),_&&T(_.length),e.chars&&_&&e.chars(_,u-_.length,u)}if(t===n){e.chars&&e.chars(t);break}}function T(e){u+=e,t=t.substring(e)}function S(){var e=t.match(To);if(e){var n,r,i={tagName:e[1],attrs:[],start:u};for(T(e[0].length);!(n=t.match(So))&&(r=t.match(_o)||t.match(bo));)r.start=u,T(r[0].length),r.end=u,i.attrs.push(r);if(n)return i.unarySlash=n[1],T(n[0].length),i.end=u,i}}function C(t){var n=t.tagName,u=t.unarySlash;o&&("p"===r&&vo(n)&&I(r),s(n)&&r===n&&I(n));for(var c=a(n)||!!u,h=t.attrs.length,l=new Array(h),f=0;f<h;f++){var p=t.attrs[f],d=p[3]||p[4]||p[5]||"",y="a"===n&&"href"===p[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;l[f]={name:p[1],value:Mo(d,y)}}c||(i.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:l,start:t.start,end:t.end}),r=n),e.start&&e.start(n,l,c,t.start,t.end)}function I(t,n,o){var a,s;if(null==n&&(n=u),null==o&&(o=u),t)for(s=t.toLowerCase(),a=i.length-1;a>=0&&i[a].lowerCasedTag!==s;a--);else a=0;if(a>=0){for(var c=i.length-1;c>=a;c--)e.end&&e.end(i[c].tag,n,o);i.length=a,r=a&&i[a-1].tag}else"br"===s?e.start&&e.start(t,[],!0,n,o):"p"===s&&(e.start&&e.start(t,[],!1,n,o),e.end&&e.end(t,n,o))}I()}(t,{warn:Fo,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,o,a,h,l){var f=r&&r.ns||Ko(t);$&&"svg"===f&&(o=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];fa.test(r.name)||(r.name=r.name.replace(pa,""),e.push(r))}return e}(o));var p,d=oa(t,o,r);f&&(d.ns=f),"style"!==(p=d).tag&&("script"!==p.tag||p.attrsMap.type&&"text/javascript"!==p.attrsMap.type)||et()||(d.forbidden=!0);for(var y=0;y<Bo.length;y++)d=Bo[y](d,e)||d;s||(function(t){null!=Lr(t,"v-pre")&&(t.pre=!0)}(d),d.pre&&(s=!0)),jo(d.tag)&&(u=!0),s?function(t){var e=t.attrsList,n=e.length;if(n)for(var r=t.attrs=new Array(n),i=0;i<n;i++)r[i]={name:e[i].name,value:JSON.stringify(e[i].value)},null!=e[i].start&&(r[i].start=e[i].start,r[i].end=e[i].end);else t.pre||(t.plain=!0)}(d):d.processed||(sa(d),function(t){var e=Lr(t,"v-if");if(e)t.if=e,ua(t,{exp:e,block:t});else{null!=Lr(t,"v-else")&&(t.else=!0);var n=Lr(t,"v-else-if");n&&(t.elseif=n)}}(d),function(t){null!=Lr(t,"v-once")&&(t.once=!0)}(d)),n||(n=d),a?c(d):(r=d,i.push(d))},end:function(t,e,n){var o=i[i.length-1];i.length-=1,r=i[i.length-1],c(o)},chars:function(t,e,n){if(r&&(!$||"textarea"!==r.tag||r.attrsMap.placeholder!==t)){var i,c,h,l=r.children;(t=u||t.trim()?"script"===(i=r).tag||"style"===i.tag?t:ra(t):l.length?a?"condense"===a&&ea.test(t)?"":" ":o?" ":"":"")&&(u||"condense"!==a||(t=t.replace(na," ")),!s&&" "!==t&&(c=function(t,e){var n=Uo?fo(Uo):ho;if(n.test(t)){for(var r,i,o,a=[],s=[],u=n.lastIndex=0;r=n.exec(t);){(i=r.index)>u&&(s.push(o=t.slice(u,i)),a.push(JSON.stringify(o)));var c=Tr(r[1].trim());a.push("_s("+c+")"),s.push({"@binding":c}),u=i+r[0].length}return u<t.length&&(s.push(o=t.slice(u)),a.push(JSON.stringify(o))),{expression:a.join("+"),tokens:s}}}(t))?h={type:2,expression:c.expression,tokens:c.tokens,text:t}:" "===t&&l.length&&" "===l[l.length-1].text||(h={type:3,text:t}),h&&l.push(h))}},comment:function(t,e,n){if(r){var i={type:3,text:t,isComment:!0};r.children.push(i)}}}),n}(t.trim(),e);!1!==e.optimize&&function(t,e){t&&(ya=ba(e.staticKeys||""),ma=e.isReservedTag||D,function t(e){if(e.static=function(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||p(t.tag)||!ma(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(ya))))}(e),1===e.type){if(!ma(e.tag)&&"slot"!==e.tag&&null==e.attrsMap["inline-template"])return;for(var n=0,r=e.children.length;n<r;n++){var i=e.children[n];t(i),i.static||(e.static=!1)}if(e.ifConditions)for(var o=1,a=e.ifConditions.length;o<a;o++){var s=e.ifConditions[o].block;t(s),s.static||(e.static=!1)}}}(t),function t(e,n){if(1===e.type){if((e.static||e.once)&&(e.staticInFor=n),e.static&&e.children.length&&(1!==e.children.length||3!==e.children[0].type))return void(e.staticRoot=!0);if(e.staticRoot=!1,e.children)for(var r=0,i=e.children.length;r<i;r++)t(e.children[r],n||!!e.for);if(e.ifConditions)for(var o=1,a=e.ifConditions.length;o<a;o++)t(e.ifConditions[o].block,n)}}(t,!1))}(n,e);var r=ka(n,e);return{ast:n,render:r.render,staticRenderFns:r.staticRenderFns}},function(t){function e(e,n){var r=Object.create(t),i=[],o=[];if(n)for(var a in n.modules&&(r.modules=(t.modules||[]).concat(n.modules)),n.directives&&(r.directives=I(Object.create(t.directives||null),n.directives)),n)"modules"!==a&&"directives"!==a&&(r[a]=n[a]);r.warn=function(t,e,n){(n?o:i).push(t)};var s=Qa(e.trim(),r);return s.errors=i,s.tips=o,s}return{compile:e,compileToFunctions:$a(e)}})(va),Xa=(Ya.compile,Ya.compileToFunctions);function Ja(t){return(za=za||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',za.innerHTML.indexOf("&#10;")>0}var Za=!!W&&Ja(!1),ts=!!W&&Ja(!0),es=v(function(t){var e=zn(t);return e&&e.innerHTML}),ns=wn.prototype.$mount;return wn.prototype.$mount=function(t,e){if((t=t&&zn(t))===document.body||t===document.documentElement)return this;var n=this.$options;if(!n.render){var r=n.template;if(r)if("string"==typeof r)"#"===r.charAt(0)&&(r=es(r));else{if(!r.nodeType)return this;r=r.innerHTML}else t&&(r=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(r){var i=Xa(r,{outputSourceRange:!1,shouldDecodeNewlines:Za,shouldDecodeNewlinesForHref:ts,delimiters:n.delimiters,comments:n.comments},this),o=i.render,a=i.staticRenderFns;n.render=o,n.staticRenderFns=a}}return ns.call(this,t,e)},wn.compile=Xa,wn}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Vuex=e()}(this,function(){"use strict";var t="undefined"!=typeof window&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function e(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}var n=function(t,e){this.runtime=e,this._children=Object.create(null);var n=(this._rawModule=t).state;this.state=("function"==typeof n?n():n)||{}},r={namespaced:{configurable:!0}};r.namespaced.get=function(){return!!this._rawModule.namespaced},n.prototype.addChild=function(t,e){this._children[t]=e},n.prototype.removeChild=function(t){delete this._children[t]},n.prototype.getChild=function(t){return this._children[t]},n.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},n.prototype.forEachChild=function(t){e(this._children,t)},n.prototype.forEachGetter=function(t){this._rawModule.getters&&e(this._rawModule.getters,t)},n.prototype.forEachAction=function(t){this._rawModule.actions&&e(this._rawModule.actions,t)},n.prototype.forEachMutation=function(t){this._rawModule.mutations&&e(this._rawModule.mutations,t)},Object.defineProperties(n.prototype,r);var i,o=function(t){this.register([],t,!1)};o.prototype.get=function(t){return t.reduce(function(t,e){return t.getChild(e)},this.root)},o.prototype.getNamespace=function(t){var e=this.root;return t.reduce(function(t,n){return t+((e=e.getChild(n)).namespaced?n+"/":"")},"")},o.prototype.update=function(t){!function t(e,n,r){if(n.update(r),r.modules)for(var i in r.modules){if(!n.getChild(i))return;t(e.concat(i),n.getChild(i),r.modules[i])}}([],this.root,t)},o.prototype.register=function(t,r,i){var o=this;void 0===i&&(i=!0);var a=new n(r,i);0===t.length?this.root=a:this.get(t.slice(0,-1)).addChild(t[t.length-1],a),r.modules&&e(r.modules,function(e,n){o.register(t.concat(n),e,i)})},o.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),n=t[t.length-1];e.getChild(n).runtime&&e.removeChild(n)};var a=function(e){var n=this;void 0===e&&(e={}),!i&&"undefined"!=typeof window&&window.Vue&&d(window.Vue);var r=e.plugins;void 0===r&&(r=[]);var a=e.strict;void 0===a&&(a=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new o(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new i;var s=this,u=this.dispatch,c=this.commit;this.dispatch=function(t,e){return u.call(s,t,e)},this.commit=function(t,e,n){return c.call(s,t,e,n)},this.strict=a;var f,p=this._modules.root.state;l(this,p,[],this._modules.root),h(this,p),r.forEach(function(t){return t(n)}),(void 0!==e.devtools?e.devtools:i.config.devtools)&&(f=this,t&&((f._devtoolHook=t).emit("vuex:init",f),t.on("vuex:travel-to-state",function(t){f.replaceState(t)}),f.subscribe(function(e,n){t.emit("vuex:mutation",e,n)})))},s={state:{configurable:!0}};function u(t,e){return e.indexOf(t)<0&&e.push(t),function(){var n=e.indexOf(t);-1<n&&e.splice(n,1)}}function c(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;l(t,n,[],t._modules.root,!0),h(t,n,e)}function h(t,n,r){var o=t._vm;t.getters={};var a=t._wrappedGetters,s={};e(a,function(e,n){s[n]=function(){return e(t)},Object.defineProperty(t.getters,n,{get:function(){return t._vm[n]},enumerable:!0})});var u=i.config.silent;i.config.silent=!0,t._vm=new i({data:{$$state:n},computed:s}),i.config.silent=u,t.strict&&t._vm.$watch(function(){return this._data.$$state},function(){},{deep:!0,sync:!0}),o&&(r&&t._withCommit(function(){o._data.$$state=null}),i.nextTick(function(){return o.$destroy()}))}function l(t,e,n,r,o){var a=!n.length,s=t._modules.getNamespace(n);if(r.namespaced&&(t._modulesNamespaceMap[s]=r),!a&&!o){var u=f(e,n.slice(0,-1)),c=n[n.length-1];t._withCommit(function(){i.set(u,c,r.state)})}var h,d,y,m,g,v=r.context=(h=t,y=n,g={dispatch:(m=""===(d=s))?h.dispatch:function(t,e,n){var r=p(t,e,n),i=r.payload,o=r.options,a=r.type;return o&&o.root||(a=d+a),h.dispatch(a,i)},commit:m?h.commit:function(t,e,n){var r=p(t,e,n),i=r.payload,o=r.options,a=r.type;o&&o.root||(a=d+a),h.commit(a,i,o)}},Object.defineProperties(g,{getters:{get:m?function(){return h.getters}:function(){return t=h,n={},r=(e=d).length,Object.keys(t.getters).forEach(function(i){if(i.slice(0,r)===e){var o=i.slice(r);Object.defineProperty(n,o,{get:function(){return t.getters[i]},enumerable:!0})}}),n;var t,e,n,r}},state:{get:function(){return f(h.state,y)}}}),g);r.forEachMutation(function(e,n){var r,i,o,a;i=s+n,o=e,a=v,((r=t)._mutations[i]||(r._mutations[i]=[])).push(function(t){o.call(r,a.state,t)})}),r.forEachAction(function(e,n){var r,i,o,a,u=e.root?n:s+n,c=e.handler||e;i=u,o=c,a=v,((r=t)._actions[i]||(r._actions[i]=[])).push(function(t,e){var n,i=o.call(r,{dispatch:a.dispatch,commit:a.commit,getters:a.getters,state:a.state,rootGetters:r.getters,rootState:r.state},t,e);return(n=i)&&"function"==typeof n.then||(i=Promise.resolve(i)),r._devtoolHook?i.catch(function(t){throw r._devtoolHook.emit("vuex:error",t),t}):i})}),r.forEachGetter(function(e,n){!function(t,e,n,r){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(t){return n(r.state,r.getters,t.state,t.getters)})}(t,s+n,e,v)}),r.forEachChild(function(r,i){l(t,e,n.concat(i),r,o)})}function f(t,e){return e.length?e.reduce(function(t,e){return t[e]},t):t}function p(t,e,n){var r;return null!==(r=t)&&"object"==typeof r&&t.type&&(n=e,t=(e=t).type),{type:t,payload:e,options:n}}function d(t){i&&t===i||function(t){if(2<=Number(t.version.split(".")[0]))t.mixin({beforeCreate:n});else{var e=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[n].concat(t.init):n,e.call(this,t)}}function n(){var t=this.$options;t.store?this.$store="function"==typeof t.store?t.store():t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}}(i=t)}s.state.get=function(){return this._vm._data.$$state},s.state.set=function(t){},a.prototype.commit=function(t,e,n){var r=this,i=p(t,e,n),o=i.type,a=i.payload,s={type:o,payload:a},u=this._mutations[o];u&&(this._withCommit(function(){u.forEach(function(t){t(a)})}),this._subscribers.forEach(function(t){return t(s,r.state)}))},a.prototype.dispatch=function(t,e){var n=this,r=p(t,e),i=r.type,o=r.payload,a={type:i,payload:o},s=this._actions[i];if(s){try{this._actionSubscribers.filter(function(t){return t.before}).forEach(function(t){return t.before(a,n.state)})}catch(t){}return(1<s.length?Promise.all(s.map(function(t){return t(o)})):s[0](o)).then(function(t){try{n._actionSubscribers.filter(function(t){return t.after}).forEach(function(t){return t.after(a,n.state)})}catch(t){}return t})}},a.prototype.subscribe=function(t){return u(t,this._subscribers)},a.prototype.subscribeAction=function(t){return u("function"==typeof t?{before:t}:t,this._actionSubscribers)},a.prototype.watch=function(t,e,n){var r=this;return this._watcherVM.$watch(function(){return t(r.state,r.getters)},e,n)},a.prototype.replaceState=function(t){var e=this;this._withCommit(function(){e._vm._data.$$state=t})},a.prototype.registerModule=function(t,e,n){void 0===n&&(n={}),"string"==typeof t&&(t=[t]),this._modules.register(t,e),l(this,this.state,t,this._modules.get(t),n.preserveState),h(this,this.state)},a.prototype.unregisterModule=function(t){var e=this;"string"==typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit(function(){var n=f(e.state,t.slice(0,-1));i.delete(n,t[t.length-1])}),c(this)},a.prototype.hotUpdate=function(t){this._modules.update(t),c(this,!0)},a.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(a.prototype,s);var y=_(function(t,e){var n={};return b(e).forEach(function(e){var r=e.key,i=e.val;n[r]=function(){var e=this.$store.state,n=this.$store.getters;if(t){var r=w(this.$store,"mapState",t);if(!r)return;e=r.context.state,n=r.context.getters}return"function"==typeof i?i.call(this,e,n):e[i]},n[r].vuex=!0}),n}),m=_(function(t,e){var n={};return b(e).forEach(function(e){var r=e.key,i=e.val;n[r]=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=this.$store.commit;if(t){var o=w(this.$store,"mapMutations",t);if(!o)return;r=o.context.commit}return"function"==typeof i?i.apply(this,[r].concat(e)):r.apply(this.$store,[i].concat(e))}}),n}),g=_(function(t,e){var n={};return b(e).forEach(function(e){var r=e.key,i=e.val;i=t+i,n[r]=function(){if(!t||w(this.$store,"mapGetters",t))return this.$store.getters[i]},n[r].vuex=!0}),n}),v=_(function(t,e){var n={};return b(e).forEach(function(e){var r=e.key,i=e.val;n[r]=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var r=this.$store.dispatch;if(t){var o=w(this.$store,"mapActions",t);if(!o)return;r=o.context.dispatch}return"function"==typeof i?i.apply(this,[r].concat(e)):r.apply(this.$store,[i].concat(e))}}),n});function b(t){return Array.isArray(t)?t.map(function(t){return{key:t,val:t}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}})}function _(t){return function(e,n){return"string"!=typeof e?(n=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,n)}}function w(t,e,n){return t._modulesNamespaceMap[n]}return{Store:a,install:d,version:"3.1.0",mapState:y,mapMutations:m,mapGetters:g,mapActions:v,createNamespacedHelpers:function(t){return{mapState:y.bind(null,t),mapGetters:g.bind(null,t),mapMutations:m.bind(null,t),mapActions:v.bind(null,t)}}}});var glider=function(exports){"use strict";function getGliderOptions(){let t,e,n=window.location.hash,[r,i,o]=n.slice(2).split("/");return"main"===o?(t=!0,e=null):(t=!1,e=o),{flightInstanceId:r||"0000",herePlace:i,nowPhase:e,initialize:t}}let PARSING_CONSTANTS={FLIGHT_PLAN_SELECTOR:".glider-root",PART:{ID_ATT_NAME:"id",PART_ID_ATT_NAME:"part-id",PART_REF_ATT_NAME:"part-ref",PART_ATT_NAME:"part",TYPE_ATT_NAME:"part-type",VIEW_ATT_NAME:"part-view",OPTIONS_ATT_NAME:"part-options",SELECTOR_PREFIX:"part-",CLASSNAME_PREFIX:"part-",TYPE_VIEW_DELIMITER:"-",TYPE_CSS_CLASS_PATTERN:/^part-([^\-\s]+)$/,VIEW_CSS_CLASS_PATTERN:/^part-[^\-\s]+-([^\-\s]+)$/,DEFAULT_PART_NAME:"identity",DEFAULT_VIEW_NAME:"defaultView",VIEW_UNDEF:"no-view-defined"},PHASE:{ID_ATT_NAME:"id",TYPE_ATT_NAME:"phase-type",TYPES:{PAR:"par",SEQ:"seq",LEAF:"leaf"},DELAY_ATT_NAME:"phase-begin",DURATION_ATT_NAME:"phase-duration",PHASE_DESCENDANT_SELECTOR:"*[phase-type],*[phase-duration],*[phase-begin]"},PLACE:{ID_ATT_NAME:"place",PLACE_ATT_NAME:"place",ROLE_ATT_NAME:"place-role",REGION_ATT_NAME:"place-region",SELECTOR_PREFIX:"place-",CLASSNAME_PREFIX:"place-",ROLE_REGION_DELIMITER:"-",DEFAULT_REGION_NAME:"defaultRegion"}};function getHash(t){let e=0;return t.split("").forEach(t=>{e=(e<<5)-e+t.charCodeAt(),e&=e}),Math.abs(e)}function getIdFromDomPosition(t){return getHash(function t(e){if(e===document.body)return"";let n=0,r=e;for(;r=r.previousSibling;)n++;return n+"."+t(e.parentNode)}(t))}function getPlaceDefinitions(){let t=[];return document.querySelectorAll("glider-defs > place").forEach(e=>{let n={};Array.from(e.attributes).forEach(function(t){var r;n[(r=t.name,r.replace(/-(\w)/gi,(t,e)=>e.toUpperCase()))]=e.getAttribute(t.name)}),t.push(n)}),t}PARSING_CONSTANTS.PART.GET_CSS_CLASS=((t,e)=>`${PARSING_CONSTANTS.PART.CLASSNAME_PREFIX}${t}`+(e?`${PARSING_CONSTANTS.PART.TYPE_VIEW_DELIMITER}${e}`:"")),PARSING_CONSTANTS.PART.GET_VUE_COMPONENT_NAME=((t,e)=>`${t}-${e}`);class P4V_Data{constructor(){this.parts={},this.partViews={},this.places={},this.placeDefs=[],this.phases={},this.rootPhaseId=null,this.phasesParts={},this.partsPartViews={},this.placesPartviews={},this.phaseChildren={}}addPhase(t){let e={};e.delay=t.phase.delay,e.id=t.phase.id,t.phase.hasDuration?e.duration=t.phase.duration:e.duration=Number.POSITIVE_INFINITY;let n,r=t.domNode.children.length>0,i=!t.part.type;n=t.phase.hasType?t.phase.type:i&&r?"par":t.phase.hasNoPhaseDescendents?"leaf":"par";let o=Object.assign({},e,{type:n});return void 0===this.phases[e.id]&&(this.phases[e.id]=o),e}setRootPhase(t){this.rootPhaseId=t.id}createParentChildPhaseRelationship(t,e){void 0===this.phaseChildren[t.id]&&(this.phaseChildren[t.id]=[]),this.phaseChildren[t.id].push(e.id)}addPart(t){console.log("ADDING PART"),console.log(t);let e={id:t.part.id,type:void 0===t.part.type?PARSING_CONSTANTS.PART.DEFAULT_PART_NAME:t.part.type,options:t.part.options,container:t.part.container};return(t.place.hasRole||t.place.hasRegion)&&(e.place=this.makePlaceId(t.place.role,t.place.region),console.log("Identity Part parsed: need to add Place info"),console.log(e)),void 0===this.parts[e.id]&&(this.parts[e.id]=e),e}addPartView(t){console.log("ADDING PART VIEW"),console.log(t);let e=void 0===t.partView.name?PARSING_CONSTANTS.PART.DEFAULT_PARTVIEW_NAME:t.partView.name,n={partId:t.part.id,id:`pv-${t.part.id}-${e}`,name:e,container:t.partView.container};return void 0===this.partViews[n.id]&&(this.partViews[n.id]=n),n}addDefaultPartViewToView(t){console.log("ADDING DEFAULT PART VIEW");let e={partId:t,id:`pv-${t}-${PARSING_CONSTANTS.PART.DEFAULT_VIEW_NAME}`,name:PARSING_CONSTANTS.PART.DEFAULT_VIEW_NAME,container:this.parts[t].container};return void 0===this.partViews[e.id]&&(this.partViews[e.id]=e),e}makePlaceId(t,e){return void 0===e&&(e=PARSING_CONSTANTS.PLACE.DEFAULT_REGION_NAME),`pl-${t}-${e}`}addPlace(t){let e=t.place.role,n=void 0===t.place.region?PARSING_CONSTANTS.PLACE.DEFAULT_REGION_NAME:t.place.region,r={id:this.makePlaceId(e,n),role:e,region:n};return void 0===this.places[r.id]&&(this.places[r.id]=r),r}associatePartWithPhase(t){let e=t.phase.id;void 0===this.phasesParts[e]&&(this.phasesParts[e]=[]),this.phasesParts[e].push(t.part.id),console.log(`Setting Part ${t.part.id} to Phase ${e}`)}associatePartWithPartView(t){let e=t.part.id,n=t.partView;void 0===this.partsPartViews[e]&&(this.partsPartViews[e]=[]),this.partsPartViews[e].push(n),console.log(`Setting PartId ${e} to PartViewId ${n}`)}associatePartViewWithPlace(t){let e=t.part.id,n=t.partView.name,r=t.place.id;void 0===this.placesPartviews[r]&&(this.placesPartviews[r]=[]),this.placesPartviews[r].push(`pv-${e}-${n}`),console.log(`Setting PartView ${n} belonging to Part ${e} to Place ${t.place.id}`)}addPlaceDefs(t){this.placeDefs=this.placeDefs.concat(t)}}class PPP_Register{constructor(t){this.app=t.app,this.part=t.part,this.partView=t.partView,this.place=t.place,this.phase=t.phase,this.place.roleNotSet=void 0===this.place.role}get state(){return{app:this.app,part:this.part,place:this.place,partView:this.partView,partViewContainer:this.partViewContainer,phase:this.phase}}updateAndCopy(t){let e=Object.assign(this.state,t);return new PPP_Register(e)}changePartTo(t){return this.updateAndCopy({part:t})}changePartViewTo(t,e){return console.log(`CHANGING PART-VIEW FROM: ${this.partView.name} TO: ${t}`),this.updateAndCopy({partView:{name:t,container:e}})}changePlaceTo(t){return console.log("CHANGING PLACE TO: "),console.log(t),this.updateAndCopy({place:t})}changePhaseTo(t){return this.updateAndCopy({phase:t})}copy(){return this.updateAndCopy({})}save(){this.app.associatePartWithPhase(this),this.partView!==PARSING_CONSTANTS.PART.VIEW_UNDEF&&void 0!==this.partView&&(this.app.addPartView(this),this.app.associatePartWithPartView(this),this.app.associatePartViewWithPlace(this))}}function parseFlightPlans(t){let e=Array.from(t.querySelectorAll(PARSING_CONSTANTS.FLIGHT_PLAN_SELECTOR));return 0===e.length&&(e=[t]),e.map(t=>parseFlightPlan(t))}function parseFlightPlan(t){let e,n,r,i=new P4V_Data,o=getDataFromDomElem(t);i.addPlaceDefs(getPlaceDefinitions()),"par"!==o.phase.type&&(o.phase.type="seq"),r=i.addPhase(o),n={id:"rootPlace",role:"_undefined1",region:void 0};let a=new PPP_Register({app:i,part:e={id:"rootPart"},partView:PARSING_CONSTANTS.PART.VIEW_UNDEF,place:n,phase:r});a.save(),i.setRootPhase(r);return Array.from(t.children).forEach(t=>parseDomElem(t,a,!0)),Object.keys(i.parts).filter(t=>void 0===i.partsPartViews[t]).forEach(t=>i.addDefaultPartViewToView(t)),i}function parseDomElem(t,e,n=!1,r=!1){let i,o=getDataFromDomElem(t),a=e.copy(),s=!1,u=!1;if(console.log("DOM ELEMENT PARSED: "+o.domNode.id),console.log(o.part),r){if(o.part.definesNewPartView){let e=o.part.view;a=a.changePartViewTo(e,t)}s=!0}const c=o.part.definesNewPart&&!r,h=o.phase.definesNewPhase||n;if(h&&console.log(`NEW PART IMPLICITLY DECLARED FOR ${o.domNode.id} because \n    elemData.phase.definesNewPhase = ${o.phase.definesNewPhase} OR \n    forceNewPhase = ${n}`),!o.part.definesNewPartView&&(c||h)){let t=e.app.addPart(o);a=a.changePartTo(t),s=!0,u=!0}if(o.place.hasRole||o.place.hasRegion){let t;t=o.place.hasRole?o.place.role:e.place.role;let n=o.place.region,r=Object.assign({},o,{place:{role:t,region:n}}),i=e.app.addPlace(r);a=a.changePlaceTo(i),s=!0}o.part.definesNewPartView&&n&&console.warn(`Element ${o.domNode.id}: \n                  Can't have a new Phase and PartView defined on the same element. New Phase ignored.`);let l=o.domNode.children.length>0;if(!o.part.definesNewPartView&&(o.phase.definesNewPhase||n||l)){let t=e.phase,n=e.app.addPhase(o);console.log("CREATING NEW PHASE ID: "+n.id),e.app.createParentChildPhaseRelationship(t,n),a=a.changePhaseTo(n),s=!0}s&&a.save(),i=l||o.phase.definesNewPhase&&o.phase.isContainer,Array.from(t.children).forEach(t=>parseDomElem(t,a,i,u))}function getDataFromDomElem(t){let e=getPhaseDataFromDomElem(t);return{domNode:t,part:getPartDataFromDomElem(t),place:getPlaceDataFromDomElem(t),phase:e}}function getPhaseDataFromDomElem(t){function e(t){let e=t.match(/^\s*([\d\.]+)\s*ms\s*$/i);if(null!==e)return parseFloat(e[1]);let n=t.match(/^\s*([\d\.]+)\s*s\s*$/i);return null!==n?1e3*parseFloat(n[1]):parseFloat(t)}let n=function(t){let n=t.getAttribute(PARSING_CONSTANTS.PHASE.DURATION_ATT_NAME);return null!==n?e(n):null}(t),r=function(t){let n=t.getAttribute(PARSING_CONSTANTS.PHASE.DELAY_ATT_NAME);return null!==n?e(n):null}(t),i=function(t){return t.getAttribute(PARSING_CONSTANTS.PHASE.ID_ATT_NAME)}(t),o=null!==i?i:"ph"+getIdFromDomPosition(t),a=function(t){return t.getAttribute(PARSING_CONSTANTS.PHASE.TYPE_ATT_NAME)}(t),s={id:o,hasId:null!==o,duration:n,hasDuration:null!==n,delay:r,hasDelay:null!==r,hasNoPhaseDescendents:function(t){return 0===t.querySelectorAll(PARSING_CONSTANTS.PHASE.PHASE_DESCENDANT_SELECTOR).length}(t),type:a,hasType:null!==a,isContainer:"par"===a||"seq"===a};return s.definesNewPhase=s.hasDuration||s.hasDelay||s.hasType,s}function getPartDataFromDomElem(domElem){function getPartTypeViewFromString(t){let e={},n=t.replace(RegExp(`^${PARSING_CONSTANTS.PART.SELECTOR_PREFIX}`),"").split(PARSING_CONSTANTS.PART.TYPE_VIEW_DELIMITER);return void 0!==n[0]&&(e.type=n[0]),void 0!==n[1]&&(e.view=n[1]),e}function getPartTypeViewFromPartAttribute(t){let e=t.getAttribute(PARSING_CONSTANTS.PART.PART_ATT_NAME);return null!==e?getPartTypeViewFromString(e):{}}function getPartTypeViewFromPartTypeViewAttributes(t){let e={},n=t.getAttribute(PARSING_CONSTANTS.PART.TYPE_ATT_NAME),r=t.getAttribute(PARSING_CONSTANTS.PART.VIEW_ATT_NAME);return null!==n&&(e.type=n),null!==r&&(e.view=r),e}function getPartTypeViewFromClassname(t){let e,n=Array.from(t.classList).find(t=>t.startsWith(PARSING_CONSTANTS.PART.CLASSNAME_PREFIX));return e=void 0!==n?getPartTypeViewFromString(n.slice(PARSING_CONSTANTS.PART.CLASSNAME_PREFIX.length)):{}}function getPartTypeView(t){return Object.assign({},getPartTypeViewFromClassname(t),getPartTypeViewFromPartAttribute(t),getPartTypeViewFromPartTypeViewAttributes(t))}function getPartIdFromDomElem(t){let e,n=t.getAttribute(PARSING_CONSTANTS.PART.ID_ATT_NAME),r=t.getAttribute(PARSING_CONSTANTS.PART.PART_ID_ATT_NAME),i=t.getAttribute(PARSING_CONSTANTS.PART.PART_REF_ATT_NAME);return e=null!=r?r:null!=n?n.replace(/^#/,""):null!=i?i:void 0}function getPartOptionsFromDomElem(domElem){const optionsString=domElem.getAttribute(PARSING_CONSTANTS.PART.OPTIONS_ATT_NAME);let optionsData;if(null!==optionsString&&""!==optionsString){const BRACES=/^\s*\{|\}\s*$/g,evalString="(function() { return {"+optionsString.replace(BRACES,"")+"} })()";optionsData=eval(evalString)}else optionsData={};return optionsData}let id=getPartIdFromDomElem(domElem),partTypeView=getPartTypeView(domElem),options=getPartOptionsFromDomElem(domElem),partContainer=domElem,definesNewPartView=void 0!==partTypeView.view,definesNewPart=void 0!==partTypeView.type&&!definesNewPartView;return{type:partTypeView.type,view:partTypeView.view,id:id,hasId:void 0!==id,options:options,container:partContainer,definesNewPart:definesNewPart,definesNewPartView:definesNewPartView}}function getPlaceDataFromDomElem(t){function e(t){let e={},n=t.replace(RegExp(`^${PARSING_CONSTANTS.PLACE.SELECTOR_PREFIX}`),"").split(PARSING_CONSTANTS.PLACE.ROLE_REGION_DELIMITER);return void 0!==n[0]&&(e.role=n[0]),void 0!==n[1]&&(e.region=n[1]),e}let n=Object.assign({},function(t){let n=Array.from(t.classList).find(t=>t.startsWith(PARSING_CONSTANTS.PLACE.CLASSNAME_PREFIX));return void 0!==n?e(n):{}}(t),function(t){let n=t.getAttribute(PARSING_CONSTANTS.PLACE.PLACE_ATT_NAME);return null!==n?e(n):{}}(t),function(t){let e={},n=t.getAttribute(PARSING_CONSTANTS.PLACE.ROLE_ATT_NAME),r=t.getAttribute(PARSING_CONSTANTS.PLACE.REGION_ATT_NAME);return null!==n&&(e.role=n),null!==r&&(e.region=r),e}(t));return n.hasRole=void 0!==n.role,n.hasRegion=void 0!==n.region,n}function main(){document.body.querySelectorAll("*").forEach(t=>{null===t.getAttribute("id")&&t.setAttribute("id",`g${getIdFromDomPosition(t)}`)});let t=parseFlightPlans(document.body);return t.length>0?t[0]:null}function init(t){firebase.initializeApp(t)}function deleteFlightEntries(t){console.log(`REMOVING REMOTE FLIGHT INSTANCE VARIABLES FROM _${t}`),firebase.database().ref().orderByKey().startAt(`_${t}`).once("value",function(t){console.log(`> REMOVING ${t.key}`)})}function listenForChanges(t,e,n){const r=firebase.database().ref().child(t);r.once("value").then(function(e){e.exists()||(console.log(`> INIT VAL: ${t} = ${n}`),r.set(n))}),r.on("value",function(n){let r=n.val();console.log(`FIREBASE VARIABLE ${t} CHANGED TO ${r} --\x3e updating local`),e(n.val())})}function getFlightInstanceStore(){return firebase.database().ref().once("value")}function setVal(t,e){console.log(`FIREBASE SET VALUE OF ${t} TO ${e}`),firebase.database().ref().child(t)!==e&&firebase.database().ref().child(t).set(e)}function getRemoteStore(t){return init(t),{listenForChanges:listenForChanges,set:setVal,getFlightState:getFlightInstanceStore(),deleteFlightEntries:deleteFlightEntries}}var LARGE_ARRAY_SIZE=200,HASH_UNDEFINED="__lodash_hash_undefined__",UNORDERED_COMPARE_FLAG=1,PARTIAL_COMPARE_FLAG=2,MAX_SAFE_INTEGER=9007199254740991,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",promiseTag="[object Promise]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^(?:0|[1-9]\d*)$/,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,freeProcess=moduleExports&&freeGlobal.process,nodeUtil=function(){try{return freeProcess&&freeProcess.binding("util")}catch(t){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;function arraySome(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return!0;return!1}function baseTimes(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function baseUnary(t){return function(e){return t(e)}}function getValue(t,e){return null==t?void 0:t[e]}function isHostObject(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function mapToArray(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function overArg(t,e){return function(n){return t(e(n))}}function setToArray(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=root["__core-js_shared__"],maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectToString=objectProto.toString,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Symbol=root.Symbol,Uint8Array=root.Uint8Array,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,nativeKeys=overArg(Object.keys,Object),DataView=getNative(root,"DataView"),Map=getNative(root,"Map"),Promise=getNative(root,"Promise"),Set$1=getNative(root,"Set"),WeakMap=getNative(root,"WeakMap"),nativeCreate=getNative(Object,"create"),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap),symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function Hash(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{}}function hashDelete(t){return this.has(t)&&delete this.__data__[t]}function hashGet(t){var e=this.__data__;if(nativeCreate){var n=e[t];return n===HASH_UNDEFINED?void 0:n}return hasOwnProperty.call(e,t)?e[t]:void 0}function hashHas(t){var e=this.__data__;return nativeCreate?void 0!==e[t]:hasOwnProperty.call(e,t)}function hashSet(t,e){return this.__data__[t]=nativeCreate&&void 0===e?HASH_UNDEFINED:e,this}function ListCache(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(t){var e=this.__data__,n=assocIndexOf(e,t);return!(n<0)&&(n==e.length-1?e.pop():splice.call(e,n,1),!0)}function listCacheGet(t){var e=this.__data__,n=assocIndexOf(e,t);return n<0?void 0:e[n][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,e){var n=this.__data__,r=assocIndexOf(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}function MapCache(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function mapCacheDelete(t){return getMapData(this,t).delete(t)}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,e){return getMapData(this,t).set(t,e),this}function SetCache(t){var e=-1,n=t?t.length:0;for(this.__data__=new MapCache;++e<n;)this.add(t[e])}function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function Stack(t){this.__data__=new ListCache(t)}function stackClear(){this.__data__=new ListCache}function stackDelete(t){return this.__data__.delete(t)}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}function stackSet(t,e){var n=this.__data__;if(n instanceof ListCache){var r=n.__data__;if(!Map||r.length<LARGE_ARRAY_SIZE-1)return r.push([t,e]),this;n=this.__data__=new MapCache(r)}return n.set(t,e),this}function arrayLikeKeys(t,e){var n=isArray(t)||isArguments(t)?baseTimes(t.length,String):[],r=n.length,i=!!r;for(var o in t)!e&&!hasOwnProperty.call(t,o)||i&&("length"==o||isIndex(o,r))||n.push(o);return n}function assocIndexOf(t,e){for(var n=t.length;n--;)if(eq(t[n][0],e))return n;return-1}function baseGetTag(t){return objectToString.call(t)}function baseIsEqual(t,e,n,r,i){return t===e||(null==t||null==e||!isObject(t)&&!isObjectLike(e)?t!=t&&e!=e:baseIsEqualDeep(t,e,baseIsEqual,n,r,i))}function baseIsEqualDeep(t,e,n,r,i,o){var a=isArray(t),s=isArray(e),u=arrayTag,c=arrayTag;a||(u=(u=getTag(t))==argsTag?objectTag:u),s||(c=(c=getTag(e))==argsTag?objectTag:c);var h=u==objectTag&&!isHostObject(t),l=c==objectTag&&!isHostObject(e),f=u==c;if(f&&!h)return o||(o=new Stack),a||isTypedArray(t)?equalArrays(t,e,n,r,i,o):equalByTag(t,e,u,n,r,i,o);if(!(i&PARTIAL_COMPARE_FLAG)){var p=h&&hasOwnProperty.call(t,"__wrapped__"),d=l&&hasOwnProperty.call(e,"__wrapped__");if(p||d){var y=p?t.value():t,m=d?e.value():e;return o||(o=new Stack),n(y,m,r,i,o)}}return!!f&&(o||(o=new Stack),equalObjects(t,e,n,r,i,o))}function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)||isHostObject(t)?reIsNative:reIsHostCtor).test(toSource(t))}function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[objectToString.call(t)]}function baseKeys(t){if(!isPrototype(t))return nativeKeys(t);var e=[];for(var n in Object(t))hasOwnProperty.call(t,n)&&"constructor"!=n&&e.push(n);return e}function equalArrays(t,e,n,r,i,o){var a=i&PARTIAL_COMPARE_FLAG,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var h=-1,l=!0,f=i&UNORDERED_COMPARE_FLAG?new SetCache:void 0;for(o.set(t,e),o.set(e,t);++h<s;){var p=t[h],d=e[h];if(r)var y=a?r(d,p,h,e,t,o):r(p,d,h,t,e,o);if(void 0!==y){if(y)continue;l=!1;break}if(f){if(!arraySome(e,function(t,e){if(!f.has(e)&&(p===t||n(p,t,r,i,o)))return f.add(e)})){l=!1;break}}else if(p!==d&&!n(p,d,r,i,o)){l=!1;break}}return o.delete(t),o.delete(e),l}function equalByTag(t,e,n,r,i,o,a){switch(n){case dataViewTag:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case arrayBufferTag:return!(t.byteLength!=e.byteLength||!r(new Uint8Array(t),new Uint8Array(e)));case boolTag:case dateTag:case numberTag:return eq(+t,+e);case errorTag:return t.name==e.name&&t.message==e.message;case regexpTag:case stringTag:return t==e+"";case mapTag:var s=mapToArray;case setTag:var u=o&PARTIAL_COMPARE_FLAG;if(s||(s=setToArray),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;o|=UNORDERED_COMPARE_FLAG,a.set(t,e);var h=equalArrays(s(t),s(e),r,i,o,a);return a.delete(t),h;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(e)}return!1}function equalObjects(t,e,n,r,i,o){var a=i&PARTIAL_COMPARE_FLAG,s=keys(t),u=s.length;if(u!=keys(e).length&&!a)return!1;for(var c=u;c--;){var h=s[c];if(!(a?h in e:hasOwnProperty.call(e,h)))return!1}var l=o.get(t);if(l&&o.get(e))return l==e;var f=!0;o.set(t,e),o.set(e,t);for(var p=a;++c<u;){var d=t[h=s[c]],y=e[h];if(r)var m=a?r(y,d,h,e,t,o):r(d,y,h,t,e,o);if(!(void 0===m?d===y||n(d,y,r,i,o):m)){f=!1;break}p||(p="constructor"==h)}if(f&&!p){var g=t.constructor,v=e.constructor;g!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v)&&(f=!1)}return o.delete(t),o.delete(e),f}function getMapData(t,e){var n=t.__data__;return isKeyable(e)?n["string"==typeof e?"string":"hash"]:n.map}function getNative(t,e){var n=getValue(t,e);return baseIsNative(n)?n:void 0}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var getTag=baseGetTag;function isIndex(t,e){return!!(e=null==e?MAX_SAFE_INTEGER:e)&&("number"==typeof t||reIsUint.test(t))&&t>-1&&t%1==0&&t<e}function isKeyable(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}function isPrototype(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||objectProto)}function toSource(t){if(null!=t){try{return funcToString.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function eq(t,e){return t===e||t!=t&&e!=e}function isArguments(t){return isArrayLikeObject(t)&&hasOwnProperty.call(t,"callee")&&(!propertyIsEnumerable.call(t,"callee")||objectToString.call(t)==argsTag)}(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&getTag(Promise.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag||WeakMap&&getTag(new WeakMap)!=weakMapTag)&&(getTag=function(t){var e=objectToString.call(t),n=e==objectTag?t.constructor:void 0,r=n?toSource(n):void 0;if(r)switch(r){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return promiseTag;case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return e});var isArray=Array.isArray;function isArrayLike(t){return null!=t&&isLength(t.length)&&!isFunction(t)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function isEqual(t,e){return baseIsEqual(t,e)}function isFunction(t){var e=isObject(t)?objectToString.call(t):"";return e==funcTag||e==genTag}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER}function isObject(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function isObjectLike(t){return!!t&&"object"==typeof t}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}const conxOptions={apiKey:"AIzaSyDc_8MiQvWdCNpvZcvbJyyQYGeTaVGpBgo",authDomain:"glider-feb-2019.firebaseapp.com",databaseURL:"https://glider-feb-2019.firebaseio.com",projectId:"glider-feb-2019",storageBucket:"glider-feb-2019.appspot.com",messagingSenderId:"451231012490"};let remoteStore=getRemoteStore(conxOptions);function isDifferent(t,e){return!isEqual(t,e)}function getVuExStateFromPartVarList(t,e){return Object.keys(t).reduce((n,r)=>{return n[e(r)]=t[r],n},{})}function getPartModuleDefinition(t,e){return{state:getVuExStateFromPartVarList(t,e),namespaced:!0,getters:{getVal:(t,e,n)=>e=>(console.log(`GETVAL: getting ${e}`),console.log(`> partModuleState['${e}'] is: ${t[e]}`),console.log("> and module state is:"),console.log(t),t[e])},mutations:{setValTo:function(t,[n,r]){let i=e(n);isDifferent(t[i],r)&&(console.log("UPDATING LOCAL STORE:"),console.log(`> partModuleState['${i}'] = ${r};`),console.log("> Module state is now:"),console.log(t),t[i]=r,remoteStore.set(i,r))}}}}function getPartTypeSettersGetters({sharedVariables:t,flightInstanceId:e}){let n={},r=this;return Object.entries(t).forEach(([t,i])=>{let o=(t,n)=>`_${e}-${n}-${t}`;n[t]={get:function(){let e=o(t,this.id),n=`${this.id}/getVal`;return console.log(`PART GETTER NEW: localStore.getters['${n}']('${e}')`),console.log(r),console.log("RESULT: "+r.getters[n](e)),r.getters[n](e)},set:function(e){o(t,this.id);let n=`${this.id}/setValTo`;console.log(`PART SETTER NEW: localStore.commit(${n}, [${t}, ${e}])`),r.commit(n,[t,e])}}}),n}function registerPart({sharedVariables:t,partId:e,flightInstanceId:n}){console.log(`REGISTERING PART ${e} IN STORE`);let r=this,i=e,o=Object.keys(t),a=t=>`_${n}-${e}-${t}`,s=getPartModuleDefinition(t,a);r.registerModule(i,s);let u=`${i}/getVal`,c=`${i}/setValTo`;return o.forEach(e=>{const n=a(e);remoteStore.listenForChanges(a(e),t=>{isDifferent(t,r.getters[u](n))&&(console.log(`CHANGE ON REMOTE STORE: localStore.commit('${c}', ['${e}', ${t}]);`),r.commit(c,[e,t]))},t[e])}),!0}function getLocalStore(t,e,n){n&&remoteStore.deleteFlightEntries(t);const r=Object.values(e.partViews).reduce((t,e)=>(t[e.id]=e.partId,t),{});let i=Object.keys(r).reduce((t,e)=>{let n=r[e];return void 0===t[n]&&(t[n]=[]),t[n].push(e),t},{}),o=e.phasesParts,a={};let s=new Vuex.Store({state:{flightInstanceId:t,partViewsToParts:r},mutations:{},modules:{},getters:{getPartViewSharedVariable:function(t){return function(e,n){let r=t.partViewsToParts[e],i=`_${t.flightInstanceId}-${r}-${n}`;return t[r][i]}}}});return s.registerPart=registerPart,s.getPartTypeSettersGetters=getPartTypeSettersGetters,s.setPartViewSharedVariable=function(t,e,n){let r=this.state.partViewsToParts[t];console.log(`SETTING ${e} IN ${r} TO ${n} in STORE!`),this.commit(`${r}/setValTo`,[e,n])},s.addPartInstanceToRegistry=function(t){a[t.id]=t,console.log(`ADDING ${t.id} TO PART REGISTRY`),console.log(t)},s.phaseActive=function(t){console.log(`ACTIVATING PHASE ${t.id}`),o[t.id].forEach(t=>{console.log(`> ACTIVATING PART ${t}`);let e=a[t];e&&e.makeActive(),void 0!==i[t]&&i[t].forEach(t=>a[t].makeActive())})},s.phaseInactive=function(t){console.log(`DEACTIVATING PHASE ${t.id}`),o[t.id].forEach(t=>{console.log(`> DEACTIVATING PART ${t}`);let e=a[t];e&&e.makeInactive(),void 0!==i[t]&&i[t].forEach(t=>a[t].makeInactive())})},s.placesPartviews=e.placesPartviews,s.addPartViewToPlace=function(t,e){void 0===this.placesPartviews[e]&&(this.placesPartviews[e]=[]),this.placesPartviews[e].push(t),console.log(this.placesPartviews[e])},s}window.rs=remoteStore;class Phase{constructor(t){this.id=void 0===t.id?this.generateId():t.id,this.app=t.app,this.delay="number"==typeof t.delay?1e3*t.delay:0,this.duration="number"==typeof t.duration?1e3*t.duration:1/0,this.currentState="idle",this.timer=null,this.xxxComplete=function(){}}generateId(){return"_rand_"+Math.floor(1e3*Math.random())}set state(t){this.currentState!==t&&(this.currentState=t)}get isComplete(){return"complete"===this.currentState}get isRunning(){return"running"===this.currentState}complete(t){this.state="complete",this.notifyInactive(),this.clearTimer(),"function"==typeof t?t():this.xxxComplete()}startRunning(){this.state="running",this.notifyActive()}notifyActive(){this.app.phaseActive(this)}notifyInactive(){this.app.phaseInactive(this)}scheduleRun(t){t=Object.assign({afterDelay:()=>{},afterDuration:()=>{}},t);const e=this,n=function(){e.forceComplete(),void 0!==t.afterDuration&&t.afterDuration()};this.state="idle",this.waitAndCall(this.delay,function(){t.afterDelay(),e.duration<Number.POSITIVE_INFINITY&&e.waitAndCall(e.duration,n)})}waitAndCall(t,e){this.timer=window.setTimeout(e,t)}clearTimer(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)}get json(){return{id:this.id,type:this.constructor.name,delay:this.delay,duration:this.duration,children:void 0!==this.childPhases?this.childPhases.map(t=>t.json):null}}}class Phase_noChildren extends Phase{constructor(t){super(t)}forceComplete(){this.complete()}get isContainer(){return!1}run(t){let e=this;this.xxxComplete=t;this.scheduleRun({afterDelay:function(){e.startRunning()},afterDuration:t})}}class Phase_withChildren extends Phase{constructor(t){super(t),this.childPhases=[]}get isContainer(){return!0}addChild(t){t.parentPhase=this,t.app=this.app,this.childPhases.push(t)}forceChildrenToComplete(){this.childPhases.forEach(t=>t.forceComplete())}forceComplete(){this.forceChildrenToComplete(),this.complete()}}class Phase_par extends Phase_withChildren{constructor(t){super(t)}get allChildrenComplete(){return this.childPhases.every(t=>t.isComplete)}runAllChildren(t){this.childPhases.forEach(e=>e.run(t))}getOnChildCompleteCallback(t){let e=this;return function(){e.allChildrenComplete}}run(t){let e=this;this.xxxComplete=t;let n=this.getOnChildCompleteCallback(t);this.scheduleRun({afterDelay:function(){e.startRunning(),e.runAllChildren(n)},afterDuration:t})}}class Phase_seq extends Phase_withChildren{constructor(t){super(t),this.currChildIndex=-1,this.onAllChildrenComplete_KLUDGE=function(){}}forceNext(){console.log("NEXT!!"),console.log(this.isRunning),this.currChildIndex+1<this.childPhases.length&&this.isRunning&&(console.log(this.currChildIndex),this.childPhases[this.currChildIndex].forceComplete())}runAllChildren(t){this.runChild(0,t)}runChild(t,e){let n,r=this,i=this.childPhases.length===t+1,o=this.childPhases[t];this.currChildIndex=t,n=i?function(){this.currChildIndex=-1}:function(){r.runChild(t+1,e)},o.run(n)}run(t){let e=this;this.xxxComplete=t;this.scheduleRun({afterDelay:function(){e.startRunning(),e.runAllChildren(t)},afterDuration:t})}}function phaseFactory(t){if(void 0!==Phase.types[t.type])return new Phase.types[t.type](t);console.warning(`Unrecognised Phase type ${t.type}!`)}function initPartTypeSharedData(t,e,n,r,i){let o=e.part.sharedData?e.part.sharedData():void 0;if(void 0!==o&&Object.keys(o).length>0){let a=r.getPartTypeSettersGetters({sharedVariables:o,flightInstanceId:i});Object.keys(n.parts).filter(e=>n.parts[e].type===t).map(t=>n.parts[t].id).forEach(t=>{r.registerPart({sharedVariables:o,partId:t,flightInstanceId:i})}),e.part.computed=a,delete e.part.sharedData}return e}Phase.types={par:Phase_par,parallel:Phase_par,seq:Phase_seq,sequence:Phase_seq,leaf:Phase_noChildren};var PartUtils=Object.freeze({initPartTypeSharedData:initPartTypeSharedData});let part={data:()=>({blue:"This is from the HTML Part"})},views=[{partviewName:"defaultView",render(t){return t(this.$vnode.data.tag,{attrs:{id:this.id}},this.$slots.default)}}];var _default=Object.freeze({part:part,views:views});let part$1={data:function(){return{_isActive:!1}},props:["id"],created:function(){this.$root.app.addPartInstanceToRegistry(this),this.makeInactive()},methods:{makeActive:function(){console.log(`PART ${this.id} IS TURNING ON`),this._isActive=!0},makeInactive:function(){console.log(`PART ${this.id} IS TURNING OFF`),this._isActive=!1}}},partView={data:()=>({_isActive:!1,red:"This is from _Super PV edition"}),props:["id","is_also","part_id"],mounted:function(){let t=this.is_also;if(this.$root.partviews[this.id]=this,this.$root.app.addPartInstanceToRegistry(this),this.makeInactive(),t){console.log("PART AND PART VIEW ON SAME ELEMENT:"),console.log(`Is also value: ${t}`),console.log("AND APP IS"),console.log(this.$root.app);let e=t,n=Vue.extend(window.wtf.components[e]),r=this.part_id,i=(this.$props,Object.keys(this.$props).filter(t=>!["id","is_also","part_id"].includes(t)).reduce((t,e)=>{let n=t;return n[e]=this.$props[e],n},{}));console.log(`PROPS DATA FOR ${this.id}`),console.log(i);let o=new n({propsData:{id:r}});o.$mount(),o.makeInactive(),console.log("And the new Part is:"),console.log(o),this.$root.app.addPartInstanceToRegistry(o)}},methods:{makeActive:function(){console.log(`PART VIEW ${this.id} IS TURNING ON`),this._isActive=!0,this.$el.classList.add("part-active"),this.$el.classList.remove("part-inactive")},makeInactive:function(){console.log(`PART VIEW ${this.id} IS TURNING OFF`),this._isActive=!1,this.$el.classList.remove("part-active"),this.$el.classList.add("part-inactive")}}},views$1=[partView];var _super=Object.freeze({part:part$1,views:views$1});let part$2={template:"<div><slot></slot></div>",sharedData:function(){return{count:0,count2:0,count3:0}}},partView_counterButton={partviewName:"controller",template:'\n    <div style="color: black">\n      <h1>I know how to code:</h1>\n      <button type="button" class="btn btn-light btn-block" v-on:click="inc">HTML</button>\n      <button type="button" class="btn btn-light btn-block" v-on:click="inc2">CSS</button>\n      <button type="button" class="btn btn-light btn-block" v-on:click="inc3">Javascript</button>\n    </div>\n  ',methods:{inc:function(){console.log("INCREMENT 1!"),this.count++},inc2:function(){this.count2++},inc3:function(){this.count3++}}},partView_countDisplay={partviewName:"display",template:"\n    <div>\n      <p style=\"color: red\">{{ ''.repeat(count) }} HTML</p>\n      <p style=\"color: yellow\">{{ ''.repeat(count2) }} CSS</p>\n      <p style=\"color: blue\">{{ ''.repeat(count3) }} Javascript</p>\n    </div>"},views$2=[partView_counterButton,partView_countDisplay];var poll=Object.freeze({part:part$2,views:views$2});let part$3={data:()=>({testData:"This is the value of testData"})},partView_A={partviewName:"Test Part View A",template:"<p>Part View A</p>",data:()=>({testData_A:"This is a value in PartView A"})},partView_B={partviewName:"Test Part View B",template:"<p>Part View B</p>",data:()=>({testData_A:"This is a value in PartView B"})},views$3=[partView_A,partView_B];var test01=Object.freeze({part:part$3,views:views$3}),fullScreenTextPanel=Object.freeze({});let part$4={props:["ben","sam"],template:'<div class="generatedByArticleActivity"><slot></slot></div>',data:()=>({testData:"This is the value of testData"})},partView_A$1={partviewName:"display",template:"<p>Article activity - display</p>",data:()=>({testData_A:"This is a value in Article activity - display"})},partView_B$1={partviewName:"controller",template:"<p>Article activity - controller</p>",data:()=>({testData_A:"This is a value in Article activity - display"})},views$4=[partView_A$1,partView_B$1];var articleActivity=Object.freeze({part:part$4,views:views$4});let part$5={template:'<div class="generatedByRandomSelection"><slot></slot></div>',data:()=>({testData:"This is the value of testData"})},randomSelectionDisplay={partviewName:"display",template:"<p>Random Selection Display content</p>",data:()=>({testData_A:"This is a value in PartView A"})},randomSelectionController={partviewName:"controller",template:"<p>Random Selection Controller content</p>",data:()=>({testData_A:"This is a value in PartView B"})},views$5=[randomSelectionDisplay,randomSelectionController];var randomSelection=Object.freeze({part:part$5,views:views$5});let part$6={template:"<div><slot></slot></div>",sharedData:function(){return{currSlide:-1}},data:function(){return{playing:!1}}},partView_button={partviewName:"defaultView",props:["phase_id"],template:'\n    <button v-on:click="advance">\n      next \n    </button>',methods:{makeGliderRun:function(){this.currSlide=-1,window.setTimeout(function(){},1e3)},advance:function(){console.log("HIT"),this.currSlide++}},watch:{currSlide:function(t,e){console.log(`currSlide changed from ${e} to ${t}`),-1!==t&&(console.log("RUN **********************"),this.$root.app.isInitializingInstance?window.glider.isRunning?console.log("initiator - already running"):console.log("initiator - not running"):window.glider.isRunning?console.log("not initiator - already running"):console.log("not initiator - not running"),window.glider.isRunning&&(console.log("ADVANCING -- BLAH BLAH BLAH"),window.glider.phases[this.phase_id].forceNext()))}}},views$6=[partView_button];var nextButton=Object.freeze({part:part$6,views:views$6}),partTypeRegistry=Object.freeze({_super:_super,identity:_default,poll:poll,test01:test01,fullscreenTextPanel:fullScreenTextPanel,articleActivity:articleActivity,randomSelection:randomSelection,nextButton:nextButton});class Place{constructor(t){this.id=t.id||new Date+Math.floor(1e4*Math.random()),this.isHere=void 0}getCssPlaceId(){return`place-${this.id}`}addCssStylesheet(t){let e=t.id,n=t.url,r=t.integrity,i=t.crossorigin;if(null===document.getElementById(e)&&this.isHere){let t=document.createElement("link");t.setAttribute("id",e),t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),void 0!==r&&t.setAttribute("integrity",r),void 0!==i&&t.setAttribute("crossorigin",i),document.head.appendChild(t)}}addCss(t){if(null===document.getElementById(t.id)){let e=document.createElement("style");e.setAttribute("id",t.id),e.appendChild(document.createTextNode(t.css)),document.head.appendChild(e)}}set clientPlace(t){this.isHere=this.id===t}assignPartViewToRegion(t,e){e.container.classList.add(this.isHere?"place-here":"place-not-here"),this.assignPartViewToRegion2(t,e)}}class FixedGridPlace extends Place{constructor(t){super(t),this.options={rows:parseInt(t.rows)||1,columns:parseInt(t.columns)||1,rowHeight:parseInt(t.rowHeight)||1080,columnWidth:parseInt(t.columnWidth)||1920},this.loadGlobalCSS()}loadGlobalCSS(){super.addCss({id:"place-fixedgrid-global",css:`\n        .placetype-fixedgrid, .placetype-fixedgrid-defaultRegion {\n          width: ${this.options.columnWidth*this.options.columns}px;\n          height: ${this.options.rowHeight*this.options.rows}px;\n        }`})}loadCSS(t){this.loadGlobalCSS(),super.loadCSS(t)}assignPartViewToRegion2(t,e){return console.log(`FixedGridPlace region ${t} being assigned to Part`),new FixedGridPlaceRegion(t,e,this)}}class FixedGridPlaceRegion{constructor(t,e,n){if(this.parentPlace=n,void 0!==t){const e=/^c(\d+)r(\d+)w(\d+)h(\d+)$/i;let r={},i=t.match(e);null!==i&&([r.column,r.row,r.width,r.height]=i.slice(1,6).map(t=>parseInt(t)),n.addCss({id:`place-fixedgrid-${t}`,css:`\n            .place-fixedgrid-${t} {\n              position: absolute;\n              width: ${n.options.columnWidth*r.width}px;\n              height: ${n.options.rowHeight*r.height}px;\n              left: ${n.options.columnWidth*(r.column-1)}px;\n              top: ${n.options.rowHeight*(r.row-1)}px;\n            }\n          `}))}else console.log("REGION UNDEFINED");e.container.classList.add(`place-fixedgrid-${t}`),e.container.classList.add("placetype-fixedgrid"),e.container.classList.add(`place-${n.id}`)}}class BootstrapPlace extends Place{constructor(t){super(t)}loadBootstrap(){this.addCssStylesheet({id:"place-bootstrap-global",url:"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css",integrity:"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u",crossorigin:"anonymous"}),this.addCss({id:"place-bootstrap",css:"\n        body {\n          padding: 5% 15%;\n        }\n      "})}assignPartViewToRegion2(t,e){return console.log(`Bootstrap region ${t} being assigned to PartView`),console.log(e),new BootstrapPlaceRegion(t,e,this)}}class BootstrapPlaceRegion{constructor(t,e,n){e.container.classList.add(`placetype-bootstrap-${t}`),e.container.classList.add(`place-${n.id}`),n.loadBootstrap()}}const placeTypeConstructor={bootstrapplace:BootstrapPlace,fixedgridplace:FixedGridPlace};function getPlaceRegistry(t){let e={};return t.placeDefs.forEach(t=>{e[t.id]=new(placeTypeConstructor[t.type.toLowerCase()])(t)}),e}function createParts(t,e,n,r,i,o){Array.from(new Set(Object.values(e.parts).map(t=>t.type))).forEach(a=>{if(void 0!==n[a]){console.log(`REGISTERING VUE COMPONENT FOR ${a}. Definition:`),console.log(n[a].part);let s=n[a];s.part.extends=n._super.part,r.initPartTypeSharedData(a,s,e,t,o),void 0===s.part.template&&void 0===s.part.render&&(s.part.template="<div><slot></slot></div>");let u=Object.keys(s.part.computed||{}).reduce((e,n)=>{return e[n]={get:function(){return t.getters.getPartViewSharedVariable(this.id,n)},set:function(e){console.log(`SETTING ${n} TO ${e} in VUE!`),t.setPartViewSharedVariable(this.id,n,e)}},e},{});i.component(a,s.part),s.views&&s.views.forEach(t=>{let e=PARSING_CONSTANTS.PART.GET_VUE_COMPONENT_NAME(a,t.partviewName);t.extends=n._super.views[0],t.computed=Object.assign(u,t.computed),console.log(`REGISTERING VUE COMPONENT FOR ${e}. Definition:`),console.log(t),i.component(e,t)})}else console.error(`Unknown Part Type ${a}! (not registered)`)});for(let t in e.parts){let n=e.parts[t];n.container.setAttribute("is",n.type),n.container.classList.add(PARSING_CONSTANTS.PART.GET_CSS_CLASS(n.type)),n.container.setAttribute("ref",t)}for(let n in e.partViews){let r=e.partViews[n],i=r.partId,o=e.parts[i].type;console.log(`SETTING PARTVIEW @IS TO ${o}-${r.name}`),r.container.setAttribute("id",n),null!==r.container.getAttribute("is")&&(r.container.setAttribute("is_also",r.container.getAttribute("is")),r.container.setAttribute("part_id",i),e.parts[i].place&&t.addPartViewToPlace(n,e.parts[i].place)),r.container.setAttribute("is",`${o}-${r.name}`),r.container.classList.add(PARSING_CONSTANTS.PART.GET_CSS_CLASS(o,r.name)),r.container.setAttribute("ref",n)}}function createPlaces(t,e,n,r){let i;for(i in e.places){let o=e.places[i],a=n[o.role];void 0===a?console.error(`Place '${o.role}' not found in registry`):(console.log(`PLACE OBJECT ${o.role}`),console.log(e.placesPartviews[i]),console.log(t.placesPartviews[i]),a.clientPlace=r,t.placesPartviews[i].forEach(t=>a.assignPartViewToRegion(o.region,e.partViews[t])))}return{}}function createPhases(t,e,n){let r={};for(let i in e.phases){let o=Object.assign({app:t},e.phases[i]);console.log("PHASE DATA"),console.log(o),r[i]=n(o)}for(let t in e.phaseChildren){let n=r[t];e.phaseChildren[t].map(t=>r[t]).forEach(t=>n.addChild(t))}return console.log("CREATING PHASES IN FACTORY"),console.log(r),r}let{flightInstanceId:flightInstanceId,herePlace:herePlace,nowPhase:nowPhase,initialize:initialize}=getGliderOptions();console.log(`PARSED URL ${flightInstanceId}; ${herePlace}`),console.log(flightInstanceId,herePlace,nowPhase,initialize),Vue.use(Vuex);let glider={};function gliderBootOnDomLoad(){if(!document.querySelector("link#glider-style")){const t=document.createElement("link");t.rel="stylesheet",t.href="https://glider.glitch.me/glider/style.css",document.head.appendChild(t)}document.body.classList.add(`place-here-${herePlace}`);let t=document.createElement("section");t.setAttribute("id","glider-start"),t.setAttribute("class","not-ready2"),t.innerHTML="<p><br />Start</p>",t.onclick=function(){window.glider.run(),this.parentNode.removeChild(this)},document.body.appendChild(t);let e=main();console.log("-------------------------------------------------------"),console.log("DATA RETURNED FROM PARSER"),console.log(e);let n=getLocalStore(flightInstanceId,e,initialize);n.here=herePlace,n.isInitializingInstance=initialize,window.gApp=n,console.log("-------------------------------------------------------"),console.log("CREATING PARTS"),createParts(n,e,partTypeRegistry,PartUtils,Vue,flightInstanceId),console.log("-------------------------------------------------------"),console.log("CREATING PLACES"),console.log(e.places);createPlaces(n,e,getPlaceRegistry(e),herePlace);console.log("-------------------------------------------------------"),console.log("CREATING PHASES");let r=createPhases(n,e,phaseFactory);console.log(r),window.glider={},window.herePlace=herePlace,window.glider.phases=r,window.glider.phases2Parts=e.phasesParts;{console.log("-------------------------------------------------------"),console.log("RENDERING VUE"),console.log("BEFORE"),console.log(Vue.options),window.wtf=Vue.options;let t=new Vue({el:"#glider-root",data:{abc:"def",store:n,app:n,parts:{},partviews:{}}});window.glider.parts=t.$refs,window.glider.run=function(){this.isRunning=!0,this.parts["pv-nextBut-defaultView"].makeGliderRun(),this.phases["glider-root"].run()},window.vv=t,console.log("AFTER"),console.log(Vue.options)}}return document.addEventListener("DOMContentLoaded",gliderBootOnDomLoad),exports.glider=glider,exports}({});